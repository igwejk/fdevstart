/**
 * visualize a model and calculate some statistics
 */
"use strict";

var fs = require("fs");
var Model = require("./model");
var Util = require("../utils/utils");
var Describe = require("../match/describe");
var _ = require("lodash");
var debug = require("debug");
//import * as elasticlunr from 'elasticlunr';
var debuglog = debug('vismodel.ts');
;
var elasticlunr = require('elasticlunr');
function JSONEscape(s) {
    return s.replace(/\\/g, "\\\\").replace(/\n/g, "\\n").replace(/\'/g, "\\'").replace(/\"/g, '\\"').replace(/\&/g, "\\&").replace(/\r/g, "\\r").replace(/\t/g, "\\t");
    // .replace(/\b/g, "\\b")
    // .replace(/\f/g, "\\f");
}
exports.JSONEscape = JSONEscape;
;
function makeLunrIndex(modelpath, output, silent) {
    var mdl = JSON.parse('' + fs.readFileSync(modelpath + '.model.json'));
    var data = JSON.parse('' + fs.readFileSync(modelpath + '.data.json'));
    var cats = mdl.category.filter(function (a) {
        return typeof a !== 'string';
    });
    var qbeDataObjects = cats.filter(function (cat) {
        return cat.QBE || cat.QBEInclude;
    });
    //console.log("here cats" + JSON.stringify(cats));
    //console.log("\nhere data objects" + JSON.stringify(qbeDataObjects));
    var qbeDataNames = qbeDataObjects.map(function (cat) {
        return cat.name;
    });
    qbeDataNames = _.union(qbeDataNames, mdl.columns);
    var LUNRIndex = cats.filter(function (cat) {
        return cat.LUNRIndex;
    }).map(function (cat) {
        return cat.name;
    });
    //var elasticlunr = require('lunr');
    var bomdata = data;
    // index all LUNR properties
    var index = elasticlunr(function () {
        var that = this;
        LUNRIndex /*
                  ["appId",
                  "AppKey",
                  "AppName",
                    "ApplicationComponent",
                    "RoleName",
                    "ApplicationType",
                    "BSPName",
                    "BSPApplicationURL",
                    "releaseName",
                    "BusinessCatalog",
                    "TechnicalCatalog"] */
        .forEach(function (field) {
            that.addField(field);
        });
        this.setRef('id');
        this.saveDocument(false);
    });
    bomdata.forEach(function (o, index) {
        o.id = index;
    });
    bomdata.forEach(function (record) {
        index.addDoc(record);
    });
    var elastic = index;
    // dump the lunr index
    //
    var theIndex = index.toJSON();
    var columns = mdl.columns.map(function (colname) {
        var res = cats.filter(function (cat) {
            return cat.name === colname;
        });
        if (res.length !== 1) {
            throw new Error("undefined or non-object column : " + colname);
        }
        ;
        return res[0];
    });
    var columnNames = columns.map(function (col) {
        return col.name;
    });
    var jsonp = "var mdldata = {};\n//columns \n mdldata.columns = ['" + columns.map(function (col) {
        return col.name;
    }).join("','") + "'];";
    // jsonp += `\n mdldata.fulldata = ${JSON.stringify(bomdata)};\n`;
    //jsonp += `\n//columns info \n mdldata.lunrcolumns = ["{${LUNRIndex.join('","')}"];`;
    jsonp += "\n//columns info \n mdldata.columnsDescription = {" + columns.map(function (col) {
        return " \n \"" + col.name + "\" :  \"" + JSONEscape(col.description || col.name) + "\" ";
    }).join(',') + "\n      };";
    jsonp += "\n//columns info \n mdldata.columnsDefaultWidth = {" + columns.map(function (col) {
        return " \n \"" + col.name + "\" : " + (col.defaultWidth || 150) + " ";
    }).join(',') + "\n      };";
    var theIndexStr = JSON.stringify(theIndex);
    jsonp += "\nvar serIndex =\"" + JSONEscape(theIndexStr) + "\";\n";
    // jsonp += "\nvar serIndex =" + JSON.stringify(theIndex) + ";\n";
    //console.log("here all names " + JSON.stringify(qbeDataNames));
    var cleanseddata = bomdata.map(function (o) {
        var res = {};
        qbeDataNames.forEach(function (key) {
            res[key] = o[key];
        });
        return res;
    });
    if (!silent) {
        console.log("dumping " + output);
        console.log("length of index str" + theIndexStr.length);
        console.log("available          " + columns.length + " columns");
        console.log("returning as data  " + qbeDataNames.length + " columns");
        console.log("indexing           " + LUNRIndex.length + " columns");
        console.log('returned but not available', _.difference(qbeDataNames, columnNames).join(", "));
        console.log('returned but not indexed', _.difference(qbeDataNames, LUNRIndex).join(", "));
    }
    jsonp += "var data=" + JSON.stringify(cleanseddata) + ";";
    jsonp += "\n\n           // var elastic = elasticlunr.Index.load(serIndex);\n\n\n  ";
    fs.writeFileSync(output + ".lunr.js", jsonp);
}
exports.makeLunrIndex = makeLunrIndex;
/*

  var index = elastilunr.Index.load(obj);


}

 "QBE" : false,
      "QBEInclude" : true,
      "LUNRIndex": false
*/
function calcCategoryRecord(m, category, domain) {
    var otherdomains = Model.getDomainsForCategory(m, category);
    _.pull(otherdomains, domain);
    var res = {
        otherdomains: otherdomains,
        nrDistinctValues: 0,
        nrDistinctValuesInDomain: 0,
        nrRecords: 0,
        nrRecordsInDomain: 0,
        nrTotalRecordsInDomain: 0
    };
    var values = [];
    var valuesInDomain = [];
    var nrRecordsInDomain = 0;
    var distinctValues = m.records.forEach(function (oEntry) {
        if (oEntry._domain === domain) {
            res.nrTotalRecordsInDomain += 1;
        }
        if (oEntry[category]) {
            var value = oEntry[category];
            if (oEntry._domain === domain) {
                valuesInDomain[value] = (valuesInDomain[value] || 0) + 1;
                res.nrRecordsInDomain += 1;
            }
            values[value] = (values[value] || 0) + 1;
            res.nrRecords += 1;
        }
    });
    res.nrDistinctValues = Object.keys(values).length;
    res.nrDistinctValuesInDomain = Object.keys(valuesInDomain).length;
    return res;
}
exports.calcCategoryRecord = calcCategoryRecord;
function graphDomain(domain, m) {
    // draw a model domains
    var res = "\n    digraph sdsu {\n\tsize=\"36,36\";\n   rankdir=LR\n\tnode [color=yellow, style=filled];\n    \"" + domain + "\"\n  ";
    // add all category nodes
    res += "node [shape=record, color=yellow, style=filled];\n ";
    var cats = Model.getCategoriesForDomain(m, domain);
    var categoryResults = {};
    var otherdomains = [];
    cats.forEach(function (cat) {
        var catResult = calcCategoryRecord(m, cat, domain);
        categoryResults[cat] = catResult;
        otherdomains = _.union(otherdomains, categoryResults[cat].otherDomains);
        res += "\"" + cat + "\" [label=\"{ " + cat + " | " + catResult.nrDistinctValuesInDomain + " Values in " + catResult.nrRecordsInDomain + " ";
        if (catResult.nrRecordsInDomain !== catResult.nrRecords) {
            res += "|  " + (catResult.nrDistinctValues - catResult.nrDistinctValuesInDomain) + " other values in " + (catResult.nrRecords - catResult.nrRecordsInDomain) + " other records";
        } else {
            res += " ";
        }
        res += "}\"]\n";
    });
    // calculate other domains.
    // draw "other categories"
    res += "node [color=purple, style=filled]; \n";
    otherdomains.forEach(function (otherdomain) {
        res += "\"" + otherdomain + "\" \n";
    });
    // count records in domain :
    var nrRecords = m.records.reduce(function (prev, entry) {
        return prev + (entry._domain === domain ? 1 : 0);
    }, 0);
    res += "node [shape=record]; \n";
    res += " \"record\" [label=\"{<f0> " + domain + " | " + nrRecords + "}\"] \n";
    res += " \"r_other\" [label=\"{<f0> other | " + nrRecords + "}\"] \n ";
    res += "# relation from categories to domain\n";
    cats.forEach(function (cat) {
        res += " \"" + cat + "\" -> \"" + domain + "\" \n";
    });
    res += "# relation from categories to records\n";
    cats.forEach(function (cat) {
        var rec = categoryResults[cat];
        res += " \"" + cat + "\" -> \"record\" \n";
    });
    //other domains to this
    cats.forEach(function (cat) {});
    /*
    cats fo
      digraph sdsu {
      size="36,36";
      node [color=yellow, style=filled];
      FLPD FLP "BOM Editor", "WIKIURL" "UI5 Documentation", "UI5 Example", "STARTTA"
      BCP
      node [color=grey, style=filled];
      node [fontname="Verdana", size="30,30"];
      node [color=grey, style=filled];
      graph [ fontname = "Arial",
    */
    res += "}\n";
    return res;
}
exports.graphDomain = graphDomain;
/*
    categoryDesc : theModel.full.domain[filterdomain].categories[category],
    distinct : distinct,
    delta : delta,
    presentRecords : recordCount.presentrecords,
    percPresent : percent,
    sampleValues : valuesList
  }
*/
function replaceBr(string) {
    string = string.replace(/\n/g, "\n\t\t\t\t\t\t\t\t\t\t\tbr\n\t\t\t\t\t\t\t\t\t\t\t| ");
    return string;
}
/**
 * generate a textual representation of a domain
 */
function tabDomain(domain, m) {
    // draw a model domains
    var cats = Model.getCategoriesForDomain(m, domain);
    cats = Model.sortCategoriesByImportance(m.full.domain[domain].categories || {}, cats);
    //console.log(cats.join("\n"));
    var catdesc = Describe.getCategoryStatsInDomain(cats[0], domain, m);
    var catResult = calcCategoryRecord(m, cats[0], domain);
    var domainDescr = m.full.domain[domain].description || "";
    domainDescr = replaceBr(domainDescr);
    var res = "\n\n// preset form values if we receive a userdata object //\n- user = user\n\nextends ../layout_p\n\nblock content\n\n\tnav.navbar.navbar-default.navbar-fixed-top\n\t\t.container\n\t\t\t.navbar-header\n\t\t\t\t.navbar-brand(style='bgcolor:orange;color:darkblue;font-family:Arial Black;font-size:15.118px') wosap domain " + domain + "\n\t\t\tul.nav.navbar-nav.navbar-right #{uid}\n\t\t\t\tli\n\t\t\t\t\t.navbar-btn#btn-logout.btn.btn-default(onclick=\"location.href='/home'\")\n\t\t\t\t\t\t| back to home\n\n\tp  &nbsp;\n\tp &nbsp;\n\tp\n\n\tdiv.well\n\t\th3 domain \"" + domain + "\"\n\t\t\tspan.pull-right " + catResult.nrTotalRecordsInDomain + " records\n\t\tp\n\t\tspan " + domainDescr + "\n\n\t\ttable.table.table-condensed.table-striped\n\t\t\tthead\n\t\t\t\ttr\n\t\t\t\t\tth category\n\t\t\t\t\tth(style=\"width:10%\") count\n\t\t\t\t\tth\n\t\t\t\t\t\ttable\n\t\t\t\t\t\t\ttr\n\t\t\t\t\t\t\t\ttd synonyms\n\t\t\t\t\t\t\ttr\n\t\t\t\t\t\t\t\ttd description\n\t\t\t\t\t\t\ttr\n\t\t\t\t\t\t\t\ttd example values\n\t\t\ttbody\n";
    var categoryResults = {};
    var otherdomains = [];
    var categoryMap = m.full.domain[domain].categories || {};
    cats.forEach(function (cat) {
        var catdesc = Describe.getCategoryStatsInDomain(cat, domain, m);
        //console.log(JSON.stringify(catdesc));
        var catResult = calcCategoryRecord(m, cat, domain);
        categoryResults[cat] = catResult;
        otherdomains = _.union(otherdomains, categoryResults[cat].otherDomains);
        /*
            res += `"${cat}" [label="{ ${cat} | ${catResult.nrDistinctValuesInDomain} Values in ${catResult.nrRecordsInDomain} `;
            if(catResult.nrRecordsInDomain !== catResult.nrRecords) {
              res +=  `|  ${catResult.nrDistinctValues - catResult.nrDistinctValuesInDomain} other values in ${catResult.nrRecords - catResult.nrRecordsInDomain} other records`;
            } else {
              res += ` `;
            }
            res += `}"]\n`;
        */
        //console.log(JSON.stringify(m.full.domain[domain]));
        if (m.full.domain[domain].categories[cat]) {
            var synonymsString = Util.listToCommaAnd(catdesc.categoryDesc && catdesc.categoryDesc.synonyms && catdesc.categoryDesc.synonyms || []) || "&nbsp;";
            res += "\n\t\t\ttr\n\t\t\t\t\ttd.cat_count " + cat + "\n\t\t\t\t\ttd " + catdesc.presentRecords + " distinct values in " + catdesc.percPresent + "% of records\n\t\t\t\t\ttd\n\t\t\t\t\t\ttable\n\t\t\t\t\t\t\ttr.cat_synonyms\n\t\t\t\t\t\t\t\ttd " + synonymsString + "\n\t\t\t\t\t\t\ttr.cat_description\n\t\t\t\t\t\t\t\ttd " + replaceBr(catdesc.categoryDesc && catdesc.categoryDesc.description || "") + "\n\t\t\t\t\t\t\ttr.cat_samplevalues\n\t\t\t\t\t\t\t\ttd " + replaceBr(catdesc.sampleValues) + "\n      ";
        }
    });
    var othercats = cats.length - Object.keys(m.full.domain[domain].categories).length;
    var remainingCategories = _.difference(cats, Object.keys(m.full.domain[domain].categories));
    if (othercats > 0) {
        res += "\n\t\tp   and " + othercats + " other categories\n\t\t| " + Util.listToCommaAnd(remainingCategories) + "\n       ";
    }
    /*
      // calculate other domains.
      // draw "other categories"
      res += `node [color=purple, style=filled]; \n`
      otherdomains.forEach(function(otherdomain) {
        res += `"${otherdomain}" \n`;
      });
      // count records in domain :
      var nrRecords = m.records.reduce(function(prev,entry) {
      return prev + ((entry._domain === domain) ? 1 : 0);
      },0);
      res += `node [shape=record]; \n`
      res += ` "record" [label="{<f0> ${domain} | ${nrRecords}}"] \n`;
         res += ` "r_other" [label="{<f0> other | ${nrRecords}}"] \n `;
         res += `# relation from categories to domain\n`;
      cats.forEach(function(cat) {
        res += ` "${cat}" -> "${domain}" \n`;
      })
     
      res += `# relation from categories to records\n`;
      cats.forEach(function(cat) {
        var rec = categoryResults[cat];
        res += ` "${cat}" -> "record" \n`;
      })
     
      //other domains to this
      cats.forEach(function(cat) {
     
      })
    */
    /*
    cats fo
      digraph sdsu {
      size="36,36";
      node [color=yellow, style=filled];
      FLPD FLP "BOM Editor", "WIKIURL" "UI5 Documentation", "UI5 Example", "STARTTA"
      BCP
      node [color=grey, style=filled];
      node [fontname="Verdana", size="30,30"];
      node [color=grey, style=filled];
      graph [ fontname = "Arial",
    */
    res += "\n\t\th3 Version\n\t\t\ta.small(href=\"/whatsnew\")\n\n\nblock scripts\n\tscript(src='/vendor/jquery-2.2.3.min.js')\n\tscript(src='/vendor/bootstrap.min.js')\n\tscript(src='/js/views/settings.js')\n";
    return res;
}
exports.tabDomain = tabDomain;
var child_process_1 = require("child_process");
function execCmd(cmd) {
    child_process_1.exec(cmd, function (error, stdout, stderr) {
        if (error) {
            console.error("exec error: " + error);
            return;
        }
        console.log("stdout: " + stdout);
        console.log("stderr: " + stderr);
    });
}
;
function visModels(m, folderOut) {
    m.domains.forEach(function (sDomain) {
        var s = graphDomain(sDomain, m);
        var fnGraph = folderOut + "/" + sDomain.replace(/ /g, '_') + ".gv";
        fs.writeFileSync(fnGraph, s);
        if (process.env.GRAPHVIZ) {
            console.log("here the file " + fnGraph);
            execCmd(process.env.GRAPHVIZ + " -Tjpeg -O " + fnGraph);
        }
    });
}
exports.visModels = visModels;
function tabModels(m, folderOut) {
    m.domains.forEach(function (sDomain) {
        var s = tabDomain(sDomain, m);
        var fnGraph = folderOut + "/" + sDomain.replace(/ /g, '_') + ".jade";
        debuglog("here the file " + fnGraph);
        fs.writeFileSync(fnGraph, s);
    });
}
exports.tabModels = tabModels;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9tb2RlbC92aXNtb2RlbC50cyIsIm1vZGVsL3Zpc21vZGVsLmpzIl0sIm5hbWVzIjpbImZzIiwicmVxdWlyZSIsIk1vZGVsIiwiVXRpbCIsIkRlc2NyaWJlIiwiXyIsImRlYnVnIiwiZGVidWdsb2ciLCJlbGFzdGljbHVuciIsIkpTT05Fc2NhcGUiLCJzIiwicmVwbGFjZSIsImV4cG9ydHMiLCJtYWtlTHVuckluZGV4IiwibW9kZWxwYXRoIiwib3V0cHV0Iiwic2lsZW50IiwibWRsIiwiSlNPTiIsInBhcnNlIiwicmVhZEZpbGVTeW5jIiwiZGF0YSIsImNhdHMiLCJjYXRlZ29yeSIsImZpbHRlciIsImEiLCJxYmVEYXRhT2JqZWN0cyIsImNhdCIsIlFCRSIsIlFCRUluY2x1ZGUiLCJxYmVEYXRhTmFtZXMiLCJtYXAiLCJuYW1lIiwidW5pb24iLCJjb2x1bW5zIiwiTFVOUkluZGV4IiwiYm9tZGF0YSIsImluZGV4IiwidGhhdCIsImZvckVhY2giLCJmaWVsZCIsImFkZEZpZWxkIiwic2V0UmVmIiwic2F2ZURvY3VtZW50IiwibyIsImlkIiwicmVjb3JkIiwiYWRkRG9jIiwiZWxhc3RpYyIsInRoZUluZGV4IiwidG9KU09OIiwiY29sbmFtZSIsInJlcyIsImxlbmd0aCIsIkVycm9yIiwiY29sdW1uTmFtZXMiLCJjb2wiLCJqc29ucCIsImpvaW4iLCJkZXNjcmlwdGlvbiIsImRlZmF1bHRXaWR0aCIsInRoZUluZGV4U3RyIiwic3RyaW5naWZ5IiwiY2xlYW5zZWRkYXRhIiwia2V5IiwiY29uc29sZSIsImxvZyIsImRpZmZlcmVuY2UiLCJ3cml0ZUZpbGVTeW5jIiwiY2FsY0NhdGVnb3J5UmVjb3JkIiwibSIsImRvbWFpbiIsIm90aGVyZG9tYWlucyIsImdldERvbWFpbnNGb3JDYXRlZ29yeSIsInB1bGwiLCJuckRpc3RpbmN0VmFsdWVzIiwibnJEaXN0aW5jdFZhbHVlc0luRG9tYWluIiwibnJSZWNvcmRzIiwibnJSZWNvcmRzSW5Eb21haW4iLCJuclRvdGFsUmVjb3Jkc0luRG9tYWluIiwidmFsdWVzIiwidmFsdWVzSW5Eb21haW4iLCJkaXN0aW5jdFZhbHVlcyIsInJlY29yZHMiLCJvRW50cnkiLCJfZG9tYWluIiwidmFsdWUiLCJPYmplY3QiLCJrZXlzIiwiZ3JhcGhEb21haW4iLCJnZXRDYXRlZ29yaWVzRm9yRG9tYWluIiwiY2F0ZWdvcnlSZXN1bHRzIiwiY2F0UmVzdWx0Iiwib3RoZXJEb21haW5zIiwib3RoZXJkb21haW4iLCJyZWR1Y2UiLCJwcmV2IiwiZW50cnkiLCJyZWMiLCJyZXBsYWNlQnIiLCJzdHJpbmciLCJ0YWJEb21haW4iLCJzb3J0Q2F0ZWdvcmllc0J5SW1wb3J0YW5jZSIsImZ1bGwiLCJjYXRlZ29yaWVzIiwiY2F0ZGVzYyIsImdldENhdGVnb3J5U3RhdHNJbkRvbWFpbiIsImRvbWFpbkRlc2NyIiwiY2F0ZWdvcnlNYXAiLCJzeW5vbnltc1N0cmluZyIsImxpc3RUb0NvbW1hQW5kIiwiY2F0ZWdvcnlEZXNjIiwic3lub255bXMiLCJwcmVzZW50UmVjb3JkcyIsInBlcmNQcmVzZW50Iiwic2FtcGxlVmFsdWVzIiwib3RoZXJjYXRzIiwicmVtYWluaW5nQ2F0ZWdvcmllcyIsImNoaWxkX3Byb2Nlc3NfMSIsImV4ZWNDbWQiLCJjbWQiLCJleGVjIiwiZXJyb3IiLCJzdGRvdXQiLCJzdGRlcnIiLCJ2aXNNb2RlbHMiLCJmb2xkZXJPdXQiLCJkb21haW5zIiwic0RvbWFpbiIsImZuR3JhcGgiLCJwcm9jZXNzIiwiZW52IiwiR1JBUEhWSVoiLCJ0YWJNb2RlbHMiXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNHQTs7QURNQSxJQUFBQSxLQUFBQyxRQUFBLElBQUEsQ0FBQTtBQUVBLElBQUFDLFFBQUFELFFBQUEsU0FBQSxDQUFBO0FBQ0EsSUFBQUUsT0FBQUYsUUFBQSxnQkFBQSxDQUFBO0FBRUEsSUFBQUcsV0FBQUgsUUFBQSxtQkFBQSxDQUFBO0FBRUEsSUFBQUksSUFBQUosUUFBQSxRQUFBLENBQUE7QUFDQSxJQUFBSyxRQUFBTCxR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UXJILE9BQVIsQ0FBZ0IsSUFBaEIsRUFBc0IsR0FBdEIsQ0FBbEIsR0FBK0MsS0FBN0Q7QUFDQVgsV0FBR29FLGFBQUgsQ0FBaUI2RCxPQUFqQixFQUEwQnZILENBQTFCO0FBQ0EsWUFBSXdILFFBQVFDLEdBQVIsQ0FBWUMsUUFBaEIsRUFBMEI7QUFDeEJuRSxvQkFBUUMsR0FBUixDQUFZLG1CQUFtQitELE9BQS9CO0FBQ0FWLG9CQUFRVyxRQUFRQyxHQUFSLENBQVlDLFFBQVosR0FBdUIsYUFBdkIsR0FBdUNILE9BQS9DO0FBQ0Q7QUFDRixLQVJEO0FBU0Q7QUFWRHJILFFBQUFpSCxTQUFBLEdBQUFBLFNBQUE7QUFZQSxTQUFBUSxTQUFBLENBQTBCL0QsQ0FBMUIsRUFBNkN3RCxTQUE3QyxFQUE4RDtBQUM1RHhELE1BQUV5RCxPQUFGLENBQVV4RixPQUFWLENBQWtCLFVBQVV5RixPQUFWLEVBQWlCO0FBQ2pDLFlBQUl0SCxJQUFJMkYsVUFBVTJCLE9BQVYsRUFBbUIxRCxDQUFuQixDQUFSO0FBQ0EsWUFBSTJELFVBQVVILFlBQVksR0FBWixHQUFrQkUsUUFBUXJILE9BQVIsQ0FBZ0IsSUFBaEIsRUFBc0IsR0FBdEIsQ0FBbEIsR0FBK0MsT0FBN0Q7QUFDQUosaUJBQVMsbUJBQW1CMEgsT0FBNUI7QUFDQWpJLFdBQUdvRSxhQUFILENBQWlCNkQsT0FBakIsRUFBMEJ2SCxDQUExQjtBQUNELEtBTEQ7QUFNRDtBQVBERSxRQUFBeUgsU0FBQSxHQUFBQSxTQUFBIiwiZmlsZSI6Im1vZGVsL3Zpc21vZGVsLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiB2aXN1YWxpemUgYSBtb2RlbCBhbmQgY2FsY3VsYXRlIHNvbWUgc3RhdGlzdGljc1xuICovXG5cblxuXG5pbXBvcnQgKiBhcyBJTWF0Y2ggZnJvbSAnLi4vbWF0Y2gvaWZtYXRjaCc7XG5cblxuaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnO1xuXG5pbXBvcnQgKiBhcyBNb2RlbCBmcm9tICcuL21vZGVsJztcbmltcG9ydCAqIGFzIFV0aWwgZnJvbSAnLi4vdXRpbHMvdXRpbHMnO1xuXG5pbXBvcnQgKiBhcyBEZXNjcmliZSBmcm9tICcuLi9tYXRjaC9kZXNjcmliZSc7XG5cbmltcG9ydCAqIGFzIF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCAqIGFzIGRlYnVnIGZyb20gJ2RlYnVnJztcblxuLy9pbXBvcnQgKiBhcyBlbGFzdGljbHVuciBmcm9tICdlbGFzdGljbHVucic7XG5cbnZhciBkZWJ1Z2xvZyA9IGRlYnVnKCd2aXNtb2RlbC50cycpO1xuXG5pbnRlcmZhY2UgQ2F0ZWdvcnlSZWNvcmQge1xuICBvdGhlcmRvbWFpbnM6IHN0cmluZ1tdLFxuICBuckRpc3RpbmN0VmFsdWVzOiBudW1iZXIsXG4gIG5yRGlzdGluY3RWYWx1ZXNJbkRvbWFpbjogbnVtYmVyLFxuICBuclJlY29yZHM6IG51bWJlcixcbiAgbnJSZWNvcmRzSW5Eb21haW46IG51bWJlcixcbiAgbnJUb3RhbFJlY29yZHNJbkRvbWFpbjogbnVtYmVyXG59O1xuXG52YXIgZWxhc3RpY2x1bnIgPSByZXF1aXJlKCdlbGFzdGljbHVucicpO1xuXG5cbmV4cG9ydCBmdW5jdGlvbiBKU09ORXNjYXBlKHM6IHN0cmluZykge1xuXG4gIHJldHVybiBzLnJlcGxhY2UoL1xcXFwvZywgXCJcXFxcXFxcXFwiKS5yZXBsYWNlKC9cXG4vZywgXCJcXFxcblwiKVxuICAgIC5yZXBsYWNlKC9cXCcvZywgXCJcXFxcJ1wiKVxuICAgIC5yZXBsYWNlKC9cXFwiL2csICdcXFxcXCInKVxuICAgIC5yZXBsYWNlKC9cXCYvZywgXCJcXFxcJlwiKVxuICAgIC5yZXBsYWNlKC9cXHIvZywgXCJcXFxcclwiKVxuICAgIC5yZXBsYWNlKC9cXHQvZywgXCJcXFxcdFwiKTtcbiAgLy8gLnJlcGxhY2UoL1xcYi9nLCBcIlxcXFxiXCIpXG4gIC8vIC5yZXBsYWNlKC9cXGYvZywgXCJcXFxcZlwiKTtcbn07XG5cblxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VMdW5ySW5kZXgobW9kZWxwYXRoOiBzdHJpbmcsIG91dHB1dDogc3RyaW5nLCBzaWxlbnQgPyA6IGJvb2xlYW4pIHtcbiAgdmFyIG1kbCA9IEpTT04ucGFyc2UoJycgKyBmcy5yZWFkRmlsZVN5bmMobW9kZWxwYXRoICsgJy5tb2RlbC5qc29uJykpO1xuICB2YXIgZGF0YSA9IEpTT04ucGFyc2UoJycgKyBmcy5yZWFkRmlsZVN5bmMobW9kZWxwYXRoICsgJy5kYXRhLmpzb24nKSk7XG5cbiAgdmFyIGNhdHMgPSBtZGwuY2F0ZWdvcnkuZmlsdGVyKGEgPT4gdHlwZW9mIGEgIT09ICdzdHJpbmcnKTtcblxuICB2YXIgcWJlRGF0YU9iamVjdHMgPSBjYXRzLmZpbHRlcihjYXQgPT4gKGNhdC5RQkUgfHwgY2F0LlFCRUluY2x1ZGUpKTtcblxuICAvL2NvbnNvbGUubG9nKFwiaGVyZSBjYXRzXCIgKyBKU09OLnN0cmluZ2lmeShjYXRzKSk7XG4gIC8vY29uc29sZS5sb2coXCJcXG5oZXJlIGRhdGEgb2JqZWN0c1wiICsgSlNPTi5zdHJpbmdpZnkocWJlRGF0YU9iamVjdHMpKTtcbiAgdmFyIHFiZURhdGFOYW1lcyA9IHFiZURhdGFPYmplY3RzLm1hcChjYXQgPT4gY2F0Lm5hbWUpO1xuXG4gIHFiZURhdGFOYW1lcyA9IF8udW5pb24ocWJlRGF0YU5hbWVzLCBtZGwuY29sdW1ucylcblxuXG4gIHZhciBMVU5SSW5kZXggPSBjYXRzLmZpbHRlcihjYXQgPT4gY2F0LkxVTlJJbmRleCkubWFwKGNhdCA9PiBjYXQubmFtZSk7XG4gIC8vdmFyIGVsYXN0aWNsdW5yID0gcmVxdWlyZSgnbHVucicpO1xuICB2YXIgYm9tZGF0YSA9IGRhdGE7XG4gIC8vIGluZGV4IGFsbCBMVU5SIHByb3BlcnRpZXNcbiAgdmFyIGluZGV4ID0gZWxhc3RpY2x1bnIoZnVuY3Rpb24gKCkge1xuICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICBMVU5SSW5kZXggLypcbiAgICAgICAgICAgIFtcImFwcElkXCIsXG4gICAgICAgICAgICBcIkFwcEtleVwiLFxuICAgICAgICAgICAgXCJBcHBOYW1lXCIsXG4gICAgICAgICAgICAgICAgXCJBcHBsaWNhdGlvbkNvbXBvbmVudFwiLFxuICAgICAgICAgICAgICAgIFwiUm9sZU5hbWVcIixcbiAgICAgICAgICAgICAgICBcIkFwcGxpY2F0aW9uVHlwZVwiLFxuICAgICAgICAgICAgICAgIFwiQlNQTmFtZVwiLFxuICAgICAgICAgICAgICAgIFwiQlNQQXBwbGljYXRpb25VUkxcIixcbiAgICAgICAgICAgICAgICBcInJlbGVhc2VOYW1lXCIsXG4gICAgICAgICAgICAgICAgXCJCdXNpbmVzc0NhdGFsb2dcIixcbiAgICAgICAgICAgICAgICBcIlRlY2huaWNhbENhdGFsb2dcIl0gKi8gLmZvckVhY2goZnVuY3Rpb24gKGZpZWxkKSB7XG4gICAgICAgIHRoYXQuYWRkRmllbGQoZmllbGQpO1xuICAgICAgfSk7XG4gICAgdGhpcy5zZXRSZWYoJ2lkJyk7XG4gICAgdGhpcy5zYXZlRG9jdW1lbnQoZmFsc2UpO1xuICB9KTtcbiAgYm9tZGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChvLCBpbmRleCkge1xuICAgIG8uaWQgPSBpbmRleDtcbiAgfSk7XG4gIGJvbWRhdGEuZm9yRWFjaChmdW5jdGlvbiAocmVjb3JkKSB7XG4gICAgaW5kZXguYWRkRG9jKHJlY29yZCk7XG4gIH0pO1xuICB2YXIgZWxhc3RpYyA9IGluZGV4O1xuXG4gIC8vIGR1bXAgdGhlIGx1bnIgaW5kZXhcbiAgLy9cbiAgdmFyIHRoZUluZGV4ID0gaW5kZXgudG9KU09OKCk7XG4gIHZhciBjb2x1bW5zID0gbWRsLmNvbHVtbnMubWFwKGNvbG5hbWUgPT4gIHtcbiAgICB2YXIgcmVzID0gY2F0cy5maWx0ZXIoY2F0ID0+IGNhdC5uYW1lID09PSBjb2xuYW1lKTtcbiAgICBpZihyZXMubGVuZ3RoICE9PSAxKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJ1bmRlZmluZWQgb3Igbm9uLW9iamVjdCBjb2x1bW4gOiBcIiArIGNvbG5hbWUgKTtcbiAgICB9O1xuICAgIHJldHVybiByZXNbMF07XG4gIH0pO1xuXG4gIHZhciBjb2x1bW5OYW1lcyA9IGNvbHVtbnMubWFwKGNvbCA9PiBjb2wubmFtZSk7XG5cbiAgdmFyIGpzb25wID0gYHZhciBtZGxkYXRhID0ge307XFxuLy9jb2x1bW5zIFxcbiBtZGxkYXRhLmNvbHVtbnMgPSBbJyR7Y29sdW1ucy5tYXAoY29sID0+IGNvbC5uYW1lKS5qb2luKFwiJywnXCIpfSddO2A7XG5cbiAgLy8ganNvbnAgKz0gYFxcbiBtZGxkYXRhLmZ1bGxkYXRhID0gJHtKU09OLnN0cmluZ2lmeShib21kYXRhKX07XFxuYDtcbiAgLy9qc29ucCArPSBgXFxuLy9jb2x1bW5zIGluZm8gXFxuIG1kbGRhdGEubHVucmNvbHVtbnMgPSBbXCJ7JHtMVU5SSW5kZXguam9pbignXCIsXCInKX1cIl07YDtcblxuICBqc29ucCArPSBgXFxuLy9jb2x1bW5zIGluZm8gXFxuIG1kbGRhdGEuY29sdW1uc0Rlc2NyaXB0aW9uID0geyR7Y29sdW1ucy5tYXAoY29sID0+XG4gICAgYCBcXG4gXCIke2NvbC5uYW1lfVwiIDogIFwiJHtKU09ORXNjYXBlKGNvbC5kZXNjcmlwdGlvbiB8fCBjb2wubmFtZSl9XCIgYFxuICApLmpvaW4oJywnKX1cbiAgICAgIH07YDtcblxuICBqc29ucCArPSBgXFxuLy9jb2x1bW5zIGluZm8gXFxuIG1kbGRhdGEuY29sdW1uc0RlZmF1bHRXaWR0aCA9IHske2NvbHVtbnMubWFwKGNvbCA9PlxuICAgIGAgXFxuIFwiJHtjb2wubmFtZX1cIiA6ICR7Y29sLmRlZmF1bHRXaWR0aCB8fCAxNTB9IGBcbiAgKS5qb2luKCcsJyl9XG4gICAgICB9O2A7XG5cblxuXG4gIHZhciB0aGVJbmRleFN0ciA9IEpTT04uc3RyaW5naWZ5KHRoZUluZGV4KTtcblxuICBqc29ucCArPSBcIlxcbnZhciBzZXJJbmRleCA9XFxcIlwiICsgSlNPTkVzY2FwZSh0aGVJbmRleFN0cikgKyBcIlxcXCI7XFxuXCI7XG4gIC8vIGpzb25wICs9IFwiXFxudmFyIHNlckluZGV4ID1cIiArIEpTT04uc3RyaW5naWZ5KHRoZUluZGV4KSArIFwiO1xcblwiO1xuXG5cbiAgLy9jb25zb2xlLmxvZyhcImhlcmUgYWxsIG5hbWVzIFwiICsgSlNPTi5zdHJpbmdpZnkocWJlRGF0YU5hbWVzKSk7XG4gIHZhciBjbGVhbnNlZGRhdGEgPSBib21kYXRhLm1hcChvID0+IHtcbiAgICB2YXIgcmVzID0ge307XG4gICAgcWJlRGF0YU5hbWVzLmZvckVhY2goa2V5ID0+IHtcbiAgICAgIHJlc1trZXldID0gb1trZXldO1xuICAgIH0pO1xuICAgIHJldHVybiByZXM7XG4gIH0pO1xuXG4gIGlmKCFzaWxlbnQpIHtcbiAgICBjb25zb2xlLmxvZyhcImR1bXBpbmcgXCIgKyBvdXRwdXQpO1xuICAgIGNvbnNvbGUubG9nKFwibGVuZ3RoIG9mIGluZGV4IHN0clwiICsgdGhlSW5kZXhTdHIubGVuZ3RoKVxuICAgIGNvbnNvbGUubG9nKFwiYXZhaWxhYmxlICAgICAgICAgIFwiICsgY29sdW1ucy5sZW5ndGggKyBcIiBjb2x1bW5zXCIpO1xuICAgIGNvbnNvbGUubG9nKFwicmV0dXJuaW5nIGFzIGRhdGEgIFwiICsgcWJlRGF0YU5hbWVzLmxlbmd0aCArIFwiIGNvbHVtbnNcIik7XG4gICAgY29uc29sZS5sb2coXCJpbmRleGluZyAgICAgICAgICAgXCIgKyBMVU5SSW5kZXgubGVuZ3RoICsgXCIgY29sdW1uc1wiKTtcbiAgICBjb25zb2xlLmxvZygncmV0dXJuZWQgYnV0IG5vdCBhdmFpbGFibGUnICwgXy5kaWZmZXJlbmNlKHFiZURhdGFOYW1lcywgY29sdW1uTmFtZXMpLmpvaW4oXCIsIFwiKSk7XG4gICAgY29uc29sZS5sb2coJ3JldHVybmVkIGJ1dCBub3QgaW5kZXhlZCcgLCBfLmRpZmZlcmVuY2UocWJlRGF0YU5hbWVzLCBMVU5SSW5kZXgpLmpvaW4oXCIsIFwiKSk7XG4gIH1cblxuICBqc29ucCArPSBcInZhciBkYXRhPVwiICsgSlNPTi5zdHJpbmdpZnkoY2xlYW5zZWRkYXRhKSArIFwiO1wiO1xuXG5cbiAganNvbnAgKz0gYFxuXG4gICAgICAgICAgIC8vIHZhciBlbGFzdGljID0gZWxhc3RpY2x1bnIuSW5kZXgubG9hZChzZXJJbmRleCk7XG5cblxuICBgO1xuICBmcy53cml0ZUZpbGVTeW5jKG91dHB1dCArIFwiLmx1bnIuanNcIiwganNvbnApO1xufVxuXG5cblxuXG5cbi8qXG5cbiAgdmFyIGluZGV4ID0gZWxhc3RpbHVuci5JbmRleC5sb2FkKG9iaik7XG5cblxufVxuXG4gXCJRQkVcIiA6IGZhbHNlLFxuICAgICAgXCJRQkVJbmNsdWRlXCIgOiB0cnVlLFxuICAgICAgXCJMVU5SSW5kZXhcIjogZmFsc2VcbiovXG5cblxuXG5leHBvcnQgZnVuY3Rpb24gY2FsY0NhdGVnb3J5UmVjb3JkKG06IElNYXRjaC5JTW9kZWxzLCBjYXRlZ29yeTogc3RyaW5nLCBkb21haW46IHN0cmluZyk6IENhdGVnb3J5UmVjb3JkIHtcblxuICB2YXIgb3RoZXJkb21haW5zID0gTW9kZWwuZ2V0RG9tYWluc0ZvckNhdGVnb3J5KG0sIGNhdGVnb3J5KTtcbiAgXy5wdWxsKG90aGVyZG9tYWlucywgZG9tYWluKTtcbiAgdmFyIHJlcyA9IHtcbiAgICBvdGhlcmRvbWFpbnM6IG90aGVyZG9tYWlucyxcbiAgICBuckRpc3RpbmN0VmFsdWVzOiAwLFxuICAgIG5yRGlzdGluY3RWYWx1ZXNJbkRvbWFpbjogMCxcbiAgICBuclJlY29yZHM6IDAsXG4gICAgbnJSZWNvcmRzSW5Eb21haW46IDAsXG4gICAgbnJUb3RhbFJlY29yZHNJbkRvbWFpbjogMCxcbiAgfSBhcyBDYXRlZ29yeVJlY29yZDtcblxuICB2YXIgdmFsdWVzID0gW107XG4gIHZhciB2YWx1ZXNJbkRvbWFpbiA9IFtdO1xuICB2YXIgbnJSZWNvcmRzSW5Eb21haW4gPSAwO1xuICB2YXIgZGlzdGluY3RWYWx1ZXMgPSBtLnJlY29yZHMuZm9yRWFjaChmdW5jdGlvbiAob0VudHJ5KSB7XG4gICAgaWYgKG9FbnRyeS5fZG9tYWluID09PSBkb21haW4pIHtcbiAgICAgIHJlcy5uclRvdGFsUmVjb3Jkc0luRG9tYWluICs9IDE7XG4gICAgfVxuICAgIGlmIChvRW50cnlbY2F0ZWdvcnldKSB7XG4gICAgICB2YXIgdmFsdWUgPSBvRW50cnlbY2F0ZWdvcnldO1xuICAgICAgaWYgKG9FbnRyeS5fZG9tYWluID09PSBkb21haW4pIHtcbiAgICAgICAgdmFsdWVzSW5Eb21haW5bdmFsdWVdID0gKHZhbHVlc0luRG9tYWluW3ZhbHVlXSB8fCAwKSArIDE7XG4gICAgICAgIHJlcy5uclJlY29yZHNJbkRvbWFpbiArPSAxO1xuICAgICAgfVxuICAgICAgdmFsdWVzW3ZhbHVlXSA9ICh2YWx1ZXNbdmFsdWVdIHx8IDApICsgMTtcbiAgICAgIHJlcy5uclJlY29yZHMgKz0gMTtcbiAgICB9XG4gIH0pO1xuICByZXMubnJEaXN0aW5jdFZhbHVlcyA9IE9iamVjdC5rZXlzKHZhbHVlcykubGVuZ3RoO1xuICByZXMubnJEaXN0aW5jdFZhbHVlc0luRG9tYWluID0gT2JqZWN0LmtleXModmFsdWVzSW5Eb21haW4pLmxlbmd0aDtcbiAgcmV0dXJuIHJlcztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdyYXBoRG9tYWluKGRvbWFpbjogc3RyaW5nLCBtOiBJTWF0Y2guSU1vZGVscykge1xuICAvLyBkcmF3IGEgbW9kZWwgZG9tYWluc1xuICB2YXIgcmVzID0gYFxuICAgIGRpZ3JhcGggc2RzdSB7XG5cdHNpemU9XCIzNiwzNlwiO1xuICAgcmFua2Rpcj1MUlxuXHRub2RlIFtjb2xvcj15ZWxsb3csIHN0eWxlPWZpbGxlZF07XG4gICAgXCIke2RvbWFpbn1cIlxuICBgO1xuICAvLyBhZGQgYWxsIGNhdGVnb3J5IG5vZGVzXG4gIHJlcyArPSBgbm9kZSBbc2hhcGU9cmVjb3JkLCBjb2xvcj15ZWxsb3csIHN0eWxlPWZpbGxlZF07XFxuIGBcbiAgdmFyIGNhdHMgPSBNb2RlbC5nZXRDYXRlZ29yaWVzRm9yRG9tYWluKG0sIGRvbWFpbik7XG5cbiAgdmFyIGNhdGVnb3J5UmVzdWx0cyA9IHt9O1xuICB2YXIgb3RoZXJkb21haW5zID0gW107XG4gIGNhdHMuZm9yRWFjaChmdW5jdGlvbiAoY2F0KSB7XG4gICAgdmFyIGNhdFJlc3VsdCA9IGNhbGNDYXRlZ29yeVJlY29yZChtLCBjYXQsIGRvbWFpbik7XG4gICAgY2F0ZWdvcnlSZXN1bHRzW2NhdF0gPSBjYXRSZXN1bHQ7XG4gICAgb3RoZXJkb21haW5zID0gXy51bmlvbihvdGhlcmRvbWFpbnMsIGNhdGVnb3J5UmVzdWx0c1tjYXRdLm90aGVyRG9tYWlucyk7XG4gICAgcmVzICs9IGBcIiR7Y2F0fVwiIFtsYWJlbD1cInsgJHtjYXR9IHwgJHtjYXRSZXN1bHQubnJEaXN0aW5jdFZhbHVlc0luRG9tYWlufSBWYWx1ZXMgaW4gJHtjYXRSZXN1bHQubnJSZWNvcmRzSW5Eb21haW59IGA7XG4gICAgaWYgKGNhdFJlc3VsdC5uclJlY29yZHNJbkRvbWFpbiAhPT0gY2F0UmVzdWx0Lm5yUmVjb3Jkcykge1xuICAgICAgcmVzICs9IGB8ICAke2NhdFJlc3VsdC5uckRpc3RpbmN0VmFsdWVzIC0gY2F0UmVzdWx0Lm5yRGlzdGluY3RWYWx1ZXNJbkRvbWFpbn0gb3RoZXIgdmFsdWVzIGluICR7Y2F0UmVzdWx0Lm5yUmVjb3JkcyAtIGNhdFJlc3VsdC5uclJlY29yZHNJbkRvbWFpbn0gb3RoZXIgcmVjb3Jkc2A7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlcyArPSBgIGA7XG4gICAgfVxuICAgIHJlcyArPSBgfVwiXVxcbmA7XG4gIH0pO1xuXG4gIC8vIGNhbGN1bGF0ZSBvdGhlciBkb21haW5zLlxuICAvLyBkcmF3IFwib3RoZXIgY2F0ZWdvcmllc1wiXG4gIHJlcyArPSBgbm9kZSBbY29sb3I9cHVycGxlLCBzdHlsZT1maWxsZWRdOyBcXG5gXG4gIG90aGVyZG9tYWlucy5mb3JFYWNoKGZ1bmN0aW9uIChvdGhlcmRvbWFpbikge1xuICAgIHJlcyArPSBgXCIke290aGVyZG9tYWlufVwiIFxcbmA7XG4gIH0pO1xuICAvLyBjb3VudCByZWNvcmRzIGluIGRvbWFpbiA6XG4gIHZhciBuclJlY29yZHMgPSBtLnJlY29yZHMucmVkdWNlKGZ1bmN0aW9uIChwcmV2LCBlbnRyeSkge1xuICAgIHJldHVybiBwcmV2ICsgKChlbnRyeS5fZG9tYWluID09PSBkb21haW4pID8gMSA6IDApO1xuICB9LCAwKTtcbiAgcmVzICs9IGBub2RlIFtzaGFwZT1yZWNvcmRdOyBcXG5gXG4gIHJlcyArPSBgIFwicmVjb3JkXCIgW2xhYmVsPVwiezxmMD4gJHtkb21haW59IHwgJHtuclJlY29yZHN9fVwiXSBcXG5gO1xuXG4gIHJlcyArPSBgIFwicl9vdGhlclwiIFtsYWJlbD1cIns8ZjA+IG90aGVyIHwgJHtuclJlY29yZHN9fVwiXSBcXG4gYDtcblxuICByZXMgKz0gYCMgcmVsYXRpb24gZnJvbSBjYXRlZ29yaWVzIHRvIGRvbWFpblxcbmA7XG4gIGNhdHMuZm9yRWFjaChmdW5jdGlvbiAoY2F0KSB7XG4gICAgcmVzICs9IGAgXCIke2NhdH1cIiAtPiBcIiR7ZG9tYWlufVwiIFxcbmA7XG4gIH0pXG5cblxuICByZXMgKz0gYCMgcmVsYXRpb24gZnJvbSBjYXRlZ29yaWVzIHRvIHJlY29yZHNcXG5gO1xuICBjYXRzLmZvckVhY2goZnVuY3Rpb24gKGNhdCkge1xuICAgIHZhciByZWMgPSBjYXRlZ29yeVJlc3VsdHNbY2F0XTtcbiAgICByZXMgKz0gYCBcIiR7Y2F0fVwiIC0+IFwicmVjb3JkXCIgXFxuYDtcbiAgfSlcblxuXG4gIC8vb3RoZXIgZG9tYWlucyB0byB0aGlzXG4gIGNhdHMuZm9yRWFjaChmdW5jdGlvbiAoY2F0KSB7XG5cblxuICB9KVxuXG4gIC8qXG4gIGNhdHMgZm9cbiAgICBkaWdyYXBoIHNkc3Uge1xuXHRzaXplPVwiMzYsMzZcIjtcblx0bm9kZSBbY29sb3I9eWVsbG93LCBzdHlsZT1maWxsZWRdO1xuXHRGTFBEIEZMUCBcIkJPTSBFZGl0b3JcIiwgXCJXSUtJVVJMXCIgXCJVSTUgRG9jdW1lbnRhdGlvblwiLCBcIlVJNSBFeGFtcGxlXCIsIFwiU1RBUlRUQVwiXG5cdEJDUFxuXHRub2RlIFtjb2xvcj1ncmV5LCBzdHlsZT1maWxsZWRdO1xuXHRub2RlIFtmb250bmFtZT1cIlZlcmRhbmFcIiwgc2l6ZT1cIjMwLDMwXCJdO1xuXHRub2RlIFtjb2xvcj1ncmV5LCBzdHlsZT1maWxsZWRdO1xuXHRncmFwaCBbIGZvbnRuYW1lID0gXCJBcmlhbFwiLFxuICAqL1xuICByZXMgKz0gYH1cXG5gO1xuICByZXR1cm4gcmVzO1xufVxuLypcbiAgICBjYXRlZ29yeURlc2MgOiB0aGVNb2RlbC5mdWxsLmRvbWFpbltmaWx0ZXJkb21haW5dLmNhdGVnb3JpZXNbY2F0ZWdvcnldLFxuICAgIGRpc3RpbmN0IDogZGlzdGluY3QsXG4gICAgZGVsdGEgOiBkZWx0YSxcbiAgICBwcmVzZW50UmVjb3JkcyA6IHJlY29yZENvdW50LnByZXNlbnRyZWNvcmRzLFxuICAgIHBlcmNQcmVzZW50IDogcGVyY2VudCxcbiAgICBzYW1wbGVWYWx1ZXMgOiB2YWx1ZXNMaXN0XG4gIH1cbiovXG5cbmZ1bmN0aW9uIHJlcGxhY2VCcihzdHJpbmc6IHN0cmluZyk6IHN0cmluZyB7XG4gIHN0cmluZyA9IHN0cmluZy5yZXBsYWNlKC9cXG4vZyxcbiAgICBgXG5cXHRcXHRcXHRcXHRcXHRcXHRcXHRcXHRcXHRcXHRcXHRiclxuXFx0XFx0XFx0XFx0XFx0XFx0XFx0XFx0XFx0XFx0XFx0fCBgXG4gICk7XG4gIHJldHVybiBzdHJpbmc7XG59XG5cblxuXG5cbi8qKlxuICogZ2VuZXJhdGUgYSB0ZXh0dWFsIHJlcHJlc2VudGF0aW9uIG9mIGEgZG9tYWluXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0YWJEb21haW4oZG9tYWluOiBzdHJpbmcsIG06IElNYXRjaC5JTW9kZWxzKSB7XG4gIC8vIGRyYXcgYSBtb2RlbCBkb21haW5zXG5cbiAgdmFyIGNhdHMgPSBNb2RlbC5nZXRDYXRlZ29yaWVzRm9yRG9tYWluKG0sIGRvbWFpbik7XG4gIGNhdHMgPSBNb2RlbC5zb3J0Q2F0ZWdvcmllc0J5SW1wb3J0YW5jZShtLmZ1bGwuZG9tYWluW2RvbWFpbl0uY2F0ZWdvcmllcyB8fCB7fSwgY2F0cyk7XG4gIC8vY29uc29sZS5sb2coY2F0cy5qb2luKFwiXFxuXCIpKTtcbiAgdmFyIGNhdGRlc2MgPSBEZXNjcmliZS5nZXRDYXRlZ29yeVN0YXRzSW5Eb21haW4oY2F0c1swXSwgZG9tYWluLCBtKTtcbiAgdmFyIGNhdFJlc3VsdCA9IGNhbGNDYXRlZ29yeVJlY29yZChtLCBjYXRzWzBdLCBkb21haW4pO1xuXG4gIHZhciBkb21haW5EZXNjciA9IG0uZnVsbC5kb21haW5bZG9tYWluXS5kZXNjcmlwdGlvbiB8fCBcIlwiO1xuICBkb21haW5EZXNjciA9IHJlcGxhY2VCcihkb21haW5EZXNjcik7XG4gIHZhciByZXMgPSBgXG5cbi8vIHByZXNldCBmb3JtIHZhbHVlcyBpZiB3ZSByZWNlaXZlIGEgdXNlcmRhdGEgb2JqZWN0IC8vXG4tIHVzZXIgPSB1c2VyXG5cbmV4dGVuZHMgLi4vbGF5b3V0X3BcblxuYmxvY2sgY29udGVudFxuXG5cdG5hdi5uYXZiYXIubmF2YmFyLWRlZmF1bHQubmF2YmFyLWZpeGVkLXRvcFxuXHRcdC5jb250YWluZXJcblx0XHRcdC5uYXZiYXItaGVhZGVyXG5cdFx0XHRcdC5uYXZiYXItYnJhbmQoc3R5bGU9J2JnY29sb3I6b3JhbmdlO2NvbG9yOmRhcmtibHVlO2ZvbnQtZmFtaWx5OkFyaWFsIEJsYWNrO2ZvbnQtc2l6ZToxNS4xMThweCcpIHdvc2FwIGRvbWFpbiAke2RvbWFpbn1cblx0XHRcdHVsLm5hdi5uYXZiYXItbmF2Lm5hdmJhci1yaWdodCAje3VpZH1cblx0XHRcdFx0bGlcblx0XHRcdFx0XHQubmF2YmFyLWJ0biNidG4tbG9nb3V0LmJ0bi5idG4tZGVmYXVsdChvbmNsaWNrPVwibG9jYXRpb24uaHJlZj0nL2hvbWUnXCIpXG5cdFx0XHRcdFx0XHR8IGJhY2sgdG8gaG9tZVxuXG5cdHAgICZuYnNwO1xuXHRwICZuYnNwO1xuXHRwXG5cblx0ZGl2LndlbGxcblx0XHRoMyBkb21haW4gXCIke2RvbWFpbn1cIlxuXHRcdFx0c3Bhbi5wdWxsLXJpZ2h0ICR7Y2F0UmVzdWx0Lm5yVG90YWxSZWNvcmRzSW5Eb21haW59IHJlY29yZHNcblx0XHRwXG5cdFx0c3BhbiAke2RvbWFpbkRlc2NyfVxuXG5cdFx0dGFibGUudGFibGUudGFibGUtY29uZGVuc2VkLnRhYmxlLXN0cmlwZWRcblx0XHRcdHRoZWFkXG5cdFx0XHRcdHRyXG5cdFx0XHRcdFx0dGggY2F0ZWdvcnlcblx0XHRcdFx0XHR0aChzdHlsZT1cIndpZHRoOjEwJVwiKSBjb3VudFxuXHRcdFx0XHRcdHRoXG5cdFx0XHRcdFx0XHR0YWJsZVxuXHRcdFx0XHRcdFx0XHR0clxuXHRcdFx0XHRcdFx0XHRcdHRkIHN5bm9ueW1zXG5cdFx0XHRcdFx0XHRcdHRyXG5cdFx0XHRcdFx0XHRcdFx0dGQgZGVzY3JpcHRpb25cblx0XHRcdFx0XHRcdFx0dHJcblx0XHRcdFx0XHRcdFx0XHR0ZCBleGFtcGxlIHZhbHVlc1xuXHRcdFx0dGJvZHlcbmA7XG5cbiAgdmFyIGNhdGVnb3J5UmVzdWx0cyA9IHt9O1xuICB2YXIgb3RoZXJkb21haW5zID0gW107XG4gIHZhciBjYXRlZ29yeU1hcCA9IG0uZnVsbC5kb21haW5bZG9tYWluXS5jYXRlZ29yaWVzIHx8IHt9O1xuICBjYXRzLmZvckVhY2goZnVuY3Rpb24gKGNhdCkge1xuICAgIHZhciBjYXRkZXNjID0gRGVzY3JpYmUuZ2V0Q2F0ZWdvcnlTdGF0c0luRG9tYWluKGNhdCwgZG9tYWluLCBtKTtcbiAgICAvL2NvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGNhdGRlc2MpKTtcbiAgICB2YXIgY2F0UmVzdWx0ID0gY2FsY0NhdGVnb3J5UmVjb3JkKG0sIGNhdCwgZG9tYWluKTtcbiAgICBjYXRlZ29yeVJlc3VsdHNbY2F0XSA9IGNhdFJlc3VsdDtcbiAgICBvdGhlcmRvbWFpbnMgPSBfLnVuaW9uKG90aGVyZG9tYWlucywgY2F0ZWdvcnlSZXN1bHRzW2NhdF0ub3RoZXJEb21haW5zKTtcbiAgICAvKlxuICAgICAgICByZXMgKz0gYFwiJHtjYXR9XCIgW2xhYmVsPVwieyAke2NhdH0gfCAke2NhdFJlc3VsdC5uckRpc3RpbmN0VmFsdWVzSW5Eb21haW59IFZhbHVlcyBpbiAke2NhdFJlc3VsdC5uclJlY29yZHNJbkRvbWFpbn0gYDtcbiAgICAgICAgaWYoY2F0UmVzdWx0Lm5yUmVjb3Jkc0luRG9tYWluICE9PSBjYXRSZXN1bHQubnJSZWNvcmRzKSB7XG4gICAgICAgICAgcmVzICs9ICBgfCAgJHtjYXRSZXN1bHQubnJEaXN0aW5jdFZhbHVlcyAtIGNhdFJlc3VsdC5uckRpc3RpbmN0VmFsdWVzSW5Eb21haW59IG90aGVyIHZhbHVlcyBpbiAke2NhdFJlc3VsdC5uclJlY29yZHMgLSBjYXRSZXN1bHQubnJSZWNvcmRzSW5Eb21haW59IG90aGVyIHJlY29yZHNgO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlcyArPSBgIGA7XG4gICAgICAgIH1cbiAgICAgICAgcmVzICs9IGB9XCJdXFxuYDtcbiAgICAqL1xuICAgIC8vY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkobS5mdWxsLmRvbWFpbltkb21haW5dKSk7XG4gICAgaWYgKG0uZnVsbC5kb21haW5bZG9tYWluXS5jYXRlZ29yaWVzW2NhdF0pIHtcblxuICAgICAgdmFyIHN5bm9ueW1zU3RyaW5nID0gVXRpbC5saXN0VG9Db21tYUFuZChjYXRkZXNjLmNhdGVnb3J5RGVzYyAmJiBjYXRkZXNjLmNhdGVnb3J5RGVzYy5zeW5vbnltcyAmJiBjYXRkZXNjLmNhdGVnb3J5RGVzYy5zeW5vbnltcyB8fCBbXSkgfHwgXCImbmJzcDtcIjtcblxuICAgICAgcmVzICs9IGBcblx0XHRcdHRyXG5cdFx0XHRcdFx0dGQuY2F0X2NvdW50ICR7Y2F0fVxuXFx0XFx0XFx0XFx0XFx0dGQgJHtjYXRkZXNjLnByZXNlbnRSZWNvcmRzfSBkaXN0aW5jdCB2YWx1ZXMgaW4gJHtjYXRkZXNjLnBlcmNQcmVzZW50fSUgb2YgcmVjb3Jkc1xuXFx0XFx0XFx0XFx0XFx0dGRcblxcdFxcdFxcdFxcdFxcdFxcdHRhYmxlXG5cXHRcXHRcXHRcXHRcXHRcXHRcXHR0ci5jYXRfc3lub255bXNcblxcdFxcdFxcdFxcdFxcdFxcdFxcdFxcdHRkICR7c3lub255bXNTdHJpbmd9XG5cXHRcXHRcXHRcXHRcXHRcXHRcXHR0ci5jYXRfZGVzY3JpcHRpb25cblxcdFxcdFxcdFxcdFxcdFxcdFxcdFxcdHRkICR7cmVwbGFjZUJyKGNhdGRlc2MuY2F0ZWdvcnlEZXNjICYmIGNhdGRlc2MuY2F0ZWdvcnlEZXNjLmRlc2NyaXB0aW9uIHx8IFwiXCIpfVxuXFx0XFx0XFx0XFx0XFx0XFx0XFx0dHIuY2F0X3NhbXBsZXZhbHVlc1xuXFx0XFx0XFx0XFx0XFx0XFx0XFx0XFx0dGQgJHtyZXBsYWNlQnIoY2F0ZGVzYy5zYW1wbGVWYWx1ZXMpfVxuICAgICAgYDtcbiAgICB9XG5cbiAgfSk7XG5cbiAgdmFyIG90aGVyY2F0cyA9IGNhdHMubGVuZ3RoIC0gT2JqZWN0LmtleXMobS5mdWxsLmRvbWFpbltkb21haW5dLmNhdGVnb3JpZXMpLmxlbmd0aDtcbiAgdmFyIHJlbWFpbmluZ0NhdGVnb3JpZXMgPSBfLmRpZmZlcmVuY2UoY2F0cywgT2JqZWN0LmtleXMobS5mdWxsLmRvbWFpbltkb21haW5dLmNhdGVnb3JpZXMpKTtcbiAgaWYgKChvdGhlcmNhdHMpID4gMCkge1xuICAgIHJlcyArPSBgXG5cXHRcXHRwICAgYW5kICR7b3RoZXJjYXRzfSBvdGhlciBjYXRlZ29yaWVzXG5cXHRcXHR8ICR7VXRpbC5saXN0VG9Db21tYUFuZChyZW1haW5pbmdDYXRlZ29yaWVzKX1cbiAgICAgICBgXG5cbiAgfVxuICAvKlxuICAgIC8vIGNhbGN1bGF0ZSBvdGhlciBkb21haW5zLlxuICAgIC8vIGRyYXcgXCJvdGhlciBjYXRlZ29yaWVzXCJcbiAgICByZXMgKz0gYG5vZGUgW2NvbG9yPXB1cnBsZSwgc3R5bGU9ZmlsbGVkXTsgXFxuYFxuICAgIG90aGVyZG9tYWlucy5mb3JFYWNoKGZ1bmN0aW9uKG90aGVyZG9tYWluKSB7XG4gICAgICByZXMgKz0gYFwiJHtvdGhlcmRvbWFpbn1cIiBcXG5gO1xuICAgIH0pO1xuICAgIC8vIGNvdW50IHJlY29yZHMgaW4gZG9tYWluIDpcbiAgICB2YXIgbnJSZWNvcmRzID0gbS5yZWNvcmRzLnJlZHVjZShmdW5jdGlvbihwcmV2LGVudHJ5KSB7XG4gICAgcmV0dXJuIHByZXYgKyAoKGVudHJ5Ll9kb21haW4gPT09IGRvbWFpbikgPyAxIDogMCk7XG4gICAgfSwwKTtcbiAgICByZXMgKz0gYG5vZGUgW3NoYXBlPXJlY29yZF07IFxcbmBcbiAgICByZXMgKz0gYCBcInJlY29yZFwiIFtsYWJlbD1cIns8ZjA+ICR7ZG9tYWlufSB8ICR7bnJSZWNvcmRzfX1cIl0gXFxuYDtcblxuICAgIHJlcyArPSBgIFwicl9vdGhlclwiIFtsYWJlbD1cIns8ZjA+IG90aGVyIHwgJHtuclJlY29yZHN9fVwiXSBcXG4gYDtcblxuICAgIHJlcyArPSBgIyByZWxhdGlvbiBmcm9tIGNhdGVnb3JpZXMgdG8gZG9tYWluXFxuYDtcbiAgICBjYXRzLmZvckVhY2goZnVuY3Rpb24oY2F0KSB7XG4gICAgICByZXMgKz0gYCBcIiR7Y2F0fVwiIC0+IFwiJHtkb21haW59XCIgXFxuYDtcbiAgICB9KVxuXG5cbiAgICByZXMgKz0gYCMgcmVsYXRpb24gZnJvbSBjYXRlZ29yaWVzIHRvIHJlY29yZHNcXG5gO1xuICAgIGNhdHMuZm9yRWFjaChmdW5jdGlvbihjYXQpIHtcbiAgICAgIHZhciByZWMgPSBjYXRlZ29yeVJlc3VsdHNbY2F0XTtcbiAgICAgIHJlcyArPSBgIFwiJHtjYXR9XCIgLT4gXCJyZWNvcmRcIiBcXG5gO1xuICAgIH0pXG5cblxuICAgIC8vb3RoZXIgZG9tYWlucyB0byB0aGlzXG4gICAgY2F0cy5mb3JFYWNoKGZ1bmN0aW9uKGNhdCkge1xuXG5cbiAgICB9KVxuICAqL1xuICAvKlxuICBjYXRzIGZvXG4gICAgZGlncmFwaCBzZHN1IHtcblx0c2l6ZT1cIjM2LDM2XCI7XG5cdG5vZGUgW2NvbG9yPXllbGxvdywgc3R5bGU9ZmlsbGVkXTtcblx0RkxQRCBGTFAgXCJCT00gRWRpdG9yXCIsIFwiV0lLSVVSTFwiIFwiVUk1IERvY3VtZW50YXRpb25cIiwgXCJVSTUgRXhhbXBsZVwiLCBcIlNUQVJUVEFcIlxuXHRCQ1Bcblx0bm9kZSBbY29sb3I9Z3JleSwgc3R5bGU9ZmlsbGVkXTtcblx0bm9kZSBbZm9udG5hbWU9XCJWZXJkYW5hXCIsIHNpemU9XCIzMCwzMFwiXTtcblx0bm9kZSBbY29sb3I9Z3JleSwgc3R5bGU9ZmlsbGVkXTtcblx0Z3JhcGggWyBmb250bmFtZSA9IFwiQXJpYWxcIixcbiAgKi9cbiAgcmVzICs9IGBcblx0XHRoMyBWZXJzaW9uXG5cdFx0XHRhLnNtYWxsKGhyZWY9XCIvd2hhdHNuZXdcIilcblxuXG5ibG9jayBzY3JpcHRzXG5cdHNjcmlwdChzcmM9Jy92ZW5kb3IvanF1ZXJ5LTIuMi4zLm1pbi5qcycpXG5cdHNjcmlwdChzcmM9Jy92ZW5kb3IvYm9vdHN0cmFwLm1pbi5qcycpXG5cdHNjcmlwdChzcmM9Jy9qcy92aWV3cy9zZXR0aW5ncy5qcycpXG5gO1xuICByZXR1cm4gcmVzO1xufVxuXG5cblxuaW1wb3J0IHsgZXhlYyB9IGZyb20gJ2NoaWxkX3Byb2Nlc3MnO1xuXG5cbmZ1bmN0aW9uIGV4ZWNDbWQoY21kOiBzdHJpbmcpIHtcbiAgZXhlYyhjbWQsIGZ1bmN0aW9uIChlcnJvciwgc3Rkb3V0LCBzdGRlcnIpIHtcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYGV4ZWMgZXJyb3I6ICR7ZXJyb3J9YClcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBjb25zb2xlLmxvZyhgc3Rkb3V0OiAke3N0ZG91dH1gKVxuICAgIGNvbnNvbGUubG9nKGBzdGRlcnI6ICR7c3RkZXJyfWApXG4gIH0pXG59O1xuXG5leHBvcnQgZnVuY3Rpb24gdmlzTW9kZWxzKG06IElNYXRjaC5JTW9kZWxzLCBmb2xkZXJPdXQ6IHN0cmluZykge1xuICBtLmRvbWFpbnMuZm9yRWFjaChmdW5jdGlvbiAoc0RvbWFpbikge1xuICAgIHZhciBzID0gZ3JhcGhEb21haW4oc0RvbWFpbiwgbSk7XG4gICAgdmFyIGZuR3JhcGggPSBmb2xkZXJPdXQgKyBcIi9cIiArIHNEb21haW4ucmVwbGFjZSgvIC9nLCAnXycpICsgXCIuZ3ZcIjtcbiAgICBmcy53cml0ZUZpbGVTeW5jKGZuR3JhcGgsIHMpO1xuICAgIGlmIChwcm9jZXNzLmVudi5HUkFQSFZJWikge1xuICAgICAgY29uc29sZS5sb2coXCJoZXJlIHRoZSBmaWxlIFwiICsgZm5HcmFwaCk7XG4gICAgICBleGVjQ21kKHByb2Nlc3MuZW52LkdSQVBIVklaICsgXCIgLVRqcGVnIC1PIFwiICsgZm5HcmFwaCk7XG4gICAgfVxuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRhYk1vZGVscyhtOiBJTWF0Y2guSU1vZGVscywgZm9sZGVyT3V0OiBzdHJpbmcpIHtcbiAgbS5kb21haW5zLmZvckVhY2goZnVuY3Rpb24gKHNEb21haW4pIHtcbiAgICB2YXIgcyA9IHRhYkRvbWFpbihzRG9tYWluLCBtKTtcbiAgICB2YXIgZm5HcmFwaCA9IGZvbGRlck91dCArIFwiL1wiICsgc0RvbWFpbi5yZXBsYWNlKC8gL2csICdfJykgKyBcIi5qYWRlXCI7XG4gICAgZGVidWdsb2coXCJoZXJlIHRoZSBmaWxlIFwiICsgZm5HcmFwaCk7XG4gICAgZnMud3JpdGVGaWxlU3luYyhmbkdyYXBoLCBzKTtcbiAgfSk7XG59XG4iLCIvKipcbiAqIHZpc3VhbGl6ZSBhIG1vZGVsIGFuZCBjYWxjdWxhdGUgc29tZSBzdGF0aXN0aWNzXG4gKi9cblwidXNlIHN0cmljdFwiO1xudmFyIGZzID0gcmVxdWlyZShcImZzXCIpO1xudmFyIE1vZGVsID0gcmVxdWlyZShcIi4vbW9kZWxcIik7XG52YXIgVXRpbCA9IHJlcXVpcmUoXCIuLi91dGlscy91dGlsc1wiKTtcbnZhciBEZXNjcmliZSA9IHJlcXVpcmUoXCIuLi9tYXRjaC9kZXNjcmliZVwiKTtcbnZhciBfID0gcmVxdWlyZShcImxvZGFzaFwiKTtcbnZhciBkZWJ1ZyA9IHJlcXVpcmUoXCJkZWJ1Z1wiKTtcbi8vaW1wb3J0ICogYXMgZWxhc3RpY2x1bnIgZnJvbSAnZWxhc3RpY2x1bnInO1xudmFyIGRlYnVnbG9nID0gZGVidWcoJ3Zpc21vZGVsLnRzJyk7XG47XG52YXIgZWxhc3RpY2x1bnIgPSByZXF1aXJlKCdlbGFzdGljbHVucicpO1xuZnVuY3Rpb24gSlNPTkVzY2FwZShzKSB7XG4gICAgcmV0dXJuIHMucmVwbGFjZSgvXFxcXC9nLCBcIlxcXFxcXFxcXCIpLnJlcGxhY2UoL1xcbi9nLCBcIlxcXFxuXCIpXG4gICAgICAgIC5yZXBsYWNlKC9cXCcvZywgXCJcXFxcJ1wiKVxuICAgICAgICAucmVwbGFjZSgvXFxcIi9nLCAnXFxcXFwiJylcbiAgICAgICAgLnJlcGxhY2UoL1xcJi9nLCBcIlxcXFwmXCIpXG4gICAgICAgIC5yZXBsYWNlKC9cXHIvZywgXCJcXFxcclwiKVxuICAgICAgICAucmVwbGFjZSgvXFx0L2csIFwiXFxcXHRcIik7XG4gICAgLy8gLnJlcGxhY2UoL1xcYi9nLCBcIlxcXFxiXCIpXG4gICAgLy8gLnJlcGxhY2UoL1xcZi9nLCBcIlxcXFxmXCIpO1xufVxuZXhwb3J0cy5KU09ORXNjYXBlID0gSlNPTkVzY2FwZTtcbjtcbmZ1bmN0aW9uIG1ha2VMdW5ySW5kZXgobW9kZWxwYXRoLCBvdXRwdXQsIHNpbGVudCkge1xuICAgIHZhciBtZGwgPSBKU09OLnBhcnNlKCcnICsgZnMucmVhZEZpbGVTeW5jKG1vZGVscGF0aCArICcubW9kZWwuanNvbicpKTtcbiAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UoJycgKyBmcy5yZWFkRmlsZVN5bmMobW9kZWxwYXRoICsgJy5kYXRhLmpzb24nKSk7XG4gICAgdmFyIGNhdHMgPSBtZGwuY2F0ZWdvcnkuZmlsdGVyKGZ1bmN0aW9uIChhKSB7IHJldHVybiB0eXBlb2YgYSAhPT0gJ3N0cmluZyc7IH0pO1xuICAgIHZhciBxYmVEYXRhT2JqZWN0cyA9IGNhdHMuZmlsdGVyKGZ1bmN0aW9uIChjYXQpIHsgcmV0dXJuIChjYXQuUUJFIHx8IGNhdC5RQkVJbmNsdWRlKTsgfSk7XG4gICAgLy9jb25zb2xlLmxvZyhcImhlcmUgY2F0c1wiICsgSlNPTi5zdHJpbmdpZnkoY2F0cykpO1xuICAgIC8vY29uc29sZS5sb2coXCJcXG5oZXJlIGRhdGEgb2JqZWN0c1wiICsgSlNPTi5zdHJpbmdpZnkocWJlRGF0YU9iamVjdHMpKTtcbiAgICB2YXIgcWJlRGF0YU5hbWVzID0gcWJlRGF0YU9iamVjdHMubWFwKGZ1bmN0aW9uIChjYXQpIHsgcmV0dXJuIGNhdC5uYW1lOyB9KTtcbiAgICBxYmVEYXRhTmFtZXMgPSBfLnVuaW9uKHFiZURhdGFOYW1lcywgbWRsLmNvbHVtbnMpO1xuICAgIHZhciBMVU5SSW5kZXggPSBjYXRzLmZpbHRlcihmdW5jdGlvbiAoY2F0KSB7IHJldHVybiBjYXQuTFVOUkluZGV4OyB9KS5tYXAoZnVuY3Rpb24gKGNhdCkgeyByZXR1cm4gY2F0Lm5hbWU7IH0pO1xuICAgIC8vdmFyIGVsYXN0aWNsdW5yID0gcmVxdWlyZSgnbHVucicpO1xuICAgIHZhciBib21kYXRhID0gZGF0YTtcbiAgICAvLyBpbmRleCBhbGwgTFVOUiBwcm9wZXJ0aWVzXG4gICAgdmFyIGluZGV4ID0gZWxhc3RpY2x1bnIoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgIExVTlJJbmRleCAvKlxuICAgICAgICAgICAgICAgIFtcImFwcElkXCIsXG4gICAgICAgICAgICAgICAgXCJBcHBLZXlcIixcbiAgICAgICAgICAgICAgICBcIkFwcE5hbWVcIixcbiAgICAgICAgICAgICAgICAgICAgXCJBcHBsaWNhdGlvbkNvbXBvbmVudFwiLFxuICAgICAgICAgICAgICAgICAgICBcIlJvbGVOYW1lXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiQXBwbGljYXRpb25UeXBlXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiQlNQTmFtZVwiLFxuICAgICAgICAgICAgICAgICAgICBcIkJTUEFwcGxpY2F0aW9uVVJMXCIsXG4gICAgICAgICAgICAgICAgICAgIFwicmVsZWFzZU5hbWVcIixcbiAgICAgICAgICAgICAgICAgICAgXCJCdXNpbmVzc0NhdGFsb2dcIixcbiAgICAgICAgICAgICAgICAgICAgXCJUZWNobmljYWxDYXRhbG9nXCJdICovXG4gICAgICAgICAgICAuZm9yRWFjaChmdW5jdGlvbiAoZmllbGQpIHtcbiAgICAgICAgICAgIHRoYXQuYWRkRmllbGQoZmllbGQpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zZXRSZWYoJ2lkJyk7XG4gICAgICAgIHRoaXMuc2F2ZURvY3VtZW50KGZhbHNlKTtcbiAgICB9KTtcbiAgICBib21kYXRhLmZvckVhY2goZnVuY3Rpb24gKG8sIGluZGV4KSB7XG4gICAgICAgIG8uaWQgPSBpbmRleDtcbiAgICB9KTtcbiAgICBib21kYXRhLmZvckVhY2goZnVuY3Rpb24gKHJlY29yZCkge1xuICAgICAgICBpbmRleC5hZGREb2MocmVjb3JkKTtcbiAgICB9KTtcbiAgICB2YXIgZWxhc3RpYyA9IGluZGV4O1xuICAgIC8vIGR1bXAgdGhlIGx1bnIgaW5kZXhcbiAgICAvL1xuICAgIHZhciB0aGVJbmRleCA9IGluZGV4LnRvSlNPTigpO1xuICAgIHZhciBjb2x1bW5zID0gbWRsLmNvbHVtbnMubWFwKGZ1bmN0aW9uIChjb2xuYW1lKSB7XG4gICAgICAgIHZhciByZXMgPSBjYXRzLmZpbHRlcihmdW5jdGlvbiAoY2F0KSB7IHJldHVybiBjYXQubmFtZSA9PT0gY29sbmFtZTsgfSk7XG4gICAgICAgIGlmIChyZXMubGVuZ3RoICE9PSAxKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJ1bmRlZmluZWQgb3Igbm9uLW9iamVjdCBjb2x1bW4gOiBcIiArIGNvbG5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIDtcbiAgICAgICAgcmV0dXJuIHJlc1swXTtcbiAgICB9KTtcbiAgICB2YXIgY29sdW1uTmFtZXMgPSBjb2x1bW5zLm1hcChmdW5jdGlvbiAoY29sKSB7IHJldHVybiBjb2wubmFtZTsgfSk7XG4gICAgdmFyIGpzb25wID0gXCJ2YXIgbWRsZGF0YSA9IHt9O1xcbi8vY29sdW1ucyBcXG4gbWRsZGF0YS5jb2x1bW5zID0gWydcIiArIGNvbHVtbnMubWFwKGZ1bmN0aW9uIChjb2wpIHsgcmV0dXJuIGNvbC5uYW1lOyB9KS5qb2luKFwiJywnXCIpICsgXCInXTtcIjtcbiAgICAvLyBqc29ucCArPSBgXFxuIG1kbGRhdGEuZnVsbGRhdGEgPSAke0pTT04uc3RyaW5naWZ5KGJvbWRhdGEpfTtcXG5gO1xuICAgIC8vanNvbnAgKz0gYFxcbi8vY29sdW1ucyBpbmZvIFxcbiBtZGxkYXRhLmx1bnJjb2x1bW5zID0gW1wieyR7TFVOUkluZGV4LmpvaW4oJ1wiLFwiJyl9XCJdO2A7XG4gICAganNvbnAgKz0gXCJcXG4vL2NvbHVtbnMgaW5mbyBcXG4gbWRsZGF0YS5jb2x1bW5zRGVzY3JpcHRpb24gPSB7XCIgKyBjb2x1bW5zLm1hcChmdW5jdGlvbiAoY29sKSB7XG4gICAgICAgIHJldHVybiBcIiBcXG4gXFxcIlwiICsgY29sLm5hbWUgKyBcIlxcXCIgOiAgXFxcIlwiICsgSlNPTkVzY2FwZShjb2wuZGVzY3JpcHRpb24gfHwgY29sLm5hbWUpICsgXCJcXFwiIFwiO1xuICAgIH0pLmpvaW4oJywnKSArIFwiXFxuICAgICAgfTtcIjtcbiAgICBqc29ucCArPSBcIlxcbi8vY29sdW1ucyBpbmZvIFxcbiBtZGxkYXRhLmNvbHVtbnNEZWZhdWx0V2lkdGggPSB7XCIgKyBjb2x1bW5zLm1hcChmdW5jdGlvbiAoY29sKSB7XG4gICAgICAgIHJldHVybiBcIiBcXG4gXFxcIlwiICsgY29sLm5hbWUgKyBcIlxcXCIgOiBcIiArIChjb2wuZGVmYXVsdFdpZHRoIHx8IDE1MCkgKyBcIiBcIjtcbiAgICB9KS5qb2luKCcsJykgKyBcIlxcbiAgICAgIH07XCI7XG4gICAgdmFyIHRoZUluZGV4U3RyID0gSlNPTi5zdHJpbmdpZnkodGhlSW5kZXgpO1xuICAgIGpzb25wICs9IFwiXFxudmFyIHNlckluZGV4ID1cXFwiXCIgKyBKU09ORXNjYXBlKHRoZUluZGV4U3RyKSArIFwiXFxcIjtcXG5cIjtcbiAgICAvLyBqc29ucCArPSBcIlxcbnZhciBzZXJJbmRleCA9XCIgKyBKU09OLnN0cmluZ2lmeSh0aGVJbmRleCkgKyBcIjtcXG5cIjtcbiAgICAvL2NvbnNvbGUubG9nKFwiaGVyZSBhbGwgbmFtZXMgXCIgKyBKU09OLnN0cmluZ2lmeShxYmVEYXRhTmFtZXMpKTtcbiAgICB2YXIgY2xlYW5zZWRkYXRhID0gYm9tZGF0YS5tYXAoZnVuY3Rpb24gKG8pIHtcbiAgICAgICAgdmFyIHJlcyA9IHt9O1xuICAgICAgICBxYmVEYXRhTmFtZXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICByZXNba2V5XSA9IG9ba2V5XTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfSk7XG4gICAgaWYgKCFzaWxlbnQpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJkdW1waW5nIFwiICsgb3V0cHV0KTtcbiAgICAgICAgY29uc29sZS5sb2coXCJsZW5ndGggb2YgaW5kZXggc3RyXCIgKyB0aGVJbmRleFN0ci5sZW5ndGgpO1xuICAgICAgICBjb25zb2xlLmxvZyhcImF2YWlsYWJsZSAgICAgICAgICBcIiArIGNvbHVtbnMubGVuZ3RoICsgXCIgY29sdW1uc1wiKTtcbiAgICAgICAgY29uc29sZS5sb2coXCJyZXR1cm5pbmcgYXMgZGF0YSAgXCIgKyBxYmVEYXRhTmFtZXMubGVuZ3RoICsgXCIgY29sdW1uc1wiKTtcbiAgICAgICAgY29uc29sZS5sb2coXCJpbmRleGluZyAgICAgICAgICAgXCIgKyBMVU5SSW5kZXgubGVuZ3RoICsgXCIgY29sdW1uc1wiKTtcbiAgICAgICAgY29uc29sZS5sb2coJ3JldHVybmVkIGJ1dCBub3QgYXZhaWxhYmxlJywgXy5kaWZmZXJlbmNlKHFiZURhdGFOYW1lcywgY29sdW1uTmFtZXMpLmpvaW4oXCIsIFwiKSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdyZXR1cm5lZCBidXQgbm90IGluZGV4ZWQnLCBfLmRpZmZlcmVuY2UocWJlRGF0YU5hbWVzLCBMVU5SSW5kZXgpLmpvaW4oXCIsIFwiKSk7XG4gICAgfVxuICAgIGpzb25wICs9IFwidmFyIGRhdGE9XCIgKyBKU09OLnN0cmluZ2lmeShjbGVhbnNlZGRhdGEpICsgXCI7XCI7XG4gICAganNvbnAgKz0gXCJcXG5cXG4gICAgICAgICAgIC8vIHZhciBlbGFzdGljID0gZWxhc3RpY2x1bnIuSW5kZXgubG9hZChzZXJJbmRleCk7XFxuXFxuXFxuICBcIjtcbiAgICBmcy53cml0ZUZpbGVTeW5jKG91dHB1dCArIFwiLmx1bnIuanNcIiwganNvbnApO1xufVxuZXhwb3J0cy5tYWtlTHVuckluZGV4ID0gbWFrZUx1bnJJbmRleDtcbi8qXG5cbiAgdmFyIGluZGV4ID0gZWxhc3RpbHVuci5JbmRleC5sb2FkKG9iaik7XG5cblxufVxuXG4gXCJRQkVcIiA6IGZhbHNlLFxuICAgICAgXCJRQkVJbmNsdWRlXCIgOiB0cnVlLFxuICAgICAgXCJMVU5SSW5kZXhcIjogZmFsc2VcbiovXG5mdW5jdGlvbiBjYWxjQ2F0ZWdvcnlSZWNvcmQobSwgY2F0ZWdvcnksIGRvbWFpbikge1xuICAgIHZhciBvdGhlcmRvbWFpbnMgPSBNb2RlbC5nZXREb21haW5zRm9yQ2F0ZWdvcnkobSwgY2F0ZWdvcnkpO1xuICAgIF8ucHVsbChvdGhlcmRvbWFpbnMsIGRvbWFpbik7XG4gICAgdmFyIHJlcyA9IHtcbiAgICAgICAgb3RoZXJkb21haW5zOiBvdGhlcmRvbWFpbnMsXG4gICAgICAgIG5yRGlzdGluY3RWYWx1ZXM6IDAsXG4gICAgICAgIG5yRGlzdGluY3RWYWx1ZXNJbkRvbWFpbjogMCxcbiAgICAgICAgbnJSZWNvcmRzOiAwLFxuICAgICAgICBuclJlY29yZHNJbkRvbWFpbjogMCxcbiAgICAgICAgbnJUb3RhbFJlY29yZHNJbkRvbWFpbjogMCxcbiAgICB9O1xuICAgIHZhciB2YWx1ZXMgPSBbXTtcbiAgICB2YXIgdmFsdWVzSW5Eb21haW4gPSBbXTtcbiAgICB2YXIgbnJSZWNvcmRzSW5Eb21haW4gPSAwO1xuICAgIHZhciBkaXN0aW5jdFZhbHVlcyA9IG0ucmVjb3Jkcy5mb3JFYWNoKGZ1bmN0aW9uIChvRW50cnkpIHtcbiAgICAgICAgaWYgKG9FbnRyeS5fZG9tYWluID09PSBkb21haW4pIHtcbiAgICAgICAgICAgIHJlcy5uclRvdGFsUmVjb3Jkc0luRG9tYWluICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9FbnRyeVtjYXRlZ29yeV0pIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IG9FbnRyeVtjYXRlZ29yeV07XG4gICAgICAgICAgICBpZiAob0VudHJ5Ll9kb21haW4gPT09IGRvbWFpbikge1xuICAgICAgICAgICAgICAgIHZhbHVlc0luRG9tYWluW3ZhbHVlXSA9ICh2YWx1ZXNJbkRvbWFpblt2YWx1ZV0gfHwgMCkgKyAxO1xuICAgICAgICAgICAgICAgIHJlcy5uclJlY29yZHNJbkRvbWFpbiArPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFsdWVzW3ZhbHVlXSA9ICh2YWx1ZXNbdmFsdWVdIHx8IDApICsgMTtcbiAgICAgICAgICAgIHJlcy5uclJlY29yZHMgKz0gMTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJlcy5uckRpc3RpbmN0VmFsdWVzID0gT2JqZWN0LmtleXModmFsdWVzKS5sZW5ndGg7XG4gICAgcmVzLm5yRGlzdGluY3RWYWx1ZXNJbkRvbWFpbiA9IE9iamVjdC5rZXlzKHZhbHVlc0luRG9tYWluKS5sZW5ndGg7XG4gICAgcmV0dXJuIHJlcztcbn1cbmV4cG9ydHMuY2FsY0NhdGVnb3J5UmVjb3JkID0gY2FsY0NhdGVnb3J5UmVjb3JkO1xuZnVuY3Rpb24gZ3JhcGhEb21haW4oZG9tYWluLCBtKSB7XG4gICAgLy8gZHJhdyBhIG1vZGVsIGRvbWFpbnNcbiAgICB2YXIgcmVzID0gXCJcXG4gICAgZGlncmFwaCBzZHN1IHtcXG5cXHRzaXplPVxcXCIzNiwzNlxcXCI7XFxuICAgcmFua2Rpcj1MUlxcblxcdG5vZGUgW2NvbG9yPXllbGxvdywgc3R5bGU9ZmlsbGVkXTtcXG4gICAgXFxcIlwiICsgZG9tYWluICsgXCJcXFwiXFxuICBcIjtcbiAgICAvLyBhZGQgYWxsIGNhdGVnb3J5IG5vZGVzXG4gICAgcmVzICs9IFwibm9kZSBbc2hhcGU9cmVjb3JkLCBjb2xvcj15ZWxsb3csIHN0eWxlPWZpbGxlZF07XFxuIFwiO1xuICAgIHZhciBjYXRzID0gTW9kZWwuZ2V0Q2F0ZWdvcmllc0ZvckRvbWFpbihtLCBkb21haW4pO1xuICAgIHZhciBjYXRlZ29yeVJlc3VsdHMgPSB7fTtcbiAgICB2YXIgb3RoZXJkb21haW5zID0gW107XG4gICAgY2F0cy5mb3JFYWNoKGZ1bmN0aW9uIChjYXQpIHtcbiAgICAgICAgdmFyIGNhdFJlc3VsdCA9IGNhbGNDYXRlZ29yeVJlY29yZChtLCBjYXQsIGRvbWFpbik7XG4gICAgICAgIGNhdGVnb3J5UmVzdWx0c1tjYXRdID0gY2F0UmVzdWx0O1xuICAgICAgICBvdGhlcmRvbWFpbnMgPSBfLnVuaW9uKG90aGVyZG9tYWlucywgY2F0ZWdvcnlSZXN1bHRzW2NhdF0ub3RoZXJEb21haW5zKTtcbiAgICAgICAgcmVzICs9IFwiXFxcIlwiICsgY2F0ICsgXCJcXFwiIFtsYWJlbD1cXFwieyBcIiArIGNhdCArIFwiIHwgXCIgKyBjYXRSZXN1bHQubnJEaXN0aW5jdFZhbHVlc0luRG9tYWluICsgXCIgVmFsdWVzIGluIFwiICsgY2F0UmVzdWx0Lm5yUmVjb3Jkc0luRG9tYWluICsgXCIgXCI7XG4gICAgICAgIGlmIChjYXRSZXN1bHQubnJSZWNvcmRzSW5Eb21haW4gIT09IGNhdFJlc3VsdC5uclJlY29yZHMpIHtcbiAgICAgICAgICAgIHJlcyArPSBcInwgIFwiICsgKGNhdFJlc3VsdC5uckRpc3RpbmN0VmFsdWVzIC0gY2F0UmVzdWx0Lm5yRGlzdGluY3RWYWx1ZXNJbkRvbWFpbikgKyBcIiBvdGhlciB2YWx1ZXMgaW4gXCIgKyAoY2F0UmVzdWx0Lm5yUmVjb3JkcyAtIGNhdFJlc3VsdC5uclJlY29yZHNJbkRvbWFpbikgKyBcIiBvdGhlciByZWNvcmRzXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXMgKz0gXCIgXCI7XG4gICAgICAgIH1cbiAgICAgICAgcmVzICs9IFwifVxcXCJdXFxuXCI7XG4gICAgfSk7XG4gICAgLy8gY2FsY3VsYXRlIG90aGVyIGRvbWFpbnMuXG4gICAgLy8gZHJhdyBcIm90aGVyIGNhdGVnb3JpZXNcIlxuICAgIHJlcyArPSBcIm5vZGUgW2NvbG9yPXB1cnBsZSwgc3R5bGU9ZmlsbGVkXTsgXFxuXCI7XG4gICAgb3RoZXJkb21haW5zLmZvckVhY2goZnVuY3Rpb24gKG90aGVyZG9tYWluKSB7XG4gICAgICAgIHJlcyArPSBcIlxcXCJcIiArIG90aGVyZG9tYWluICsgXCJcXFwiIFxcblwiO1xuICAgIH0pO1xuICAgIC8vIGNvdW50IHJlY29yZHMgaW4gZG9tYWluIDpcbiAgICB2YXIgbnJSZWNvcmRzID0gbS5yZWNvcmRzLnJlZHVjZShmdW5jdGlvbiAocHJldiwgZW50cnkpIHtcbiAgICAgICAgcmV0dXJuIHByZXYgKyAoKGVudHJ5Ll9kb21haW4gPT09IGRvbWFpbikgPyAxIDogMCk7XG4gICAgfSwgMCk7XG4gICAgcmVzICs9IFwibm9kZSBbc2hhcGU9cmVjb3JkXTsgXFxuXCI7XG4gICAgcmVzICs9IFwiIFxcXCJyZWNvcmRcXFwiIFtsYWJlbD1cXFwiezxmMD4gXCIgKyBkb21haW4gKyBcIiB8IFwiICsgbnJSZWNvcmRzICsgXCJ9XFxcIl0gXFxuXCI7XG4gICAgcmVzICs9IFwiIFxcXCJyX290aGVyXFxcIiBbbGFiZWw9XFxcIns8ZjA+IG90aGVyIHwgXCIgKyBuclJlY29yZHMgKyBcIn1cXFwiXSBcXG4gXCI7XG4gICAgcmVzICs9IFwiIyByZWxhdGlvbiBmcm9tIGNhdGVnb3JpZXMgdG8gZG9tYWluXFxuXCI7XG4gICAgY2F0cy5mb3JFYWNoKGZ1bmN0aW9uIChjYXQpIHtcbiAgICAgICAgcmVzICs9IFwiIFxcXCJcIiArIGNhdCArIFwiXFxcIiAtPiBcXFwiXCIgKyBkb21haW4gKyBcIlxcXCIgXFxuXCI7XG4gICAgfSk7XG4gICAgcmVzICs9IFwiIyByZWxhdGlvbiBmcm9tIGNhdGVnb3JpZXMgdG8gcmVjb3Jkc1xcblwiO1xuICAgIGNhdHMuZm9yRWFjaChmdW5jdGlvbiAoY2F0KSB7XG4gICAgICAgIHZhciByZWMgPSBjYXRlZ29yeVJlc3VsdHNbY2F0XTtcbiAgICAgICAgcmVzICs9IFwiIFxcXCJcIiArIGNhdCArIFwiXFxcIiAtPiBcXFwicmVjb3JkXFxcIiBcXG5cIjtcbiAgICB9KTtcbiAgICAvL290aGVyIGRvbWFpbnMgdG8gdGhpc1xuICAgIGNhdHMuZm9yRWFjaChmdW5jdGlvbiAoY2F0KSB7XG4gICAgfSk7XG4gICAgLypcbiAgICBjYXRzIGZvXG4gICAgICBkaWdyYXBoIHNkc3Uge1xuICAgICAgc2l6ZT1cIjM2LDM2XCI7XG4gICAgICBub2RlIFtjb2xvcj15ZWxsb3csIHN0eWxlPWZpbGxlZF07XG4gICAgICBGTFBEIEZMUCBcIkJPTSBFZGl0b3JcIiwgXCJXSUtJVVJMXCIgXCJVSTUgRG9jdW1lbnRhdGlvblwiLCBcIlVJNSBFeGFtcGxlXCIsIFwiU1RBUlRUQVwiXG4gICAgICBCQ1BcbiAgICAgIG5vZGUgW2NvbG9yPWdyZXksIHN0eWxlPWZpbGxlZF07XG4gICAgICBub2RlIFtmb250bmFtZT1cIlZlcmRhbmFcIiwgc2l6ZT1cIjMwLDMwXCJdO1xuICAgICAgbm9kZSBbY29sb3I9Z3JleSwgc3R5bGU9ZmlsbGVkXTtcbiAgICAgIGdyYXBoIFsgZm9udG5hbWUgPSBcIkFyaWFsXCIsXG4gICAgKi9cbiAgICByZXMgKz0gXCJ9XFxuXCI7XG4gICAgcmV0dXJuIHJlcztcbn1cbmV4cG9ydHMuZ3JhcGhEb21haW4gPSBncmFwaERvbWFpbjtcbi8qXG4gICAgY2F0ZWdvcnlEZXNjIDogdGhlTW9kZWwuZnVsbC5kb21haW5bZmlsdGVyZG9tYWluXS5jYXRlZ29yaWVzW2NhdGVnb3J5XSxcbiAgICBkaXN0aW5jdCA6IGRpc3RpbmN0LFxuICAgIGRlbHRhIDogZGVsdGEsXG4gICAgcHJlc2VudFJlY29yZHMgOiByZWNvcmRDb3VudC5wcmVzZW50cmVjb3JkcyxcbiAgICBwZXJjUHJlc2VudCA6IHBlcmNlbnQsXG4gICAgc2FtcGxlVmFsdWVzIDogdmFsdWVzTGlzdFxuICB9XG4qL1xuZnVuY3Rpb24gcmVwbGFjZUJyKHN0cmluZykge1xuICAgIHN0cmluZyA9IHN0cmluZy5yZXBsYWNlKC9cXG4vZywgXCJcXG5cXHRcXHRcXHRcXHRcXHRcXHRcXHRcXHRcXHRcXHRcXHRiclxcblxcdFxcdFxcdFxcdFxcdFxcdFxcdFxcdFxcdFxcdFxcdHwgXCIpO1xuICAgIHJldHVybiBzdHJpbmc7XG59XG4vKipcbiAqIGdlbmVyYXRlIGEgdGV4dHVhbCByZXByZXNlbnRhdGlvbiBvZiBhIGRvbWFpblxuICovXG5mdW5jdGlvbiB0YWJEb21haW4oZG9tYWluLCBtKSB7XG4gICAgLy8gZHJhdyBhIG1vZGVsIGRvbWFpbnNcbiAgICB2YXIgY2F0cyA9IE1vZGVsLmdldENhdGVnb3JpZXNGb3JEb21haW4obSwgZG9tYWluKTtcbiAgICBjYXRzID0gTW9kZWwuc29ydENhdGVnb3JpZXNCeUltcG9ydGFuY2UobS5mdWxsLmRvbWFpbltkb21haW5dLmNhdGVnb3JpZXMgfHwge30sIGNhdHMpO1xuICAgIC8vY29uc29sZS5sb2coY2F0cy5qb2luKFwiXFxuXCIpKTtcbiAgICB2YXIgY2F0ZGVzYyA9IERlc2NyaWJlLmdldENhdGVnb3J5U3RhdHNJbkRvbWFpbihjYXRzWzBdLCBkb21haW4sIG0pO1xuICAgIHZhciBjYXRSZXN1bHQgPSBjYWxjQ2F0ZWdvcnlSZWNvcmQobSwgY2F0c1swXSwgZG9tYWluKTtcbiAgICB2YXIgZG9tYWluRGVzY3IgPSBtLmZ1bGwuZG9tYWluW2RvbWFpbl0uZGVzY3JpcHRpb24gfHwgXCJcIjtcbiAgICBkb21haW5EZXNjciA9IHJlcGxhY2VCcihkb21haW5EZXNjcik7XG4gICAgdmFyIHJlcyA9IFwiXFxuXFxuLy8gcHJlc2V0IGZvcm0gdmFsdWVzIGlmIHdlIHJlY2VpdmUgYSB1c2VyZGF0YSBvYmplY3QgLy9cXG4tIHVzZXIgPSB1c2VyXFxuXFxuZXh0ZW5kcyAuLi9sYXlvdXRfcFxcblxcbmJsb2NrIGNvbnRlbnRcXG5cXG5cXHRuYXYubmF2YmFyLm5hdmJhci1kZWZhdWx0Lm5hdmJhci1maXhlZC10b3BcXG5cXHRcXHQuY29udGFpbmVyXFxuXFx0XFx0XFx0Lm5hdmJhci1oZWFkZXJcXG5cXHRcXHRcXHRcXHQubmF2YmFyLWJyYW5kKHN0eWxlPSdiZ2NvbG9yOm9yYW5nZTtjb2xvcjpkYXJrYmx1ZTtmb250LWZhbWlseTpBcmlhbCBCbGFjaztmb250LXNpemU6MTUuMTE4cHgnKSB3b3NhcCBkb21haW4gXCIgKyBkb21haW4gKyBcIlxcblxcdFxcdFxcdHVsLm5hdi5uYXZiYXItbmF2Lm5hdmJhci1yaWdodCAje3VpZH1cXG5cXHRcXHRcXHRcXHRsaVxcblxcdFxcdFxcdFxcdFxcdC5uYXZiYXItYnRuI2J0bi1sb2dvdXQuYnRuLmJ0bi1kZWZhdWx0KG9uY2xpY2s9XFxcImxvY2F0aW9uLmhyZWY9Jy9ob21lJ1xcXCIpXFxuXFx0XFx0XFx0XFx0XFx0XFx0fCBiYWNrIHRvIGhvbWVcXG5cXG5cXHRwICAmbmJzcDtcXG5cXHRwICZuYnNwO1xcblxcdHBcXG5cXG5cXHRkaXYud2VsbFxcblxcdFxcdGgzIGRvbWFpbiBcXFwiXCIgKyBkb21haW4gKyBcIlxcXCJcXG5cXHRcXHRcXHRzcGFuLnB1bGwtcmlnaHQgXCIgKyBjYXRSZXN1bHQubnJUb3RhbFJlY29yZHNJbkRvbWFpbiArIFwiIHJlY29yZHNcXG5cXHRcXHRwXFxuXFx0XFx0c3BhbiBcIiArIGRvbWFpbkRlc2NyICsgXCJcXG5cXG5cXHRcXHR0YWJsZS50YWJsZS50YWJsZS1jb25kZW5zZWQudGFibGUtc3RyaXBlZFxcblxcdFxcdFxcdHRoZWFkXFxuXFx0XFx0XFx0XFx0dHJcXG5cXHRcXHRcXHRcXHRcXHR0aCBjYXRlZ29yeVxcblxcdFxcdFxcdFxcdFxcdHRoKHN0eWxlPVxcXCJ3aWR0aDoxMCVcXFwiKSBjb3VudFxcblxcdFxcdFxcdFxcdFxcdHRoXFxuXFx0XFx0XFx0XFx0XFx0XFx0dGFibGVcXG5cXHRcXHRcXHRcXHRcXHRcXHRcXHR0clxcblxcdFxcdFxcdFxcdFxcdFxcdFxcdFxcdHRkIHN5bm9ueW1zXFxuXFx0XFx0XFx0XFx0XFx0XFx0XFx0dHJcXG5cXHRcXHRcXHRcXHRcXHRcXHRcXHRcXHR0ZCBkZXNjcmlwdGlvblxcblxcdFxcdFxcdFxcdFxcdFxcdFxcdHRyXFxuXFx0XFx0XFx0XFx0XFx0XFx0XFx0XFx0dGQgZXhhbXBsZSB2YWx1ZXNcXG5cXHRcXHRcXHR0Ym9keVxcblwiO1xuICAgIHZhciBjYXRlZ29yeVJlc3VsdHMgPSB7fTtcbiAgICB2YXIgb3RoZXJkb21haW5zID0gW107XG4gICAgdmFyIGNhdGVnb3J5TWFwID0gbS5mdWxsLmRvbWFpbltkb21haW5dLmNhdGVnb3JpZXMgfHwge307XG4gICAgY2F0cy5mb3JFYWNoKGZ1bmN0aW9uIChjYXQpIHtcbiAgICAgICAgdmFyIGNhdGRlc2MgPSBEZXNjcmliZS5nZXRDYXRlZ29yeVN0YXRzSW5Eb21haW4oY2F0LCBkb21haW4sIG0pO1xuICAgICAgICAvL2NvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGNhdGRlc2MpKTtcbiAgICAgICAgdmFyIGNhdFJlc3VsdCA9IGNhbGNDYXRlZ29yeVJlY29yZChtLCBjYXQsIGRvbWFpbik7XG4gICAgICAgIGNhdGVnb3J5UmVzdWx0c1tjYXRdID0gY2F0UmVzdWx0O1xuICAgICAgICBvdGhlcmRvbWFpbnMgPSBfLnVuaW9uKG90aGVyZG9tYWlucywgY2F0ZWdvcnlSZXN1bHRzW2NhdF0ub3RoZXJEb21haW5zKTtcbiAgICAgICAgLypcbiAgICAgICAgICAgIHJlcyArPSBgXCIke2NhdH1cIiBbbGFiZWw9XCJ7ICR7Y2F0fSB8ICR7Y2F0UmVzdWx0Lm5yRGlzdGluY3RWYWx1ZXNJbkRvbWFpbn0gVmFsdWVzIGluICR7Y2F0UmVzdWx0Lm5yUmVjb3Jkc0luRG9tYWlufSBgO1xuICAgICAgICAgICAgaWYoY2F0UmVzdWx0Lm5yUmVjb3Jkc0luRG9tYWluICE9PSBjYXRSZXN1bHQubnJSZWNvcmRzKSB7XG4gICAgICAgICAgICAgIHJlcyArPSAgYHwgICR7Y2F0UmVzdWx0Lm5yRGlzdGluY3RWYWx1ZXMgLSBjYXRSZXN1bHQubnJEaXN0aW5jdFZhbHVlc0luRG9tYWlufSBvdGhlciB2YWx1ZXMgaW4gJHtjYXRSZXN1bHQubnJSZWNvcmRzIC0gY2F0UmVzdWx0Lm5yUmVjb3Jkc0luRG9tYWlufSBvdGhlciByZWNvcmRzYDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJlcyArPSBgIGA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXMgKz0gYH1cIl1cXG5gO1xuICAgICAgICAqL1xuICAgICAgICAvL2NvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KG0uZnVsbC5kb21haW5bZG9tYWluXSkpO1xuICAgICAgICBpZiAobS5mdWxsLmRvbWFpbltkb21haW5dLmNhdGVnb3JpZXNbY2F0XSkge1xuICAgICAgICAgICAgdmFyIHN5bm9ueW1zU3RyaW5nID0gVXRpbC5saXN0VG9Db21tYUFuZChjYXRkZXNjLmNhdGVnb3J5RGVzYyAmJiBjYXRkZXNjLmNhdGVnb3J5RGVzYy5zeW5vbnltcyAmJiBjYXRkZXNjLmNhdGVnb3J5RGVzYy5zeW5vbnltcyB8fCBbXSkgfHwgXCImbmJzcDtcIjtcbiAgICAgICAgICAgIHJlcyArPSBcIlxcblxcdFxcdFxcdHRyXFxuXFx0XFx0XFx0XFx0XFx0dGQuY2F0X2NvdW50IFwiICsgY2F0ICsgXCJcXG5cXHRcXHRcXHRcXHRcXHR0ZCBcIiArIGNhdGRlc2MucHJlc2VudFJlY29yZHMgKyBcIiBkaXN0aW5jdCB2YWx1ZXMgaW4gXCIgKyBjYXRkZXNjLnBlcmNQcmVzZW50ICsgXCIlIG9mIHJlY29yZHNcXG5cXHRcXHRcXHRcXHRcXHR0ZFxcblxcdFxcdFxcdFxcdFxcdFxcdHRhYmxlXFxuXFx0XFx0XFx0XFx0XFx0XFx0XFx0dHIuY2F0X3N5bm9ueW1zXFxuXFx0XFx0XFx0XFx0XFx0XFx0XFx0XFx0dGQgXCIgKyBzeW5vbnltc1N0cmluZyArIFwiXFxuXFx0XFx0XFx0XFx0XFx0XFx0XFx0dHIuY2F0X2Rlc2NyaXB0aW9uXFxuXFx0XFx0XFx0XFx0XFx0XFx0XFx0XFx0dGQgXCIgKyByZXBsYWNlQnIoY2F0ZGVzYy5jYXRlZ29yeURlc2MgJiYgY2F0ZGVzYy5jYXRlZ29yeURlc2MuZGVzY3JpcHRpb24gfHwgXCJcIikgKyBcIlxcblxcdFxcdFxcdFxcdFxcdFxcdFxcdHRyLmNhdF9zYW1wbGV2YWx1ZXNcXG5cXHRcXHRcXHRcXHRcXHRcXHRcXHRcXHR0ZCBcIiArIHJlcGxhY2VCcihjYXRkZXNjLnNhbXBsZVZhbHVlcykgKyBcIlxcbiAgICAgIFwiO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgdmFyIG90aGVyY2F0cyA9IGNhdHMubGVuZ3RoIC0gT2JqZWN0LmtleXMobS5mdWxsLmRvbWFpbltkb21haW5dLmNhdGVnb3JpZXMpLmxlbmd0aDtcbiAgICB2YXIgcmVtYWluaW5nQ2F0ZWdvcmllcyA9IF8uZGlmZmVyZW5jZShjYXRzLCBPYmplY3Qua2V5cyhtLmZ1bGwuZG9tYWluW2RvbWFpbl0uY2F0ZWdvcmllcykpO1xuICAgIGlmICgob3RoZXJjYXRzKSA+IDApIHtcbiAgICAgICAgcmVzICs9IFwiXFxuXFx0XFx0cCAgIGFuZCBcIiArIG90aGVyY2F0cyArIFwiIG90aGVyIGNhdGVnb3JpZXNcXG5cXHRcXHR8IFwiICsgVXRpbC5saXN0VG9Db21tYUFuZChyZW1haW5pbmdDYXRlZ29yaWVzKSArIFwiXFxuICAgICAgIFwiO1xuICAgIH1cbiAgICAvKlxuICAgICAgLy8gY2FsY3VsYXRlIG90aGVyIGRvbWFpbnMuXG4gICAgICAvLyBkcmF3IFwib3RoZXIgY2F0ZWdvcmllc1wiXG4gICAgICByZXMgKz0gYG5vZGUgW2NvbG9yPXB1cnBsZSwgc3R5bGU9ZmlsbGVkXTsgXFxuYFxuICAgICAgb3RoZXJkb21haW5zLmZvckVhY2goZnVuY3Rpb24ob3RoZXJkb21haW4pIHtcbiAgICAgICAgcmVzICs9IGBcIiR7b3RoZXJkb21haW59XCIgXFxuYDtcbiAgICAgIH0pO1xuICAgICAgLy8gY291bnQgcmVjb3JkcyBpbiBkb21haW4gOlxuICAgICAgdmFyIG5yUmVjb3JkcyA9IG0ucmVjb3Jkcy5yZWR1Y2UoZnVuY3Rpb24ocHJldixlbnRyeSkge1xuICAgICAgcmV0dXJuIHByZXYgKyAoKGVudHJ5Ll9kb21haW4gPT09IGRvbWFpbikgPyAxIDogMCk7XG4gICAgICB9LDApO1xuICAgICAgcmVzICs9IGBub2RlIFtzaGFwZT1yZWNvcmRdOyBcXG5gXG4gICAgICByZXMgKz0gYCBcInJlY29yZFwiIFtsYWJlbD1cIns8ZjA+ICR7ZG9tYWlufSB8ICR7bnJSZWNvcmRzfX1cIl0gXFxuYDtcbiAgXG4gICAgICByZXMgKz0gYCBcInJfb3RoZXJcIiBbbGFiZWw9XCJ7PGYwPiBvdGhlciB8ICR7bnJSZWNvcmRzfX1cIl0gXFxuIGA7XG4gIFxuICAgICAgcmVzICs9IGAjIHJlbGF0aW9uIGZyb20gY2F0ZWdvcmllcyB0byBkb21haW5cXG5gO1xuICAgICAgY2F0cy5mb3JFYWNoKGZ1bmN0aW9uKGNhdCkge1xuICAgICAgICByZXMgKz0gYCBcIiR7Y2F0fVwiIC0+IFwiJHtkb21haW59XCIgXFxuYDtcbiAgICAgIH0pXG4gIFxuICBcbiAgICAgIHJlcyArPSBgIyByZWxhdGlvbiBmcm9tIGNhdGVnb3JpZXMgdG8gcmVjb3Jkc1xcbmA7XG4gICAgICBjYXRzLmZvckVhY2goZnVuY3Rpb24oY2F0KSB7XG4gICAgICAgIHZhciByZWMgPSBjYXRlZ29yeVJlc3VsdHNbY2F0XTtcbiAgICAgICAgcmVzICs9IGAgXCIke2NhdH1cIiAtPiBcInJlY29yZFwiIFxcbmA7XG4gICAgICB9KVxuICBcbiAgXG4gICAgICAvL290aGVyIGRvbWFpbnMgdG8gdGhpc1xuICAgICAgY2F0cy5mb3JFYWNoKGZ1bmN0aW9uKGNhdCkge1xuICBcbiAgXG4gICAgICB9KVxuICAgICovXG4gICAgLypcbiAgICBjYXRzIGZvXG4gICAgICBkaWdyYXBoIHNkc3Uge1xuICAgICAgc2l6ZT1cIjM2LDM2XCI7XG4gICAgICBub2RlIFtjb2xvcj15ZWxsb3csIHN0eWxlPWZpbGxlZF07XG4gICAgICBGTFBEIEZMUCBcIkJPTSBFZGl0b3JcIiwgXCJXSUtJVVJMXCIgXCJVSTUgRG9jdW1lbnRhdGlvblwiLCBcIlVJNSBFeGFtcGxlXCIsIFwiU1RBUlRUQVwiXG4gICAgICBCQ1BcbiAgICAgIG5vZGUgW2NvbG9yPWdyZXksIHN0eWxlPWZpbGxlZF07XG4gICAgICBub2RlIFtmb250bmFtZT1cIlZlcmRhbmFcIiwgc2l6ZT1cIjMwLDMwXCJdO1xuICAgICAgbm9kZSBbY29sb3I9Z3JleSwgc3R5bGU9ZmlsbGVkXTtcbiAgICAgIGdyYXBoIFsgZm9udG5hbWUgPSBcIkFyaWFsXCIsXG4gICAgKi9cbiAgICByZXMgKz0gXCJcXG5cXHRcXHRoMyBWZXJzaW9uXFxuXFx0XFx0XFx0YS5zbWFsbChocmVmPVxcXCIvd2hhdHNuZXdcXFwiKVxcblxcblxcbmJsb2NrIHNjcmlwdHNcXG5cXHRzY3JpcHQoc3JjPScvdmVuZG9yL2pxdWVyeS0yLjIuMy5taW4uanMnKVxcblxcdHNjcmlwdChzcmM9Jy92ZW5kb3IvYm9vdHN0cmFwLm1pbi5qcycpXFxuXFx0c2NyaXB0KHNyYz0nL2pzL3ZpZXdzL3NldHRpbmdzLmpzJylcXG5cIjtcbiAgICByZXR1cm4gcmVzO1xufVxuZXhwb3J0cy50YWJEb21haW4gPSB0YWJEb21haW47XG52YXIgY2hpbGRfcHJvY2Vzc18xID0gcmVxdWlyZShcImNoaWxkX3Byb2Nlc3NcIik7XG5mdW5jdGlvbiBleGVjQ21kKGNtZCkge1xuICAgIGNoaWxkX3Byb2Nlc3NfMS5leGVjKGNtZCwgZnVuY3Rpb24gKGVycm9yLCBzdGRvdXQsIHN0ZGVycikge1xuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJleGVjIGVycm9yOiBcIiArIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZyhcInN0ZG91dDogXCIgKyBzdGRvdXQpO1xuICAgICAgICBjb25zb2xlLmxvZyhcInN0ZGVycjogXCIgKyBzdGRlcnIpO1xuICAgIH0pO1xufVxuO1xuZnVuY3Rpb24gdmlzTW9kZWxzKG0sIGZvbGRlck91dCkge1xuICAgIG0uZG9tYWlucy5mb3JFYWNoKGZ1bmN0aW9uIChzRG9tYWluKSB7XG4gICAgICAgIHZhciBzID0gZ3JhcGhEb21haW4oc0RvbWFpbiwgbSk7XG4gICAgICAgIHZhciBmbkdyYXBoID0gZm9sZGVyT3V0ICsgXCIvXCIgKyBzRG9tYWluLnJlcGxhY2UoLyAvZywgJ18nKSArIFwiLmd2XCI7XG4gICAgICAgIGZzLndyaXRlRmlsZVN5bmMoZm5HcmFwaCwgcyk7XG4gICAgICAgIGlmIChwcm9jZXNzLmVudi5HUkFQSFZJWikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJoZXJlIHRoZSBmaWxlIFwiICsgZm5HcmFwaCk7XG4gICAgICAgICAgICBleGVjQ21kKHByb2Nlc3MuZW52LkdSQVBIVklaICsgXCIgLVRqcGVnIC1PIFwiICsgZm5HcmFwaCk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbmV4cG9ydHMudmlzTW9kZWxzID0gdmlzTW9kZWxzO1xuZnVuY3Rpb24gdGFiTW9kZWxzKG0sIGZvbGRlck91dCkge1xuICAgIG0uZG9tYWlucy5mb3JFYWNoKGZ1bmN0aW9uIChzRG9tYWluKSB7XG4gICAgICAgIHZhciBzID0gdGFiRG9tYWluKHNEb21haW4sIG0pO1xuICAgICAgICB2YXIgZm5HcmFwaCA9IGZvbGRlck91dCArIFwiL1wiICsgc0RvbWFpbi5yZXBsYWNlKC8gL2csICdfJykgKyBcIi5qYWRlXCI7XG4gICAgICAgIGRlYnVnbG9nKFwiaGVyZSB0aGUgZmlsZSBcIiArIGZuR3JhcGgpO1xuICAgICAgICBmcy53cml0ZUZpbGVTeW5jKGZuR3JhcGgsIHMpO1xuICAgIH0pO1xufVxuZXhwb3J0cy50YWJNb2RlbHMgPSB0YWJNb2RlbHM7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
