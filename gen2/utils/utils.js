'use strict';

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

function deepFreeze(o) {
    if ((typeof o === "undefined" ? "undefined" : _typeof(o)) === "object") {
        Object.keys(o).forEach(function (sKey) {
            deepFreeze(o[sKey]);
        });
        Object.freeze(o);
    }
}
exports.deepFreeze = deepFreeze;
function listToQuotedCommaWord(list, quote, word) {
    quote = quote || "";
    if (list.length === 0) {
        return quote + quote;
    }
    var base = list.slice(0, list.length - 1).join(quote + ", " + quote);
    if (base) {
        base = quote + base + quote + ' ' + word + ' ' + quote + list[list.length - 1] + quote;
        return base;
    }
    return quote + list[0] + quote;
}
exports.listToQuotedCommaWord = listToQuotedCommaWord;
function listToCommaAnd(list, quote) {
    return listToQuotedCommaWord(list, quote, 'and');
}
exports.listToCommaAnd = listToCommaAnd;
function listToCommaOr(list, quote) {
    return listToQuotedCommaWord(list, '', 'or');
}
exports.listToCommaOr = listToCommaOr;
function listToQuotedCommaAnd(list) {
    return listToQuotedCommaWord(list, '"', 'and');
}
exports.listToQuotedCommaAnd = listToQuotedCommaAnd;
function listToQuotedCommaOr(list, quote) {
    return listToQuotedCommaWord(list, '"', 'or');
}
exports.listToQuotedCommaOr = listToQuotedCommaOr;
function stripQuotes(str) {
    if (str.length > 2 && str.charAt(0) === '"' && str.charAt(str.length - 1) === '"') {
        return str.substring(1, str.length - 1);
    }
    return str;
}
exports.stripQuotes = stripQuotes;
// courtesy of
// http://stackoverflow.com/questions/4459928/how-to-deep-clone-in-javascript
function cloneDeep(item) {
    if (!item) {
        return item;
    } // null, undefined values check
    var types = [Number, String, Boolean],
        result;
    // normalizing primitives if someone did new String('aaa'), or new Number('444');
    types.forEach(function (type) {
        if (item instanceof type) {
            result = type(item);
        }
    });
    if (typeof result == "undefined") {
        if (Object.prototype.toString.call(item) === "[object Array]") {
            result = [];
            item.forEach(function (child, index, array) {
                result[index] = cloneDeep(child);
            });
        } else if ((typeof item === 'undefined' ? 'undefined' : typeof item === "undefined" ? "undefined" : _typeof(item)) == "object") {
            // testing that this is DOM
            if (!item.prototype) {
                if (item instanceof Date) {
                    result = new Date(item);
                } else {
                    // it is an object literal
                    result = {};
                    for (var i in item) {
                        result[i] = cloneDeep(item[i]);
                    }
                }
            } else {
                // depending what you would like here,
                //   // just keep the reference, or create new object
                //   if (false && item.constructor) {
                // would not advice to do that, reason? Read below
                //        result = new item.constructor();
                //    } else {
                result = item;
            }
        } else {
            result = item;
        }
    }
    return result;
}
exports.cloneDeep = cloneDeep;
exports.ArrayUtils = {
    indexOf: function indexOf(oMember, aArr, fnComp) {
        fnComp = fnComp || function (a, b) {
            return a === b;
        };
        var resIndex = -1;
        aArr.every(function (oMemberArr, index) {
            var u = fnComp(oMemberArr, oMember);
            if (u) {
                resIndex = index;
                return false;
            }
            return true;
        });
        return resIndex;
    },
    presentIn: function presentIn(oMember, aArr, fnComp) {
        return exports.ArrayUtils.indexOf(oMember, aArr, fnComp) >= 0;
    },
    setMinus: function setMinus(aRR1, aRR2, fnComp) {
        fnComp = fnComp || function (a, b) {
            return a === b;
        };
        return aRR1.reduce(function (Result, oMember, index) {
            if (!exports.ArrayUtils.presentIn(oMember, aRR2, fnComp) && !exports.ArrayUtils.presentIn(oMember, Result, fnComp)) {
                Result.push(oMember);
            }
            return Result;
        }, []);
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy91dGlscy91dGlscy50cyJdLCJuYW1lcyI6WyJkZWVwRnJlZXplIiwibyIsIk9iamVjdCIsImtleXMiLCJmb3JFYWNoIiwic0tleSIsImZyZWV6ZSIsImV4cG9ydHMiLCJsaXN0VG9RdW90ZWRDb21tYVdvcmQiLCJsaXN0IiwicXVvdGUiLCJ3b3JkIiwibGVuZ3RoIiwiYmFzZSIsInNsaWNlIiwiam9pbiIsImxpc3RUb0NvbW1hQW5kIiwibGlzdFRvQ29tbWFPciIsImxpc3RUb1F1b3RlZENvbW1hQW5kIiwibGlzdFRvUXVvdGVkQ29tbWFPciIsInN0cmlwUXVvdGVzIiwic3RyIiwiY2hhckF0Iiwic3Vic3RyaW5nIiwiY2xvbmVEZWVwIiwiaXRlbSIsInR5cGVzIiwiTnVtYmVyIiwiU3RyaW5nIiwiQm9vbGVhbiIsInJlc3VsdCIsInR5cGUiLCJwcm90b3R5cGUiLCJ0b1N0cmluZyIsImNhbGwiLCJjaGlsZCIsImluZGV4IiwiYXJyYXkiLCJEYXRlIiwiaSIsIkFycmF5VXRpbHMiLCJpbmRleE9mIiwib01lbWJlciIsImFBcnIiLCJmbkNvbXAiLCJhIiwiYiIsInJlc0luZGV4IiwiZXZlcnkiLCJvTWVtYmVyQXJyIiwidSIsInByZXNlbnRJbiIsInNldE1pbnVzIiwiYVJSMSIsImFSUjIiLCJyZWR1Y2UiLCJSZXN1bHQiLCJwdXNoIl0sIm1hcHBpbmdzIjoiQUFBQTs7OztBQUNBLFNBQUFBLFVBQUEsQ0FBMkJDLENBQTNCLEVBQWtDO0FBQ2hDLFFBQUksUUFBT0EsQ0FBUCx5Q0FBT0EsQ0FBUCxPQUFhLFFBQWpCLEVBQTJCO0FBQ3pCQyxlQUFPQyxJQUFQLENBQVlGLENBQVosRUFBZUcsT0FBZixDQUF1QixVQUFTQyxJQUFULEVBQWE7QUFDbENMLHVCQUFXQyxFQUFFSSxJQUFGLENBQVg7QUFDRCxTQUZEO0FBR0FILGVBQU9JLE1BQVAsQ0FBY0wsQ0FBZDtBQUNEO0FBQ0Y7QUFQRE0sUUFBQVAsVUFBQSxHQUFBQSxVQUFBO0FBVUEsU0FBQVEs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LFVBQVAsRUFBa0JQLE9BQWxCLENBQVI7QUFDQSxnQkFBR1EsQ0FBSCxFQUFNO0FBQ0pILDJCQUFXWCxLQUFYO0FBQ0EsdUJBQU8sS0FBUDtBQUNEO0FBQ0QsbUJBQU8sSUFBUDtBQUNELFNBUEQ7QUFRQSxlQUFPVyxRQUFQO0FBQ0QsS0FkdUI7QUFnQnhCSSxlQUFZLG1CQUFZVCxPQUFaLEVBQXlCQyxJQUF6QixFQUEwQ0MsTUFBMUMsRUFBNkQ7QUFDdkUsZUFBT3JDLFFBQUFpQyxVQUFBLENBQVdDLE9BQVgsQ0FBbUJDLE9BQW5CLEVBQTRCQyxJQUE1QixFQUFrQ0MsTUFBbEMsS0FBNkMsQ0FBcEQ7QUFDRCxLQWxCdUI7QUFxQnhCUSxjQUFXLGtCQUFZQyxJQUFaLEVBQTZCQyxJQUE3QixFQUE4Q1YsTUFBOUMsRUFBaUU7QUFDMUVBLGlCQUFTQSxVQUFVLFVBQVVDLENBQVYsRUFBZUMsQ0FBZixFQUFrQjtBQUFJLG1CQUFPRCxNQUFNQyxDQUFiO0FBQWdCLFNBQXpEO0FBQ0EsZUFBUU8sS0FBS0UsTUFBTCxDQUFZLFVBQVNDLE1BQVQsRUFBaUJkLE9BQWpCLEVBQTBCTixLQUExQixFQUErQjtBQUNqRCxnQkFBSSxDQUFDN0IsUUFBQWlDLFVBQUEsQ0FBV1csU0FBWCxDQUFxQlQsT0FBckIsRUFBOEJZLElBQTlCLEVBQW9DVixNQUFwQyxDQUFELElBQWdELENBQUNyQyxRQUFBaUMsVUFBQSxDQUFXVyxTQUFYLENBQXFCVCxPQUFyQixFQUE4QmMsTUFBOUIsRUFBc0NaLE1BQXRDLENBQXJELEVBQW9HO0FBQ2xHWSx1QkFBT0MsSUFBUCxDQUFZZixPQUFaO0FBQ0Q7QUFDRCxtQkFBT2MsTUFBUDtBQUNELFNBTE8sRUFLTixFQUxNLENBQVI7QUFNRDtBQTdCdUIsQ0FBYiIsImZpbGUiOiJ1dGlscy91dGlscy5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbmV4cG9ydCBmdW5jdGlvbiBkZWVwRnJlZXplKG8gOiBhbnkpIHtcbiAgaWYgKHR5cGVvZiBvID09PSBcIm9iamVjdFwiKSB7XG4gICAgT2JqZWN0LmtleXMobykuZm9yRWFjaChmdW5jdGlvbihzS2V5KSB7XG4gICAgICBkZWVwRnJlZXplKG9bc0tleV0pO1xuICAgIH0pO1xuICAgIE9iamVjdC5mcmVlemUobyk7XG4gIH1cbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gbGlzdFRvUXVvdGVkQ29tbWFXb3JkKGxpc3QgOiBzdHJpbmdbXSwgcXVvdGUgOiBzdHJpbmcsIHdvcmQ6IHN0cmluZykge1xuICAgIHF1b3RlID0gcXVvdGUgfHwgXCJcIjtcbiAgICBpZiggbGlzdC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIHF1b3RlICsgcXVvdGU7XG4gICAgfVxuICAgIHZhciBiYXNlID0gbGlzdC5zbGljZSgwLGxpc3QubGVuZ3RoLTEpLmpvaW4ocXVvdGUgKyBcIiwgXCIgKyBxdW90ZSk7XG4gICAgaWYoYmFzZSkge1xuICAgICAgICBiYXNlID0gcXVvdGUgKyBiYXNlICsgcXVvdGUgKyAnICcgKyB3b3JkICsgJyAnICsgcXVvdGUgKyBsaXN0W2xpc3QubGVuZ3RoLTFdICsgcXVvdGU7XG4gICAgICAgIHJldHVybiBiYXNlO1xuICAgIH1cbiAgICByZXR1cm4gcXVvdGUgKyBsaXN0WzBdICsgcXVvdGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsaXN0VG9Db21tYUFuZChsaXN0IDogc3RyaW5nW10sIHF1b3RlPyA6IHN0cmluZykge1xuICAgIHJldHVybiBsaXN0VG9RdW90ZWRDb21tYVdvcmQobGlzdCxxdW90ZSwgJ2FuZCcpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGxpc3RUb0NvbW1hT3IobGlzdCA6IHN0cmluZ1tdLCBxdW90ZT8gOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gIGxpc3RUb1F1b3RlZENvbW1hV29yZChsaXN0LCcnLCAnb3InKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGxpc3RUb1F1b3RlZENvbW1hQW5kKGxpc3QgOiBzdHJpbmdbXSkge1xuICAgIHJldHVybiBsaXN0VG9RdW90ZWRDb21tYVdvcmQobGlzdCwnXCInLCdhbmQnKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBsaXN0VG9RdW90ZWRDb21tYU9yKGxpc3QgOiBzdHJpbmdbXSwgcXVvdGU/IDogc3RyaW5nKSB7XG4gICAgcmV0dXJuICBsaXN0VG9RdW90ZWRDb21tYVdvcmQobGlzdCwnXCInLCAnb3InKTtcbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gc3RyaXBRdW90ZXMoc3RyIDogc3RyaW5nKSA6IHN0cmluZyB7XG4gICAgaWYoc3RyLmxlbmd0aCA+IDIgJiYgc3RyLmNoYXJBdCgwKSA9PT0gJ1wiJyAmJiBzdHIuY2hhckF0KHN0ci5sZW5ndGggLSAxKSA9PT0gJ1wiJykge1xuICAgICAgICByZXR1cm4gc3RyLnN1YnN0cmluZygxLHN0ci5sZW5ndGgtMSk7XG4gICAgfVxuICAgIHJldHVybiBzdHI7XG59XG5cbi8vIGNvdXJ0ZXN5IG9mXG4vLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzQ0NTk5MjgvaG93LXRvLWRlZXAtY2xvbmUtaW4tamF2YXNjcmlwdFxuZXhwb3J0IGZ1bmN0aW9uIGNsb25lRGVlcChpdGVtIDogYW55KSA6IGFueSAge1xuICAgIGlmICghaXRlbSkge1xuICAgICAgICByZXR1cm4gaXRlbTtcbiAgICB9IC8vIG51bGwsIHVuZGVmaW5lZCB2YWx1ZXMgY2hlY2tcbiAgICB2YXIgdHlwZXMgPSBbTnVtYmVyLCBTdHJpbmcsIEJvb2xlYW5dLFxuICAgICAgICByZXN1bHQ7XG4gICAgLy8gbm9ybWFsaXppbmcgcHJpbWl0aXZlcyBpZiBzb21lb25lIGRpZCBuZXcgU3RyaW5nKCdhYWEnKSwgb3IgbmV3IE51bWJlcignNDQ0Jyk7XG4gICAgdHlwZXMuZm9yRWFjaChmdW5jdGlvbiAodHlwZSkge1xuICAgICAgICBpZiAoaXRlbSBpbnN0YW5jZW9mIHR5cGUpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHR5cGUoaXRlbSk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAodHlwZW9mIHJlc3VsdCA9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaXRlbSkgPT09IFwiW29iamVjdCBBcnJheV1cIikge1xuICAgICAgICAgICAgcmVzdWx0ID0gW107XG4gICAgICAgICAgICBpdGVtLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkLCBpbmRleCwgYXJyYXkpIHtcbiAgICAgICAgICAgICAgICByZXN1bHRbaW5kZXhdID0gY2xvbmVEZWVwKGNoaWxkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKCh0eXBlb2YgaXRlbSA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IHR5cGVvZiBpdGVtKSA9PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICAvLyB0ZXN0aW5nIHRoYXQgdGhpcyBpcyBET01cbiAgICAgICAgICAgIGlmICghaXRlbS5wcm90b3R5cGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXRlbSBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gbmV3IERhdGUoaXRlbSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaXQgaXMgYW4gb2JqZWN0IGxpdGVyYWxcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0ge307XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2ldID0gY2xvbmVEZWVwKGl0ZW1baV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIGRlcGVuZGluZyB3aGF0IHlvdSB3b3VsZCBsaWtlIGhlcmUsXG4gICAgICAgICAgICAgICAgLy8gICAvLyBqdXN0IGtlZXAgdGhlIHJlZmVyZW5jZSwgb3IgY3JlYXRlIG5ldyBvYmplY3RcbiAgICAgICAgICAgICAgICAvLyAgIGlmIChmYWxzZSAmJiBpdGVtLmNvbnN0cnVjdG9yKSB7XG4gICAgICAgICAgICAgICAgLy8gd291bGQgbm90IGFkdmljZSB0byBkbyB0aGF0LCByZWFzb24/IFJlYWQgYmVsb3dcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgcmVzdWx0ID0gbmV3IGl0ZW0uY29uc3RydWN0b3IoKTtcbiAgICAgICAgICAgICAgICAvLyAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IGl0ZW07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXN1bHQgPSBpdGVtO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5cbnR5cGUgZm5hID0gKGEgOiBudW1iZXIsYiA6IG51bWJlcikgPT4gbnVtYmVyO1xuXG50eXBlIGZuQ29tcDxUPiA9IChhIDogVCxiIDogVCkgPT4gYm9vbGVhbjtcblxuXG5leHBvcnQgY29uc3QgQXJyYXlVdGlscyA9IHtcblxuICBpbmRleE9mIDogZnVuY3Rpb248VD4ob01lbWJlciA6IFQsIGFBcnIgOiBBcnJheTxUPiwgZm5Db21wIDogZm5Db21wPFQ+ICkgOiBudW1iZXIge1xuICAgIGZuQ29tcCA9IGZuQ29tcCB8fCBmdW5jdGlvbiAoYTpULCBiOlQpIHsgcmV0dXJuIGEgPT09IGIgfTtcbiAgICB2YXIgcmVzSW5kZXggPSAtMTtcbiAgICBhQXJyLmV2ZXJ5KGZ1bmN0aW9uIChvTWVtYmVyQXJyLCBpbmRleCkge1xuICAgICAgdmFyIHUgPSBmbkNvbXAob01lbWJlckFycixvTWVtYmVyKTtcbiAgICAgIGlmKHUpIHtcbiAgICAgICAgcmVzSW5kZXggPSBpbmRleDtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc0luZGV4O1xuICB9LFxuXG4gIHByZXNlbnRJbiA6IGZ1bmN0aW9uPFQ+KG9NZW1iZXIgOiBULCBhQXJyIDogQXJyYXk8VD4sIGZuQ29tcD8gOiBmbkNvbXA8VD4gKSA6IGJvb2xlYW4ge1xuICAgIHJldHVybiBBcnJheVV0aWxzLmluZGV4T2Yob01lbWJlciwgYUFyciwgZm5Db21wKSA+PSAwO1xuICB9LFxuXG5cbiAgc2V0TWludXMgOiBmdW5jdGlvbjxUPihhUlIxIDogQXJyYXk8VD4sIGFSUjIgOiBBcnJheTxUPiwgZm5Db21wPyA6IGZuQ29tcDxUPikgIHtcbiAgICBmbkNvbXAgPSBmbkNvbXAgfHwgZnVuY3Rpb24gKGE6VCwgYjpUKSB7IHJldHVybiBhID09PSBiIH07XG4gICAgcmV0dXJuICBhUlIxLnJlZHVjZShmdW5jdGlvbihSZXN1bHQsIG9NZW1iZXIsIGluZGV4KSB7XG4gICAgICBpZiAoIUFycmF5VXRpbHMucHJlc2VudEluKG9NZW1iZXIsIGFSUjIsIGZuQ29tcCkgJiYgIUFycmF5VXRpbHMucHJlc2VudEluKG9NZW1iZXIsIFJlc3VsdCwgZm5Db21wKSkge1xuICAgICAgICBSZXN1bHQucHVzaChvTWVtYmVyKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBSZXN1bHQ7XG4gICAgfSxbXSBhcyBBcnJheTxUPik7XG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
