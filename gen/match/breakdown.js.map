{"version":3,"sources":["/projects/nodejs/botbuilder/fdevstart/src/../src/match/breakdown.ts"],"names":[],"mappings":"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","file":"match/breakdown.js","sourcesContent":["/**\r\n * @file\r\n * @module jfseb.fdevstart.breakdown\r\n * @copyright (c) 2016 Gerd Forstmann\r\n */\r\n\r\nimport * as debug from 'debug';\r\nconst debuglog = debug('dispatcher')\r\n\r\n\r\nexport function cleanseString(sString : string) : string {\r\n    var len = 0;\r\n    while ( len !== sString.length )  {\r\n        len = sString.length;\r\n        sString = sString.replace(/\\s\\s+/g, ' ');\r\n        sString = sString.replace(/\\s\\s+/g, ' ');\r\n        sString = sString.replace(/^\\s+/,'');\r\n        sString = sString.replace(/\\s+$/,'');\r\n    }\r\n    return sString\r\n}\r\n\r\n\r\nconst regexpRemoveDouble = new RegExp(/^\\\"(\\\".*\\\")\\\"$/);\r\nconst striptail = new RegExp(/^\\\"([^\\\"]+)\"$/)\r\n\r\nexport function trimQuoted(sString : string) : string {\r\n    var skipUntil = 0;\r\n    var stripped = sString;\r\n    var m = regexpRemoveDouble.exec(sString);\r\n    while(m) {\r\n        stripped = m[1];\r\n        m = regexpRemoveDouble.exec(stripped);\r\n    }\r\n    debuglog(\"stripped \" + stripped);\r\n    m = striptail.exec(stripped);\r\n    if(m) {\r\n        return m[1];\r\n    }\r\n    return sString;\r\n }\r\n\r\n\r\nexport function trimQuotedSpaced(sString : string) : string {\r\n    var skipUntil = 0;\r\n    sString = sString.replace(/^\"\\s+/g, '\"');\r\n    sString = sString.replace(/\\s+\\\"$/g, '\"');\r\n    return sString;\r\n}\r\n\r\n\r\nexport function recombineQuoted(aArr : Array<string>) : Array<string> {\r\n    var skipUntil = 0;\r\n    aArr = aArr.map(function(s, index) {\r\n        if (index < skipUntil) {\r\n            debuglog(\"skipping >\" + s + \"<\");\r\n            return undefined;\r\n        }\r\n        if(/^\"/.exec(s)) {\r\n            var i = index;\r\n            while(i < aArr.length && (!/\"$/.exec(aArr[i]) || (index === i && s === '\"'))) {\r\n              i = i + 1;\r\n            }\r\n            if (i === aArr.length) {\r\n                debuglog(\"Unterminated quoted string\");\r\n                return s;\r\n            } else {\r\n                skipUntil = i + 1;\r\n                var res = aArr.slice(index,i + 1).join(\" \");\r\n            }\r\n            return res;\r\n        }\r\n        return s;\r\n    }).filter(function(s) {\r\n        return s !== undefined;\r\n    }).map(function(s) {\r\n       return trimQuotedSpaced(s);\r\n    })\r\n    return aArr;\r\n}\r\n\r\n/**\r\n *@param {string} sString , e.g. \"a b c\"\r\n *@return {Array<Array<String>>} broken down array, e.g.\r\n *[[\"a b c\"], [\"a\", \"b c\"], [\"a b\", \"c\"], ....[\"a\", \"b\", \"c\"]]\r\n */\r\nexport function breakdownString(sString: string) : Array<Array<String>> {\r\n    var rString = cleanseString(sString);\r\n    var u = rString.split(\" \");\r\n    u = recombineQuoted(u);\r\n    var k = 0;\r\n    if(u.length === 0) {\r\n        return [[]];\r\n    }\r\n    var w = [[u[0]]];\r\n    while(k < u.length - 1) {\r\n        k = k + 1;\r\n        var r1 = w.map(function (entry) {\r\n            debuglog(JSON.stringify(entry));\r\n            var entry = entry.slice(0);\r\n            debuglog(JSON.stringify(entry));\r\n            entry[entry.length -1 ] = entry[entry.length-1 ] + \" \" + u[k];\r\n            return entry;\r\n        });\r\n        var r2 =  w.map(function (entry) {\r\n            debuglog(\"2 >\" + JSON.stringify(entry));\r\n            var entry = entry.slice(0);\r\n            entry.push(u[k]);\r\n            return entry\r\n        });\r\n        debuglog(JSON.stringify(r1));\r\n        debuglog(JSON.stringify(r2));\r\n        w = r1.concat(r2);\r\n    }\r\n    return w.map(function(oMap) { return oMap.map(function(sWord) {\r\n        return trimQuoted(sWord); }); });\r\n}\r\n\r\nimport * as IMatch from './ifmatch'\r\n\r\n"],"sourceRoot":"ABC"}