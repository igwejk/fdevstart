{"version":3,"sources":["/projects/nodejs/botbuilder/fdevstart/src/../src/match/dispatcher.ts"],"names":[],"mappings":"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","file":"match/dispatcher.js","sourcesContent":["/**\r\n * @file\r\n * @module jfseb.fdevstart.dispatcher\r\n * @copyright (c) 2016 Gerd Forstmann\r\n */\r\n\r\n\r\n/// <reference path=\"../../lib/node-4.d.ts\" />\r\n\r\ndeclare interface ObjectConstructor {\r\n    assign(target: any, ...sources: any[]): any;\r\n}\r\n\r\nvar AnyObject = (<any>Object);\r\n\r\nimport * as distance from '../utils/damerauLevenshtein';\r\n\r\nimport * as debug from 'debug';\r\nconst debuglog = debug('dispatcher')\r\n\r\nimport { exec } from 'child_process';\r\n//  var exec = require('child_process').exec\r\n//  var leven = require('../utils/damerauLevenshtein.js').levenshtein\r\n\r\n\r\n  //var leven = require('../utils/damerauLevenshtein.js')\r\nimport * as matchdata from './matchdata';\r\n\r\nconst oUnitTests = matchdata.oUnitTests\r\nconst oWikis = matchdata.oWikis\r\n\r\n  function calcDistance (sText1, sText2) {\r\n    debuglog(\"length2\" + sText1 + \" - \" + sText2)\r\n    var a0 = distance.levenshtein(sText1.substring(0, sText2.length), sText2)\r\n    var a = distance.levenshtein(sText1.toLowerCase(), sText2)\r\n    return a0 * 500 / sText2.length + a\r\n  }\r\n\r\n  function fnFindMatch (sKeyword, oContext, oMap) {\r\n    // return a better context if there is a match\r\n    // sKeyword = sKeyword.toLowerCase();\r\n    oMap.sort(function (oEntry1, oEntry2) {\r\n      var u1 = calcDistance(oEntry1.key.toLowerCase(), sKeyword)\r\n      var u2 = calcDistance(oEntry2.key.toLowerCase(), sKeyword)\r\n      return u1 - u2\r\n    })\r\n    // later: in case of conflicts, ask,\r\n    // now:\r\n    var dist = calcDistance(oMap[0].key.toLowerCase(), sKeyword)\r\n    debuglog('best dist' + dist + ' /  ' + dist * sKeyword.length + ' ' + sKeyword)\r\n    if (dist < 150) {\r\n      var o1 = (<any>Object).assign({}, oContext)\r\n      var o2\r\n      o1.context = (<any>Object).assign({}, o1.context)\r\n      o2 = o1\r\n      o2.context = (<any>Object).assign(o1.context, oMap[0].context)\r\n      return o2\r\n    }\r\n    return null\r\n  }\r\n\r\n  /**\r\n   * a function to match a unit test using levenshtein distances\r\n   * @public\r\n   */\r\n  function fnFindUnitTest (ssystemObjectId, oContext) {\r\n    return fnFindMatch(ssystemObjectId, oContext, oUnitTests)\r\n  }\r\n\r\n  function fnFindWiki (sKeyword, oContext) {\r\n    return fnFindMatch(sKeyword, oContext, oWikis)\r\n  }\r\n\r\n  var aShowEntityActions = [\r\n    {\r\n      context: {\r\n        systemId: 'uv2',\r\n        client: /^\\d{3,3}$/,\r\n        systemtype: 'ABAPFES',\r\n        systemObjectId: 'flp'\r\n      },\r\n      result: {\r\n        type: 'URL',\r\n        pattern: 'https://ldciuv2.wdf.sap.corp:44355/sap/bc/ui5_ui5/ui2/ushell/shells/abap/FioriLaunchpad.html?sap-client={client}'\r\n      }\r\n    },\r\n    {\r\n      context: {\r\n        systemId: 'uv2',\r\n        client: /^\\d{3,3}$/,\r\n        systemtype: 'ABAPFES',\r\n        systemObjectId: 'flpd'\r\n      },\r\n      result: {\r\n        type: 'URL',\r\n        pattern: 'https://ldciuv2.wdf.sap.corp:44355/sap/bc/ui5_ui5/sap/arsrvc_upb_admn/main.html?sap-client={client}'\r\n      }\r\n    },\r\n    {\r\n      context: {\r\n        systemId: 'u1y',\r\n        client: /^\\d{3,3}$/,\r\n        systemtype: 'ABAPFES',\r\n        systemObjectId: 'flp'\r\n      },\r\n      result: {\r\n        type: 'URL',\r\n        pattern: 'https://ldciu1y.wdf.sap.corp:44355/sap/bc/ui5_ui5/ui2/ushell/shells/abap/FioriLaunchpad.html?sap-client={client}'\r\n      }\r\n    },\r\n    {\r\n      context: {\r\n        systemId: 'u1y',\r\n        client: /^\\d{3,3}$/,\r\n        systemtype: 'ABAPFES',\r\n        systemObjectId: 'flpd'\r\n      },\r\n      result: {\r\n        type: 'URL',\r\n        pattern: 'https://ldciu1y.wdf.sap.corp:44355/sap/bc/ui5_ui5/sap/arsrvc_upb_admn/main.html?sap-client={client}'\r\n      }\r\n    },\r\n    {\r\n      context: {\r\n        systemId: 'uv2',\r\n        client: '120',\r\n        systemObjectCategory: 'fiori catalog',\r\n        systemObjectId: /.*/,\r\n        systemtype: 'ABAPFES',\r\n        tool: 'FLPD'\r\n      },\r\n      result: {\r\n        type: 'URL',\r\n        pattern: 'https://ldciuv2.wdf.sap.corp:44355/sap/bc/ui5_ui5/sap/arsrvc_upb_admn/main.html?sap-client={client}#CATALOG:{systemObjectId}'\r\n      }\r\n    },\r\n    {\r\n      context: {\r\n        systemObjectCategory: 'unit',\r\n        systemObjectId: fnFindUnitTest\r\n      },\r\n      result: {\r\n        type: 'URL',\r\n        pattern: 'http://localhost:8080/{path}'\r\n      }\r\n    },\r\n     {\r\n      context: {\r\n        systemObjectCategory: 'unit test',\r\n        systemObjectId: fnFindUnitTest\r\n      },\r\n      result: {\r\n        type: 'URL',\r\n        pattern: 'http://localhost:8080/{path}'\r\n      }\r\n    },\r\n    {\r\n      context: {\r\n        systemObjectCategory: 'wiki',\r\n        systemObjectId: fnFindWiki\r\n      },\r\n      result: {\r\n        type: 'URL',\r\n        pattern: 'https://wiki.wdf.sap.corp/{path}'\r\n      }\r\n    },\r\n    {\r\n      context: {\r\n        systemId: 'JIRA'\r\n      },\r\n      result: {\r\n        type: 'URL',\r\n        pattern: 'https://jira.wdf.sap.corp:8080/TIPCOREUIII'\r\n      }\r\n    }\r\n  ]\r\n\r\n  // if TOOL = JIRA || SystemId = JIRA -> SystemId = JIRA\r\n  //\r\n  //\r\n\r\n  function startBrowser (url) {\r\n    var cmd =\r\n    '\"%ProgramFiles(x86)%\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe\" --incognito -url \"' + url + '\"'\r\n    exec(cmd, function (error, stdout, stderr) {\r\n      if (error) {\r\n        console.error(`exec error: ${error}`)\r\n        return\r\n      }\r\n      debuglog(`stdout: ${stdout}`)\r\n      debuglog(`stderr: ${stderr}`)\r\n    })\r\n  }\r\n\r\n  // startSAPGUI\r\n\r\n  //   N:\\>\"c:\\Program Files (x86)\\SAP\\FrontEnd\\SAPgui\"\\sapshcut.exe  -system=UV2 -client=120 -command=SE38 -type=Transaction -user=AUSER\r\n\r\n  function expandParametersInURL (oMergedContextResult) {\r\n    var ptn = oMergedContextResult.result.pattern\r\n    Object.keys(oMergedContextResult.context).forEach(function (sKey) {\r\n      var regex = new RegExp('{' + sKey + '}', 'g')\r\n      ptn = ptn.replace(regex, oMergedContextResult.context[sKey])\r\n      ptn = ptn.replace(regex, oMergedContextResult.context[sKey])\r\n    })\r\n    return ptn\r\n  }\r\n\r\n  function executeStartup (oMergedContextResult) {\r\n    if (oMergedContextResult.result.type === 'URL') {\r\n      var ptn = expandParametersInURL(oMergedContextResult)\r\n      startBrowser(ptn)\r\n      return ptn\r\n    } else {\r\n      var s = (\"Don't know how to start \" + oMergedContextResult.result.type + '\\n for \"' + oMergedContextResult.query + '\"')\r\n      debuglog(s)\r\n      return s\r\n    }\r\n  }\r\n\r\n  function nrMatches (aObject, oContext) {\r\n    return Object.keys(aObject).reduce(function (prev, key) {\r\n      if (Object.prototype.hasOwnProperty.call(oContext, key)) {\r\n        prev = prev + 1\r\n      }\r\n      return prev\r\n    }, 0)\r\n  }\r\n\r\n  function nrNoMatches (aObject, oContext) {\r\n    var noMatchA = Object.keys(aObject).reduce(function (prev, key) {\r\n      if (!Object.prototype.hasOwnProperty.call(oContext, key)) {\r\n        prev = prev + 1\r\n      }\r\n      return prev\r\n    }, 0)\r\n    var noMatchB = Object.keys(oContext).reduce(function (prev, key) {\r\n      if (!Object.prototype.hasOwnProperty.call(aObject, key)) {\r\n        prev = prev + 1\r\n      }\r\n      return prev\r\n    }, 0)\r\n    return noMatchA + noMatchB\r\n  }\r\n\r\n  function sameOrStar (s1 : string, s2 : string | RegExp | Function , oEntity) {\r\n    return s1 === s2 ||\r\n      (s1 === undefined && s2 === null) ||\r\n      ((s2 instanceof RegExp) && s2.exec(s1) !== null) ||\r\n      ((typeof s2 === 'function' && s1) && s2(s1, oEntity))\r\n  }\r\n\r\n  function sameOrStarEmpty (s1 : string, s2 : string | RegExp | Function, oEntity) {\r\n    if (s1 === undefined && s2 === undefined) {\r\n      return true\r\n    }\r\n    if (s2 === undefined) {\r\n      return true\r\n    }\r\n\r\n    return s1 === s2 ||\r\n      ((s2 instanceof RegExp) && s2.exec(s1) !== null) ||\r\n      ((typeof s2 === 'function' && s1) && s2(s1, oEntity))\r\n  }\r\n\r\n  function filterShowEntityOld (oContext, aShowEntity) {\r\n    var aFiltered\r\n    Object.keys(oContext).forEach(function (sKey) {\r\n      if (oContext[sKey] === null) {\r\n        oContext[sKey] = undefined\r\n      }\r\n    })\r\n    // filter context, amending synonyms\r\n\r\n\r\n    aFiltered = aShowEntity.filter(function (oShowEntity) {\r\n      //       console.log(\"...\")\r\n      //      console.log(oShowEntity.context.tool + \" \" + oContext.tool + \"\\n\")\r\n      //      console.log(oShowEntity.context.client + \" \" + oContext.client +\":\" + sameOrStar(oContext.client,oShowEntity.context.client) + \"\\n\")\r\n      //  console.log(JSON.stringify(oShowEntity.context) + \"\\n\" + JSON.stringify(oContext.client) + \"\\n\")\r\n\r\n      return sameOrStar(oShowEntity.context.systemId, oContext.systemId, oContext) &&\r\n        sameOrStar(oContext.tool, oShowEntity.context.tool, oContext) &&\r\n        sameOrStar(oContext.client, oShowEntity.context.client, oContext) &&\r\n        sameOrStarEmpty(oContext.systemObjectCategory, oShowEntity.context.systemObjectCategory, oContext) &&\r\n        sameOrStarEmpty(oContext.systemObjectId, oShowEntity.context.systemObjectId, oContext)\r\n    //      && oShowEntity.context.tool === oContext.tool\r\n    })\r\n    //  console.log(aFiltered.length)\r\n    // match other context parameters\r\n    aFiltered.sort(function (a, b) {\r\n      var nrMatchesA = nrMatches(a.context, oContext)\r\n      var nrMatchesB = nrMatches(b.context, oContext)\r\n      var nrNoMatchesA = nrNoMatches(a.context, oContext)\r\n      var nrNoMatchesB = nrNoMatches(b.context, oContext)\r\n      //   console.log(JSON.stringify(a.context))\r\n      //   console.log(JSON.stringify(b.context))\r\n      //   console.log(JSON.stringify(oContext))\r\n      var res = -(nrMatchesA - nrMatchesB) * 100 + (nrNoMatchesA - nrNoMatchesB)\r\n      //     console.log(\"diff \" + res)\r\n      return res\r\n    })\r\n    if (aFiltered.length === 0) {\r\n      debuglog('no target for showEntity ' + JSON.stringify(oContext))\r\n    }\r\n    // console.log(JSON.stringify(aFiltered,undefined,2))\r\n    if (aFiltered[0]) {\r\n      // execute all functions\r\n\r\n      var oMatch = aFiltered[0]\r\n\r\n      var oMerged = {\r\n        context: {\r\n\r\n        }\r\n      }\r\n      oMerged.context = AnyObject.assign({}, oMerged.context, aFiltered[0].context, oContext)\r\n      oMerged = AnyObject.assign(oMerged, {\r\n        result: aFiltered[0].result\r\n      })\r\n\r\n      Object.keys(oMatch.context).forEach(function (sKey) {\r\n        if (typeof oMatch.context[sKey] === 'function') {\r\n          debuglog('Now retrofitting :' + sKey + ' - ' + oContext[sKey])\r\n          oMerged = oMatch.context[sKey](oContext[sKey], oMerged)\r\n        }\r\n      })\r\n\r\n      return oMerged\r\n    }\r\n    return null\r\n  }\r\n\r\n\r\nimport * as inputFilter from './inputFilter';\r\n\r\n  function filterShowEntity (oContext, aShowEntityActions) {\r\n    Object.keys(oContext).forEach(function (sKey) {\r\n      if (oContext[sKey] === null) {\r\n        delete oContext[sKey]\r\n      }\r\n    })\r\n    var res = inputFilter.applyRulesPickFirst(oContext);\r\n    if (!res) {\r\n      return undefined\r\n    }\r\n    debuglog(\"** after filter rules\" + JSON.stringify(res, undefined, 2))\r\n    return filterShowEntityOld(res,aShowEntityActions);\r\n  }\r\n\r\n  function execShowEntity (oEntity) {\r\n    var merged = filterShowEntity(oEntity, aShowEntityActions)\r\n    if (merged) {\r\n      return executeStartup(merged)\r\n    }\r\n    return null\r\n  }\r\n\r\n  // E:\\projects\\nodejs\\botbuilder\\samplebot>\"%ProgramFiles(x86)%\\Google\\Chrome\\Application\\chrome.exe\" --incognito -url www.spiegel.de\r\n\r\n  export const dispatcher = {\r\n    execShowEntity: execShowEntity,\r\n    _test: {\r\n      sameOrStar: sameOrStar,\r\n      nrMatches: nrMatches,\r\n      nrNoMatches: nrNoMatches,\r\n      expandParametersInURL: expandParametersInURL,\r\n      filterShowEntity: filterShowEntity,\r\n      fnFindUnitTest: fnFindUnitTest,\r\n      calcDistance: calcDistance,\r\n      _aShowEntityActions: aShowEntityActions\r\n    }\r\n  }\r\n\r\n  //exports dispatcher;\r\n\r\n  //module.exports = dispatcher\r\n\r\n"],"sourceRoot":"ABC"}