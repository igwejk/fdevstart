{"version":3,"sources":["/projects/nodejs/botbuilder/fdevstart/src/../src/match/whatis.ts"],"names":[],"mappings":"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","file":"match/whatis.js","sourcesContent":["/**\n *\n * @module jfseb.fdevstart.analyze\n * @file analyze.ts\n * @copyright (c) 2016 Gerd Forstmann\n */\n\n\nimport * as InputFilter from './inputFilter';\n\nimport * as debug from 'debug';\n\nconst debuglog = debug('whatis');\nconst debuglogV = debug('whatVis');\nconst perflog = debug('perf');\n\nimport * as utils from '../utils/utils';\n\nimport * as IMatch from './ifmatch';\n\nimport * as Toolmatcher from './toolmatcher';\n\nimport * as Sentence from './sentence';\n\nimport * as Word from './word';\n\nimport * as Algol from './algol';\n\n\nexport function cmpByResultThenRanking(a: IMatch.IWhatIsAnswer, b: IMatch.IWhatIsAnswer) {\n  var cmp = a.result.localeCompare(b.result);\n  if (cmp) {\n    return cmp;\n  }\n  return -(a._ranking - b._ranking);\n}\n\nfunction localeCompareArrs(aaresult : string[], bbresult: string[]) : number {\nvar cmp = 0;\n var blen = bbresult.length;\n  aaresult.every(function(a,index) {\n    if(blen <= index) {\n      cmp = -1;\n      return false;\n    }\n    cmp = a.localeCompare(bbresult[index]);\n    if(cmp) {\n      return false;\n    }\n    return true;\n  });\n  if(cmp) {\n    return cmp;\n  }\n  if(blen > aaresult.length) {\n    cmp = +1;\n  }\n  return 0;\n}\n\nexport function cmpByResultThenRankingTupel(aa: IMatch.IWhatIsTupelAnswer, bb: IMatch.IWhatIsTupelAnswer) {\n  var cmp = localeCompareArrs(aa.result,bb.result);\n  if(cmp) {\n    return cmp;\n  }\n  return -(aa._ranking - bb._ranking);\n}\n\n\n\nexport function cmpByRanking(a: IMatch.IWhatIsAnswer, b: IMatch.IWhatIsAnswer) {\n  var cmp = -(a._ranking - b._ranking);\n  if (cmp) {\n    return cmp;\n  }\n  cmp = a.result.localeCompare(b.result);\n  if (cmp) {\n    return cmp;\n  }\n\n  // are records different?\n  var keys = Object.keys(a.record).concat(Object.keys(b.record)).sort();\n  var res = keys.reduce(function (prev, sKey) {\n    if (prev) {\n      return prev;\n    }\n    if (b.record[sKey] !== a.record[sKey]) {\n      if (!b.record[sKey]) {\n        return -1;\n      }\n      if (!a.record[sKey]) {\n        return +1;\n      }\n      return a.record[sKey].localeCompare(b.record[sKey]);\n    }\n    return 0;\n  }, 0);\n  return res;\n}\n\n\n\nexport function cmpByRankingTupel(a: IMatch.IWhatIsTupelAnswer, b: IMatch.IWhatIsTupelAnswer) {\n  var cmp = -(a._ranking - b._ranking);\n  if (cmp) {\n    return cmp;\n  }\n  cmp = localeCompareArrs(a.result,b.result);\n  if (cmp) {\n    return cmp;\n  }\n  // are records different?\n  var keys = Object.keys(a.record).concat(Object.keys(b.record)).sort();\n  var res = keys.reduce(function (prev, sKey) {\n    if (prev) {\n      return prev;\n    }\n    if (b.record[sKey] !== a.record[sKey]) {\n      if (!b.record[sKey]) {\n        return -1;\n      }\n      if (!a.record[sKey]) {\n        return +1;\n      }\n      return a.record[sKey].localeCompare(b.record[sKey]);\n    }\n    return 0;\n  }, 0);\n  return res;\n}\n\n\n\nexport function dumpNice(answer: IMatch.IWhatIsAnswer) {\n  var result = {\n    s: \"\",\n    push: function (s) { this.s = this.s + s; }\n  };\n  var s =\n    `**Result for category: ${answer.category} is ${answer.result}\n rank: ${answer._ranking}\n`;\n  result.push(s);\n  Object.keys(answer.record).forEach(function (sRequires, index) {\n    if (sRequires.charAt(0) !== '_') {\n      result.push(`record: ${sRequires} -> ${answer.record[sRequires]}`);\n    }\n    result.push('\\n');\n  });\n  var oSentence = answer.sentence;\n  oSentence.forEach(function (oWord, index) {\n    var sWord = `[${index}] : ${oWord.category} \"${oWord.string}\" => \"${oWord.matchedString}\"`\n    result.push(sWord + \"\\n\");\n  })\n  result.push(\".\\n\");\n  return result.s;\n}\nexport function dumpNiceTupel(answer: IMatch.IWhatIsTupelAnswer) {\n  var result = {\n    s: \"\",\n    push: function (s) { this.s = this.s + s; }\n  };\n  var s =\n    `**Result for categories: ${answer.categories.join(\";\")} is ${answer.result}\n rank: ${answer._ranking}\n`;\n  result.push(s);\n  Object.keys(answer.record).forEach(function (sRequires, index) {\n    if (sRequires.charAt(0) !== '_') {\n      result.push(`record: ${sRequires} -> ${answer.record[sRequires]}`);\n    }\n    result.push('\\n');\n  });\n  var oSentence = answer.sentence;\n  oSentence.forEach(function (oWord, index) {\n    var sWord = `[${index}] : ${oWord.category} \"${oWord.string}\" => \"${oWord.matchedString}\"`\n    result.push(sWord + \"\\n\");\n  })\n  result.push(\".\\n\");\n  return result.s;\n}\n\n\nexport function dumpWeightsTop(toolmatches: Array<IMatch.IWhatIsAnswer>, options: any) {\n  var s = '';\n  toolmatches.forEach(function (oMatch, index) {\n    if (index < options.top) {\n      s = s + \"WhatIsAnswer[\" + index + \"]...\\n\";\n      s = s + dumpNice(oMatch);\n    }\n  });\n  return s;\n}\n\nexport function filterRetainTopRankedResult(res: Array<IMatch.IWhatIsAnswer>): Array<IMatch.IWhatIsAnswer> {\n  var result = res.filter(function (iRes, index) {\n    if(debuglog.enabled) {\n      debuglog('retain topRanked: ' + index + ' ' + JSON.stringify(iRes));\n    }\n    if (iRes.result === (res[index - 1] && res[index - 1].result)) {\n      debuglog('skip');\n      return false;\n    }\n    return true;\n  });\n  result.sort(cmpByRanking);\n  return result;\n}\n\nexport function filterRetainTopRankedResultTupel(res: Array<IMatch.IWhatIsTupelAnswer>): Array<IMatch.IWhatIsTupelAnswer> {\n  var result = res.filter(function (iRes, index) {\n    if(debuglog.enabled) {\n      debuglog(' retain tupel ' + index + ' ' + JSON.stringify(iRes));\n    }\n    if (iRes.result === (res[index - 1] && res[index - 1].result)) {\n      debuglog('skip');\n      return false;\n    }\n    return true;\n  });\n  result.sort(cmpByRankingTupel);\n  return result;\n}\n\n\nimport * as Match from './match';\n\nexport function calcRanking(matched: { [key: string]: IMatch.IWord },\n  mismatched: { [key: string]: IMatch.IWord }, relevantCount: number): number {\n\n  var lenMatched = Object.keys(matched).length;\n  var factor = Match.calcRankingProduct(matched);\n  factor *= Math.pow(1.5, lenMatched);\n\n  var lenMisMatched = Object.keys(mismatched).length;\n  var factor2 = Match.calcRankingProduct(mismatched);\n  factor2 *= Math.pow(0.4, lenMisMatched);\n\n  return Math.pow(factor2 * factor, 1 / (lenMisMatched + lenMatched));\n}\n\nexport function calcRankingSimple(matched: number,\n  mismatched: number, nouse : number,\n  relevantCount: number): number {\n    // 2 : 0\n    // 1 : 0\n  var factor = matched * Math.pow(1.5, matched) * Math.pow(1.5, matched);\n  var factor2 = Math.pow(0.4, mismatched);\n  var factor3 = Math.pow(0.4, nouse);\n  return Math.pow(factor2 * factor * factor3, 1 / (mismatched + matched + nouse));\n}\n\nexport function calcRankingHavingCategory(matched: { [key: string]: IMatch.IWord },\n  hasCategory: { [key: string]: number },\n  mismatched: { [key: string]: IMatch.IWord }, relevantCount: number): number {\n\n\n  var lenMatched = Object.keys(matched).length;\n  var factor = Match.calcRankingProduct(matched);\n  factor *= Math.pow(1.5, lenMatched);\n\n  var lenHasCategory = Object.keys(hasCategory).length;\n  var factorH = Math.pow(1.1, lenHasCategory);\n\n  var lenMisMatched = Object.keys(mismatched).length;\n  var factor2 = Match.calcRankingProduct(mismatched);\n  factor2 *= Math.pow(0.4, lenMisMatched);\n\n  return Math.pow(factor2 * factorH * factor, 1 / (lenMisMatched + lenHasCategory + lenMatched));\n}\n\n/**\n * list all top level rankings\n */\nexport function matchRecordsHavingContext(\n  aSentences: Array<IMatch.ISentence>, category: string, records: Array<IMatch.IRecord>,\n  categorySet : {[key : string] : boolean })\n  : Array<IMatch.IWhatIsAnswer> {\n\n  //debuglog(JSON.stringify(records, undefined, 2));\n  var relevantRecords = records.filter(function (record: IMatch.IRecord) {\n    return (record[category] !== undefined) && (record[category] !== null);\n  });\n  var res = [];\n  debuglog(\"MatchRecordsHavingContext : relevant records nr:\" + relevantRecords.length);\n  debuglog(debuglog.enabled ? (\"sentences are : \" + JSON.stringify(aSentences, undefined, 2)) : \"-\");\n  debuglog(debuglog.enabled ? (\"category \"+ category + \" and categoryset is: \" + JSON.stringify(categorySet, undefined, 2)) : \"-\");\n  if (process.env.ABOT_FAST && categorySet) {\n    // we are only interested in categories present in records for domains which contain the category\n    // var categoryset = Model.calculateRelevantRecordCategories(theModel,category);\n    //knowing the target\n    perflog(\"got categoryset with \" + Object.keys(categorySet).length);\n    var fl = 0;\n    var lf = 0;\n    var aSimplifiedSentences = aSentences.map(function (oSentence) {\n      var fWords = oSentence.filter(function(oWord) {\n        return !Word.Word.isFiller(oWord);\n      });\n      var rWords = oSentence.filter(function (oWord) {\n          return  !!categorySet[oWord.category] || Word.Word.isCategory(oWord);\n        });\n        fl = fl + oSentence.length;\n        lf = lf + rWords.length;\n        return {\n          oSentence: oSentence,\n          cntRelevantWords: rWords.length, // not a filler  // to be compatible it would be fWords\n          rWords: rWords\n        };\n    });\n    Object.freeze(aSimplifiedSentences);\n    debuglog(\"post simplify (r=\" + relevantRecords.length + \" s=\" + aSentences.length + \" fl \" + fl + \"->\" + lf + \")\");\n    perflog(\"post simplify (r=\" + relevantRecords.length + \" s=\" + aSentences.length + \" fl \" + fl + \"->\" + lf + \")\");\n    relevantRecords.forEach(function (record) {\n      // count matches in record which are *not* the category\n      aSimplifiedSentences.forEach(function (aSentence) {\n        var hasCategory = {};\n        var mismatched = {};\n        var matched = {};\n        var cntRelevantWords = aSentence.cntRelevantWords;\n        aSentence.rWords.forEach(function (oWord) {\n            if (oWord.category && (record[oWord.category] !== undefined)) {\n              if (oWord.matchedString === record[oWord.category]) {\n                matched[oWord.category] = oWord;\n              }\n              else {\n                mismatched[oWord.category] = oWord;\n              }\n            }\n            else if (Word.Word.isCategory(oWord) && record[oWord.matchedString]) {\n              hasCategory[oWord.matchedString] = 1;\n            }\n          }\n        );\n        if ((Object.keys(matched).length + Object.keys(hasCategory).length) > Object.keys(mismatched).length) {\n          res.push({\n            sentence: aSentence.oSentence,\n            record: record,\n            category: category,\n            result: record[category],\n            _ranking: calcRankingHavingCategory(matched, hasCategory, mismatched, cntRelevantWords)\n          });\n        }\n      })\n    });\n    debuglog(\"here in weird\");\n  } else {\n    relevantRecords.forEach(function (record) {\n      // count matches in record which are *not* the category\n      aSentences.forEach(function (aSentence) {\n        var hasCategory = {};\n        var mismatched = {};\n        var matched = {};\n        var cntRelevantWords = 0;\n        aSentence.forEach(function (oWord) {\n          if (!Word.Word.isFiller(oWord)) {\n            cntRelevantWords = cntRelevantWords + 1;\n            if (oWord.category && (record[oWord.category] !== undefined)) {\n              if (oWord.matchedString === record[oWord.category]) {\n                matched[oWord.category] = oWord;\n              }\n              else {\n                mismatched[oWord.category] = oWord;\n              }\n            }\n            else if (Word.Word.isCategory(oWord) && record[oWord.matchedString]) {\n              hasCategory[oWord.matchedString] = 1;\n            }\n          }\n        });\n        if ((Object.keys(matched).length + Object.keys(hasCategory).length) > Object.keys(mismatched).length) {\n          res.push({\n            sentence: aSentence,\n            record: record,\n            category: category,\n            result: record[category],\n            _ranking: calcRankingHavingCategory(matched, hasCategory, mismatched, cntRelevantWords)\n          });\n        }\n      })\n    });\n  }\n  res.sort(cmpByResultThenRanking);\n  debuglog(\" after sort\" + res.length);\n  res = filterRetainTopRankedResult(res);\n  return res;\n}\n\n\n/**\n * list all top level rankings\n */\nexport function matchRecordsTupelHavingContext(\n  aSentences: Array<IMatch.ISentence>, categories: string[], records: Array<IMatch.IRecord>,\n  categorySet : {[key : string] : boolean })\n  : Array<IMatch.IWhatIsTupelAnswer> {\n  // debuglog(JSON.stringify(records, undefined, 2));\n  var categoryF = categories[0];\n  var relevantRecords = records.filter(function (record: IMatch.IRecord) {\n    return (record[categoryF] !== undefined) && (record[categoryF] !== null);\n  });\n  var res = [] as IMatch.IWhatIsTupelAnswer[];\n  debuglog(\"relevant records nr:\" + relevantRecords.length);\n  debuglog(debuglog.enabled ? (\"sentences are : \" + JSON.stringify(aSentences, undefined, 2)) : \"-\");\n  if (process.env.ABOT_FAST && categorySet) {\n    // we are only interested in categories present in records for domains which contain the category\n    // var categoryset = Model.calculateRelevantRecordCategories(theModel,category);\n    //knowing the target\n    perflog(\"got categoryset with \" + Object.keys(categorySet).length);\n    var fl = 0;\n    var lf = 0;\n    var aSimplifiedSentences = aSentences.map(function (oSentence) {\n      var fWords = oSentence.filter(function(oWord) {\n        return !Word.Word.isFiller(oWord);\n      });\n      var rWords = oSentence.filter(function (oWord) {\n          return  !!categorySet[oWord.category] || Word.Word.isCategory(oWord);\n        });\n        fl = fl + oSentence.length;\n        lf = lf + rWords.length;\n        return {\n          oSentence: oSentence,\n          cntRelevantWords: rWords.length, // not a filler  // to be compatible it would be fWords\n          rWords: rWords\n        };\n    });\n    Object.freeze(aSimplifiedSentences);\n    perflog(\"post simplify (r=\" + relevantRecords.length + \" s=\" + aSentences.length + \" fl \" + fl + \"->\" + lf + \")\");\n    relevantRecords.forEach(function (record) {\n      // count matches in record which are *not* the category\n      aSimplifiedSentences.forEach(function (aSentence) {\n        var hasCategory = {};\n        var mismatched = {};\n        var matched = {};\n        var cntRelevantWords = aSentence.cntRelevantWords;\n        aSentence.rWords.forEach(function (oWord) {\n            if (oWord.category && (record[oWord.category] !== undefined)) {\n              if (oWord.matchedString === record[oWord.category]) {\n                matched[oWord.category] = oWord;\n              }\n              else {\n                mismatched[oWord.category] = oWord;\n              }\n            }\n            else if (Word.Word.isCategory(oWord) && record[oWord.matchedString]) {\n              hasCategory[oWord.matchedString] = 1;\n            }\n          }\n        );\n        if ((Object.keys(matched).length + Object.keys(hasCategory).length) > Object.keys(mismatched).length) {\n          res.push({\n            sentence: aSentence.oSentence,\n            record: record,\n            categories : categories,\n            result: extractResult(categories,record),\n             _ranking: calcRankingHavingCategory(matched, hasCategory, mismatched, cntRelevantWords)\n          });\n        }\n      })\n    });\n  } else {\n    relevantRecords.forEach(function (record) {\n      // count matches in record which are *not* the category\n      aSentences.forEach(function (aSentence) {\n        var hasCategory = {};\n        var mismatched = {};\n        var matched = {};\n        var cntRelevantWords = 0;\n        aSentence.forEach(function (oWord) {\n          if (!Word.Word.isFiller(oWord)) {\n            cntRelevantWords = cntRelevantWords + 1;\n            if (oWord.category && (record[oWord.category] !== undefined)) {\n              if (oWord.matchedString === record[oWord.category]) {\n                matched[oWord.category] = oWord;\n              }\n              else {\n                mismatched[oWord.category] = oWord;\n              }\n            }\n            else if (Word.Word.isCategory(oWord) && record[oWord.matchedString]) {\n              hasCategory[oWord.matchedString] = 1;\n            }\n          }\n        });\n        if ((Object.keys(matched).length + Object.keys(hasCategory).length) > Object.keys(mismatched).length) {\n          res.push({\n            sentence: aSentence,\n            record: record,\n            categories: categories,\n            result: extractResult(categories,record),\n            _ranking: calcRankingHavingCategory(matched, hasCategory, mismatched, cntRelevantWords)\n          });\n        }\n      })\n    });\n  }\n  res.sort(cmpByResultThenRankingTupel);\n  res = filterRetainTopRankedResultTupel(res);\n  return res;\n}\n\nexport function matchRecords(aSentences: Array<IMatch.ISentence>, category: string, records: Array<IMatch.IRecord>)\n  : Array<IMatch.IWhatIsAnswer> {\n // if (debuglog.enabled) {\n //   debuglog(JSON.stringify(records, undefined, 2));\n // }\n  var relevantRecords = records.filter(function (record: IMatch.IRecord) {\n    return (record[category] !== undefined) && (record[category] !== null);\n  });\n  var res = [];\n  debuglog(\"relevant records nr:\" + relevantRecords.length);\n  relevantRecords.forEach(function (record) {\n    aSentences.forEach(function (aSentence) {\n      // count matches in record which are *not* the category\n      var mismatched = {}\n      var matched = {};\n      var cntRelevantWords = 0;\n      aSentence.forEach(function (oWord) {\n        if (!Word.Word.isFiller(oWord)) {\n          cntRelevantWords = cntRelevantWords + 1;\n          if (oWord.category && (record[oWord.category] !== undefined)) {\n            if (oWord.matchedString === record[oWord.category]) {\n              matched[oWord.category] = oWord;\n            } else {\n              mismatched[oWord.category] = oWord;\n            }\n          }\n        }\n      });\n      if (Object.keys(matched).length > Object.keys(mismatched).length) {\n        res.push({\n          sentence: aSentence,\n          record: record,\n          category: category,\n          result: record[category],\n          _ranking: calcRanking(matched, mismatched, cntRelevantWords)\n        });\n      }\n    })\n  });\n  res.sort(cmpByResultThenRanking);\n  res = filterRetainTopRankedResult(res);\n  return res;\n}\n\nexport function matchRecordsQuick(aSentences: Array<IMatch.ISentence>, category: string, records: Array<IMatch.IRecord>, categorySet? : { [key : string] : boolean} )\n  : Array<IMatch.IWhatIsAnswer> {\n  //if (debuglog.enabled) {\n  //  debuglog(JSON.stringify(records, undefined, 2));\n  //}\n  Object.freeze(categorySet);\n  perflog(\"matchRecordsQuick ...(r=\" + records.length + \" s=\" + aSentences.length + \")\");\n  var relevantRecords = records.filter(function (record: IMatch.IRecord) {\n    return (record[category] !== undefined) && (record[category] !== null);\n  });\n  var res = [];\n  debuglog(\"matchRecordsQuick: relevant records (r=\" + relevantRecords.length + \") sentences \" + aSentences.length);\n  perflog(\"relevant records nr:\" + relevantRecords.length + \" sentences \" + aSentences.length);\n  if(process.env.ABOT_FAST && categorySet) {\n    // we are only interested in categories present in records for domains which contain the category\n    // var categoryset = Model.calculateRelevantRecordCategories(theModel,category);\n    //knowing the target\n    perflog(\"got categoryset with \" + Object.keys(categorySet).length);\n    var fl = 0;\n      var lf = 0;\n      var aSimplifiedSentences = aSentences.map(function (oSentence) {\n        var rWords = oSentence.filter(function (oWord) {\n          return !!categorySet[oWord.category];\n        });\n        fl = fl + oSentence.length;\n        lf = lf + rWords.length;\n        return {\n          oSentence: oSentence,\n          cntRelevantWords: rWords.length,\n          rWords: rWords\n        };\n      });\n      perflog(\"post simplify (r=\" + relevantRecords.length + \" s=\" + aSentences.length + \" fl \" + fl + \"->\" + lf + \")\");\n  } else {\n    var fl = 0;\n    var lf = 0;\n    var aSimplifiedSentences = aSentences.map(function (oSentence) {\n      var rWords = oSentence.filter(function (oWord) {\n        return !Word.Word.isFiller(oWord);\n      });\n      fl = fl + oSentence.length;\n      lf = lf + rWords.length;\n      return {\n        oSentence: oSentence,\n        cntRelevantWords: rWords.length,\n        rWords: rWords\n      };\n    });\n    perflog(\"post simplify (r=\" + relevantRecords.length + \" s=\" + aSentences.length + \" fl \" + fl + \"->\" + lf + \")\");\n  }\n\n  relevantRecords.forEach(function (record) {\n    aSimplifiedSentences.forEach(function (aSentence) {\n      // count matches in record which are *not* the category\n      var mismatched = 0;\n      var matched = 0;\n      var nouse = 0;\n      var missingcat = 0;\n      aSentence.rWords.forEach(function (oWord) {\n        if (record[oWord.category] !== undefined) {\n          if (oWord.matchedString === record[oWord.category]) {\n            ++matched;\n          } else {\n            ++mismatched;\n          }\n        } else {\n          if(oWord.category !== \"category\") {\n            nouse += 1;\n          } else  {\n            if(!record[oWord.matchedString]) {\n              missingcat += 1;\n            }\n          }\n        }\n      });\n     // if(matched > 0 || mismatched > 0 ) {\n     //   console.log(\" m\" + matched + \" mismatched\" + mismatched);\n     // }\n      //console.log(JSON.stringify(aSentence.oSentence));\n      if (matched > mismatched) {\n        res.push({\n          sentence: aSentence.oSentence,\n          record: record,\n          category: category,\n          result: record[category],\n          _ranking: calcRankingSimple(matched, mismatched, (nouse + missingcat), aSentence.cntRelevantWords)\n        });\n      }\n    })\n  });\n  perflog(\"sort (a=\" + res.length + \")\");\n  res.sort(cmpByResultThenRanking);\n  perflog(\"filterRetain ...\");\n  res = filterRetainTopRankedResult(res);\n\n  debuglog(\"matchRecordsQuick done: (r=\" + relevantRecords.length + \" s=\" + aSentences.length + \" a=\" + res.length + \")\");\n  perflog(\"matchRecordsQuick done: (r=\" + relevantRecords.length + \" s=\" + aSentences.length + \" a=\" + res.length + \")\");\n  return res;\n}\n\nfunction extractResult(categories : string[], record: { [key : string] : string} ) : string[] {\n  return  categories.map(function(category) { return record[category] || \"n/a\"; });\n}\n\nexport function matchRecordsQuickMultipleCategories(aSentences: Array<IMatch.ISentence>, categories: string[], records: Array<IMatch.IRecord>, categorySet? : { [key : string] : boolean} )\n  : Array<IMatch.IWhatIsTupelAnswer> {\n  // if (debuglog.enabled) {\n  //  debuglog(JSON.stringify(records, undefined, 2));\n  // }\n  Object.freeze(categorySet);\n  var categoryF = categories[0];\n  debuglog(\"matchRecordsQuickMultipleCategories (r=\" + records.length + \" s=\" + aSentences.length + \")\\n categories:\" + categories.join(\"\\n\"));\n  perflog(\"matchRecordsQuickMult ...(r=\" + records.length + \" s=\" + aSentences.length + \")\");\n  var relevantRecords = records.filter(function (record: IMatch.IRecord) {\n    return (record[categoryF] !== undefined) && (record[categoryF] !== null);\n  });\n  var res = [] as Array<IMatch.IWhatIsTupelAnswer>;\n  debuglog(\"relevant records with first (r=\" + relevantRecords.length + \")\");\n  perflog(\"relevant records with first nr:\" + relevantRecords.length + \" sentences \" + aSentences.length);\n  if(process.env.ABOT_FAST && categorySet) {\n    // we are only interested in categories present in records for domains which contain the category\n    // var categoryset = Model.calculateRelevantRecordCategories(theModel,category);\n    //knowing the target\n    perflog(\"got categoryset with \" + Object.keys(categorySet).length);\n    var fl = 0;\n      var lf = 0;\n      var aSimplifiedSentences = aSentences.map(function (oSentence) {\n        var rWords = oSentence.filter(function (oWord) {\n          return !!categorySet[oWord.category];\n        });\n        fl = fl + oSentence.length;\n        lf = lf + rWords.length;\n        return {\n          oSentence: oSentence,\n          cntRelevantWords: rWords.length,\n          rWords: rWords\n        };\n      });\n      perflog(\"post simplify (r=\" + relevantRecords.length + \" s=\" + aSentences.length + \" fl \" + fl + \"->\" + lf + \")\");\n  } else {\n    debuglog(\"not abot_fast !\");\n    var fl = 0;\n    var lf = 0;\n    var aSimplifiedSentences = aSentences.map(function (oSentence) {\n      var rWords = oSentence.filter(function (oWord) {\n        return !Word.Word.isFiller(oWord);\n      });\n      fl = fl + oSentence.length;\n      lf = lf + rWords.length;\n      return {\n        oSentence: oSentence,\n        cntRelevantWords: rWords.length,\n        rWords: rWords\n      };\n    });\n    debuglog(\"post simplify (r=\" + relevantRecords.length + \" s=\" + aSentences.length + \" fl \" + fl + \"->\" + lf + \")\");\n    perflog(\"post simplify (r=\" + relevantRecords.length + \" s=\" + aSentences.length + \" fl \" + fl + \"->\" + lf + \")\");\n  }\n\n  relevantRecords.forEach(function (record) {\n    aSimplifiedSentences.forEach(function (aSentence) {\n      // count matches in record which are *not* the category\n      var mismatched = 0;\n      var matched = 0;\n      var nouse = 0;\n      var missingcat = 0;\n      aSentence.rWords.forEach(function (oWord) {\n        if (record[oWord.category] !== undefined) {\n          if (oWord.matchedString === record[oWord.category]) {\n            ++matched;\n          } else {\n            ++mismatched;\n          }\n        } else {\n          if(oWord.category !== \"category\") {\n            nouse += 1;\n          } else  {\n            if(!record[oWord.matchedString]) {\n              missingcat += 1;\n            }\n          }\n        }\n      });\n     // if(matched > 0 || mismatched > 0 ) {\n     //   console.log(\" m\" + matched + \" mismatched\" + mismatched);\n     // }\n      //console.log(JSON.stringify(aSentence.oSentence));\n      if (matched > mismatched) {\n        var rec = {\n          sentence: aSentence.oSentence,\n          record: record,\n          categories: categories,\n          result: extractResult(categories, record),\n          _ranking: calcRankingSimple(matched, mismatched, (nouse + missingcat), aSentence.cntRelevantWords)\n        }\n     /*   if(record[\"appId\"] ===\"F1566\") {\n          console.log(\"here F1566\" + JSON.stringify(rec));\n          console.log(\"here matched\" + matched + \" mismatched\" + mismatched + \" nouse \" + (nouse + missingcat));\n          console.log(\"here cntRelevant :\" + aSentence.cntRelevantWords);\n        }\n        if(record[\"appId\"] ===\"F0731A\") {\n          console.log(\"here F0731A\" + JSON.stringify(rec));\n          console.log(\"here matched\" + matched + \" mismatched\" + mismatched + \" nouse \" + (nouse + missingcat));\n          console.log(\"here cntRelevant :\" + aSentence.cntRelevantWords);\n        }\n        */\n        res.push(rec);\n      }\n    })\n  });\n  perflog(\"sort (a=\" + res.length + \")\");\n  res.sort(cmpByResultThenRankingTupel);\n  perflog(\"filterRetain ...\");\n  res = filterRetainTopRankedResultTupel(res);\n  perflog(\"matchRecordsQuick done: (r=\" + relevantRecords.length + \" s=\" + aSentences.length + \" a=\" + res.length + \")\");\n  return res;\n}\n\n\nfunction classifyWordWithTargetCategory(word: string, targetcategory : string, rules: IMatch.SplitRules,\nwholesentence : string ) : string {\n  //console.log(\"classify \" + word + \" \"  + targetcategory);\n  var cats = InputFilter.categorizeAWord(word, rules, wholesentence, {});\n  // TODO qualify\n  cats = cats.filter(function (cat) {\n    return cat.category === targetcategory;\n  })\n  debuglog(JSON.stringify(cats));\n  if (cats.length) {\n    return cats[0].matchedString;\n  }\n}\n\n\nexport function analyzeCategory(categoryword: string, rules: IMatch.SplitRules, wholesentence: string): string {\n  return classifyWordWithTargetCategory(categoryword, 'category', rules, wholesentence);\n}\n\nexport function splitAtCommaAnd(str : string) : string[] {\n  var r = str.split(/(\\band\\b)|[,]/);\n  r = r.filter(function(o,index) {\n    if(index % 2 > 0) {\n      return false;\n    }\n    return true;\n  });\n  var rtrimmed = r.map(function(o) {\n      return new String(o).trim();\n  });\n  return rtrimmed;\n}\n/**\n * A simple implementation, splitting at and and ,\n */\nexport function analyzeCategoryMult2(categorylist: string, rules: IMatch.SplitRules, wholesentence: string): string[] {\n  var rtrimmed = splitAtCommaAnd(categorylist);\n  var rcat = rtrimmed.map(function(o) {\n    return analyzeCategory(o,rules,wholesentence);\n  });\n  if(rcat.indexOf(undefined) >= 0) {\n    throw new Error('\"' + rtrimmed[rcat.indexOf(undefined)]+'\" is not a category!');\n  }\n  return rcat;\n}\n\n\n\nexport function filterAcceptingOnly(res : IMatch.ICategorizedString[][], categories : string[]):\n   IMatch.ICategorizedString[][] {\n    return res.filter(function(aSentence,iIndex) {\n      return aSentence.every(function(oWord) {\n        return categories.indexOf(oWord.category) >= 0;\n      });\n  })\n}\n\n\nvar sWords = {};\n\nexport function analyzeContextString(contextQueryString : string,  rules: IMatch.SplitRules) :\n[ [IMatch.ICategorizedString]] {\n    var matched = InputFilter.analyzeString(contextQueryString, rules, sWords);\n    if(debuglog.enabled) {\n      debuglog(\"After matched \" + JSON.stringify(matched));\n    }\n    var aSentences = InputFilter.expandMatchArr(matched);\n    if(debuglog.enabled) {\n      debuglog(\"after expand\" + aSentences.map(function (oSentence) {\n        return Sentence.rankingProduct(oSentence) + \":\" + JSON.stringify(oSentence);\n      }).join(\"\\n\"));\n    }\n    var aSentencesReinforced = InputFilter.reinForce(aSentences);\n    if(debuglog.enabled) {\n      debuglog(\"after reinforce\" + aSentencesReinforced.map(function (oSentence) {\n        return Sentence.rankingProduct(oSentence) + \":\" + JSON.stringify(oSentence);\n      }).join(\"\\n\"));\n    }\n    // we limit analysis to n sentences\n    aSentencesReinforced = aSentencesReinforced.slice(0, Algol.Cutoff_Sentences);\n     if(debuglog.enabled) {\n      debuglog(\"after reinforce and cutoff\" + aSentencesReinforced.length + \"\\n\"  + aSentencesReinforced.map(function (oSentence) {\n        return Sentence.rankingProduct(oSentence) + \":\" + JSON.stringify(oSentence);\n      }).join(\"\\n\"));\n    }\n    return aSentencesReinforced;\n}\n\nexport function cmpByNrCategoriesAndSameDomain(a: IMatch.ISentence, b : IMatch.ISentence)  : number {\n  //console.log(\"compare a\" + a + \" cntb \" + b);\n  var cnta = Sentence.getDistinctCategoriesInSentence(a).length;\n  var cntb = Sentence.getDistinctCategoriesInSentence(b).length;\n/*\n  var cnta = a.reduce(function(prev, oWord) {\n    return prev + ((oWord.category === \"category\")? 1 : 0);\n  },0);\n  var cntb = b.reduce(function(prev, oWord) {\n    return prev + ((oWord.category === \"category\")? 1 : 0);\n  },0);\n // console.log(\"cnt a\" + cnta + \" cntb \" + cntb);\n */\n  return cntb - cnta;\n}\n\nexport function analyzeCategoryMult(categorylist: string, rules: IMatch.SplitRules, wholesentence: string, gWords:\n{[key: string] : IMatch.ICategorizedString[] }): string[] {\n  var res = analyzeContextString(categorylist,rules);\n//  debuglog(\"resulting category sentences\", JSON.stringify(res));\n  var res2 = filterAcceptingOnly(res, [\"category\", \"filler\"]);\n  res2.sort(Sentence.cmpRankingProduct);\n  debuglog(\"resulting category sentences: \\n\", debuglog.enabled? (Sentence.dumpNiceArr(res2.slice(0,3),Sentence.rankingProduct)) : '-');\n // TODO:   res2 = filterAcceptingOnlySameDomain(res2);\n  //debuglog(\"resulting category sentences\", JSON.stringify(res2, undefined, 2));\n  // expect only categories\n  // we could rank now by common domains , but for now we only take the first one\n  if(!res.length) {\n    return undefined;\n  }\n  //res.sort(cmpByNrCategoriesAndSameDomain);\n  var rescat = Sentence.getDistinctCategoriesInSentence(res2[0]);\n  return rescat;\n // \"\" return res[0].filter()\n // return classifyWordWithTargetCategory(categorylist, 'category', rules, wholesentence);\n}\n\nexport function analyzeOperator(opword: string, rules: IMatch.SplitRules, wholesentence: string): string {\n  return classifyWordWithTargetCategory(opword, 'operator', rules, wholesentence);\n}\n\n\n// const result = WhatIs.resolveCategory(cat, a1.entity,\n//   theModel.mRules, theModel.tools, theModel.records);\n\nexport function resolveCategory(category: string, contextQueryString: string,\n  rules : IMatch.SplitRules, records: Array<IMatch.IRecord>): Array<IMatch.IWhatIsAnswer> {\n  if (contextQueryString.length === 0) {\n    return [];\n  } else {\n    var matched = InputFilter.analyzeString(contextQueryString, rules);\n    debuglog(debuglog.enabled ? (\"after matched \" + JSON.stringify(matched)): '-');\n    var aSentences = InputFilter.expandMatchArr(matched);\n    if(debuglog.enabled) {\n      debuglog(\"after expand\" + aSentences.map(function (oSentence) {\n        return Sentence.rankingProduct(oSentence) + \":\" + JSON.stringify(oSentence);\n      }).join(\"\\n\"));\n    }\n    var aSentencesReinforced = InputFilter.reinForce(aSentences);\n    //aSentences.map(function(oSentence) { return InputFilter.reinForce(oSentence); });\n    debuglog(debuglog.enabled ? (\"after reinforce\" + aSentencesReinforced.map(function (oSentence) {\n      return Sentence.rankingProduct(oSentence) + \":\" + JSON.stringify(oSentence);\n    }).join(\"\\n\")): '-');\n    var matchedAnswers = matchRecords(aSentences, category, records); //aTool: Array<IMatch.ITool>): any /* objectstream*/ {\n    debuglog(debuglog.enabled ? (\" matchedAnswers\" + JSON.stringify(matchedAnswers, undefined, 2)): '-');\n    return matchedAnswers;\n  }\n}\n\nimport * as Model from '../model/model';\n\nexport function resolveCategories(categories: string[], contextQueryString: string,\n  theModel : IMatch.IModels): Array<IMatch.IWhatIsTupelAnswer> {\n  var records = theModel.records;\n  var rules = theModel.rules;\n  if (contextQueryString.length === 0) {\n    return [];\n  } else {\n    var matched = InputFilter.analyzeString(contextQueryString, rules);\n    debuglog(debuglog.enabled? (\"after matched \" + JSON.stringify(matched)): '-');\n    var aSentences = InputFilter.expandMatchArr(matched);\n    if(debuglog.enabled) {\n      debuglog(debuglog.enabled ? (\"after expand\" + aSentences.map(function (oSentence) {\n        return Sentence.rankingProduct(oSentence) + \":\" + JSON.stringify(oSentence);\n      }).join(\"\\n\")): '-');\n    }\n    var aSentencesReinforced = InputFilter.reinForce(aSentences);\n    //aSentences.map(function(oSentence) { return InputFilter.reinForce(oSentence); });\n    debuglog(debuglog.enabled? (\"after reinforce\" + aSentencesReinforced.map(function (oSentence) {\n      return Sentence.rankingProduct(oSentence) + \":\" + JSON.stringify(oSentence);\n    }).join(\"\\n\")): '-');\n    //var matchedAnswers = matchRecordsQuick(aSentences, category, records); //aTool: Array<IMatch.ITool>): any /* objectstream*/ {\n    var categorySet = {};\n    categories.forEach(function(category) {\n        categorySet[category] = true;\n        var categorySetLocal = Model.getAllRecordCategoriesForTargetCategory(theModel, category, true);\n        Object.assign(categorySet, categorySetLocal);\n    });\n\n    var matchedAnswers = matchRecordsQuickMultipleCategories(aSentencesReinforced, categories, records, categorySet); //aTool: Array<IMatch.ITool>): any /* objectstream*/ {\n    if(debuglog.enabled){\n      debuglog(\" matched Answers\" + JSON.stringify(matchedAnswers, undefined, 2));\n    }\n    perflog(\"filtering topRanked (a=\" + matchedAnswers.length + \")...\");\n    var matchedFiltered = filterOnlyTopRankedTupel(matchedAnswers);\n    if (debuglog.enabled) {\n      debuglog(\" matched top-ranked Answers\" + JSON.stringify(matchedFiltered, undefined, 2));\n    }\n    perflog(\"totalWhatisWithContext (a=\" + matchedFiltered.length + \")\");\n    return matchedFiltered; // ??? Answers;\n  }\n}\n\nexport function filterOnlyTopRanked(results: Array<IMatch.IWhatIsAnswer>): Array<IMatch.IWhatIsAnswer> {\n  var res = results.filter(function (result) {\n    if (result._ranking === results[0]._ranking) {\n      return true;\n    }\n    if (result._ranking >= results[0]._ranking) {\n      throw new Error(\"List to filter must be ordered\");\n    }\n    return false;\n  });\n  return res;\n}\n\nexport function filterOnlyTopRankedTupel(results: Array<IMatch.IWhatIsTupelAnswer>): Array<IMatch.IWhatIsTupelAnswer> {\n  var res = results.filter(function (result) {\n    if (result._ranking === results[0]._ranking) {\n      return true;\n    }\n    if (result._ranking >= results[0]._ranking) {\n      throw new Error(\"List to filter must be ordered\");\n    }\n    return false;\n  });\n  return res;\n}\n\n\nexport function isIndiscriminateResult(results: Array<IMatch.IWhatIsAnswer>): string {\n  var cnt = results.reduce(function (prev, result) {\n    if (result._ranking === results[0]._ranking) {\n      return prev + 1;\n    }\n  }, 0);\n  if (cnt > 1) {\n    // search for a discriminating category value\n    var discriminating = Object.keys(results[0].record).reduce(function (prev, category) {\n      if ((category.charAt(0) !== '_' && category !== results[0].category)\n        && (results[0].record[category] !== results[1].record[category])) {\n        prev.push(category);\n      }\n      return prev;\n    }, []);\n    if (discriminating.length) {\n      return \"Many comparable results, perhaps you want to specify a discriminating \" + discriminating.join(',');\n    }\n    return 'Your question does not have a specific answer';\n  }\n  return undefined;\n}\n\nexport function isIndiscriminateResultTupel(results: Array<IMatch.IWhatIsTupelAnswer>): string {\n  var cnt = results.reduce(function (prev, result) {\n    if (result._ranking === results[0]._ranking) {\n      return prev + 1;\n    }\n  }, 0);\n  if (cnt > 1) {\n    // search for a discriminating category value\n    var discriminating = Object.keys(results[0].record).reduce(function (prev, category) {\n      if ((category.charAt(0) !== '_' && results[0].categories.indexOf(category) < 0)\n        && (results[0].record[category] !== results[1].record[category])) {\n        prev.push(category);\n      }\n      return prev;\n    }, []);\n    if (discriminating.length) {\n      return \"Many comparable results, perhaps you want to specify a discriminating \" + discriminating.join(',') + ' or use \"list all ...\"';\n    }\n    return 'Your question does not have a specific answer';\n  }\n  return undefined;\n}\n"],"sourceRoot":"ABC"}