{"version":3,"sources":["/projects/nodejs/botbuilder/fdevstart/src/../src/bot/smartdialog.ts"],"names":[],"mappings":"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","file":"bot/smartdialog.js","sourcesContent":["/**\n * The bot implementation\n *\n * Instantiate apssing a connector via\n * makeBot\n *\n */\n/**\n * @file\n * @module jfseb.fdevstart.smartdialog\n * @copyright (c) 2016 Gerd Forstmann\n */\n//declare module 'elizabot' { };\n\nimport * as builder from 'botbuilder';\n\nimport * as debug from 'debug';\n\nimport * as Exec from '../exec/exec';\nimport * as Match from '../match/match';\n\nimport * as Analyze from '../match/analyze';\n\nimport * as WhatIs from '../match/whatis';\n\nvar elizabot = require('../extern/elizabot/elizabot');\n//import * as elizabot from 'elizabot';\n\nlet debuglog = debug('smartdialog');\nimport * as PlainRecognizer from './plainrecognizer';\n//var builder = require('botbuilder');\n\nvar dispatcher = require('../match/dispatcher.js').dispatcher;\n\n\nfunction getConversationId(session: builder.Session): string {\n  return session.message &&\n    session.message.address &&\n    session.message.address.conversation.id;\n}\n\nvar elizabots = {};\n\nfunction getElizaBot(id: string) {\n  if (!elizabots[id]) {\n    elizabots[id] = {\n      access: new Date(),\n      elizabot: new elizabot()\n    };\n  }\n  elizabots[id].access = new Date();\n  return elizabots[id].elizabot;\n}\n\nimport * as IMatch from '../match/ifmatch';\nimport * as Tools from '../match/tools';\n\nvar newFlow = true;\n\nimport * as Model from '../model/model';\nimport * as ExecServer from '../exec/execserver';\n\nconst theModel = Model.loadModels();\nif (newFlow) {\n\n} else {\n\n  //const tools = Tools.getTools();\n  //const InputFilterRules = require('../match/inputFilterRules.js');\n  //const mRules = InputFilterRules.getMRulesSample();\n}\n\n\n\nclass SimpleRecognizer implements builder.IIntentRecognizer {\n  constructor() {\n\n  }\n\n  recognize(context: builder.IRecognizeContext, callback: (err: Error, result: builder.IIntentRecognizerResult) => void): void {\n    var u = {} as builder.IIntentRecognizerResult;\n\n    console.log(\"recognizing \" + context.message.text);\n    if (context.message.text.indexOf(\"start\") >= 0) {\n      u.intent = \"ShowEntity\";\n      u.score = 0.9;\n      var e1 = {} as builder.IEntity;\n      e1.startIndex = \"start \".length;\n      e1.endIndex = context.message.text.length;\n      e1.score = 0.3;\n      u.entities = [e1];\n      callback(undefined, u);\n      return;\n    }\n\n    if (context.message.text.indexOf(\"train\") >= 0) {\n      u.intent = \"train\";\n      u.score = 0.9;\n      var e1 = {} as builder.IEntity;\n      e1.startIndex = \"train \".length;\n      e1.endIndex = context.message.text.length;\n      e1.score = 0.3;\n      u.entities = [e1];\n      callback(undefined, u);\n      return;\n    }\n    if (context.message.text.indexOf(\"learn\") >= 0) {\n      u.intent = \"learn\";\n      u.score = 0.9;\n      var e1 = {} as builder.IEntity;\n      e1.type = \"trainFact\";\n      e1.startIndex = \"train \".length;\n      e1.endIndex = context.message.text.length;\n      e1.score = 0.3;\n      u.entities = [e1];\n      callback(undefined, u);\n      return;\n    }\n    if (context.message.text.indexOf(\"help\") >= 0) {\n      u.intent = \"help\";\n      u.score = 0.9;\n      var e1 = {} as builder.IEntity;\n      e1.startIndex = \"train \".length;\n      e1.endIndex = context.message.text.length;\n      e1.score = 0.3;\n      u.entities = [e1];\n      callback(undefined, u);\n      return;\n    }\n    if (context.message.text.indexOf(\"exit\") >= 0) {\n      u.intent = \"exit\";\n      u.score = 0.9;\n      var e1 = {} as builder.IEntity;\n      e1.startIndex = \"exit \".length;\n      e1.endIndex = context.message.text.length;\n      e1.score = 0.3;\n      u.entities = [e1];\n      callback(undefined, u);\n      return;\n    }\n    if (context.message.text.indexOf(\"wrong\") >= 0) {\n      u.intent = \"wrong\";\n      u.score = 0.9;\n      var e1 = {} as builder.IEntity;\n      e1.startIndex = \"exit \".length;\n      e1.endIndex = context.message.text.length;\n      e1.score = 0.3;\n      u.entities = [e1];\n      callback(undefined, u);\n      return;\n    }\n    console.log('recognizing nothing');\n    u.intent = \"None\";\n    u.score = 0.1;\n    var e1 = {} as builder.IEntity;\n    e1.startIndex = \"exit \".length;\n    e1.endIndex = context.message.text.length;\n    e1.score = 0.1;\n    u.entities = [];\n    callback(undefined, u);\n  }\n}\n\n\nclass SimpleUpDownRecognizer implements builder.IIntentRecognizer {\n  constructor() {\n\n  }\n\n  recognize(context: builder.IRecognizeContext, callback: (err: Error, result: builder.IIntentRecognizerResult) => void): void {\n    var u = {} as builder.IIntentRecognizerResult;\n\n    console.log(\"recognizing \" + context.message.text);\n    if (context.message.text.indexOf(\"down\") >= 0) {\n      u.intent = \"intent.down\";\n      u.score = 0.9;\n      var e1 = {} as builder.IEntity;\n      e1.startIndex = \"start \".length;\n      e1.endIndex = context.message.text.length;\n      e1.score = 0.3;\n      u.entities = [e1];\n      callback(undefined, u);\n      return;\n    }\n    if (context.message.text.indexOf(\"up\") >= 0) {\n      u.intent = \"intent.up\";\n      u.score = 0.9;\n      var e1 = {} as builder.IEntity;\n      e1.startIndex = \"up\".length;\n      e1.endIndex = context.message.text.length;\n      e1.score = 0.3;\n      u.entities = [e1];\n      callback(undefined, u);\n      return;\n    }\n    console.log('recognizing nothing');\n    u.intent = \"None\";\n    u.score = 0.1;\n    var e1 = {} as builder.IEntity;\n    e1.startIndex = \"exit \".length;\n    e1.endIndex = context.message.text.length;\n    e1.score = 0.1;\n    u.entities = [];\n    callback(undefined, u);\n  }\n}\n\nconst AnyObject = Object as any;\n// globalTunnel.initialize({\n//  host: 'proxy.exxxample.com',\n//  port: 8080\n// })\n\n// Create bot and bind to console\n// var connector = new htmlconnector.HTMLConnector()\n\n// connector.setAnswerHook(function (sAnswer) {\n//  console.log('Got answer : ' + sAnswer + '\\n')\n// })\n\nvar bot;\n// setTimeout(function () {\n//   connector.processMessage('start unit test ABC ')\n// }, 5000)\n\nimport * as fs from 'fs';\n\nvar oJSON = JSON.parse('' + fs.readFileSync('./resources/model/intents.json'));\nvar oRules = PlainRecognizer.parseRules(oJSON);\n// var Recognizer = new (recognizer.RegExpRecognizer)(oRules);\n\n\nfunction logQuery(session: builder.Session, intent: string, result?: Array<IMatch.IToolMatch>) {\n\n  fs.appendFile('./logs/showmequeries.txt', \"\\n\" + JSON.stringify({\n    text: session.message.text,\n    timestamp: session.message.timestamp,\n    intent: intent,\n    res: result && result.length && Match.ToolMatch.dumpNice(result[0]) || \"0\",\n    conversationId: session.message.address\n    && session.message.address.conversation\n    && session.message.address.conversation.id || \"\",\n    userid: session.message.address\n    && session.message.address.user\n    && session.message.address.user.id || \"\"\n  }), function (err, res) {\n    if (err) {\n      debuglog(\"logging failed \" + err);\n    }\n  });\n}\n\n\n\nfunction logQueryWhatIs(session: builder.Session, intent: string, result?: Array<IMatch.IWhatIsAnswer>) {\n\n  fs.appendFile('./logs/showmequeries.txt', \"\\n\" + JSON.stringify({\n    text: session.message.text,\n    timestamp: session.message.timestamp,\n    intent: intent,\n    res: result && result.length && WhatIs.dumpNice(result[0]) || \"0\",\n    conversationId: session.message.address\n    && session.message.address.conversation\n    && session.message.address.conversation.id || \"\",\n    userid: session.message.address\n    && session.message.address.user\n    && session.message.address.user.id || \"\"\n  }), function (err, res) {\n    if (err) {\n      debuglog(\"logging failed \" + err);\n    }\n  });\n}\n\nvar gwords = {};\n/**\n * Construct a bot\n * @param connector {Connector} the connector to use\n * HTMLConnector\n * or connector = new builder.ConsoleConnector().listen()\n */\nfunction makeBot(connector) {\n  bot = new builder.UniversalBot(connector);\n\n\n\n  // Create LUIS recognizer that points at our model and add it as the root '/' dialog for our Cortana Bot.\n  // var model = sensitive.modelurl;\n  // var model = 'https://api.projectoxford.ai/luis/v2.0/apps/c413b2ef-382c-45bd-8ff0-f76d60e2a821?subscription-key=c21398b5980a4ce09f474bbfee93b892&q='\n  var recognizer = new PlainRecognizer.RegExpRecognizer(oRules);\n\n  var dialog = new builder.IntentDialog({ recognizers: [recognizer] });\n  // dialog.onBegin(function(session,args) {\n  // console.log(\"beginning ...\")\n  // session.dialogData.retryPrompt = args && args.retryPrompt || \"I am sorry\"\n  // session.send(\"What do you want?\")\n  //\n  // })\n\n  var dialogUpDown = new builder.IntentDialog({ recognizers: [new SimpleUpDownRecognizer()] });\n\n  bot.dialog('/updown', dialogUpDown);\n  dialogUpDown.onBegin(function (session) {\n    session.send(\"Hi there, updown is waiting for you\");\n  })\n\n  dialogUpDown.matches('intent.up', [\n    function (session, args, next) {\n      session.dialogData.abc = args || {};\n      builder.Prompts.text(session, 'you want to go up');\n    },\n    function (session, results, next) {\n      session.dialogData.abc = results.reponse;\n      next();\n    },\n    function (session, results) {\n      session.endDialogWithResult({ response: session.dialogData.abc });\n    }\n  ]\n  );\n\n  dialogUpDown.matches('intent.down', [\n    function (session, args, next) {\n      session.dialogData.abc = args || {};\n      builder.Prompts.text(session, 'you want to go down!');\n    },\n    function (session, results, next) {\n      session.dialogData.abc = -1; // results.reponse;\n      next();\n    },\n    function (session, results) {\n      session.send(\"still going down?\");\n    }\n  ]\n  );\n  dialogUpDown.onDefault(function (session) {\n    logQuery(session, \"onDefault\");\n    session.send(\"You are trapped in a dialog which only understands up and down, one of them will get you out\");\n    //builder.DialogAction.send('I\\'m sorry I didn\\'t understand. I can only show start and ring');\n  });\n\n\n  bot.dialog('/train', [\n    function (session, args, next) {\n      session.dialgoData.abc = args || {};\n      builder.Prompts.text(session, 'Do you want to train me');\n    },\n    function (session, results, next) {\n      session.dialogData.abc = results.reponse;\n    },\n    function (session, results) {\n      session.endDialogWithResult({ response: session.DialogData.abc });\n    }\n  ]);\n\n\n  bot.dialog('/', dialog);\n\n  dialog.matches('ShowMe', [\n    function (session, args, next) {\n      var isCombinedIndex = {};\n      var oNewEntity;\n      // expecting entity A1\n      debuglog(\"Show Entity\");\n      console.log('raw: ' + JSON.stringify(args.entities), undefined, 2);\n      var a1 = builder.EntityRecognizer.findEntity(args.entities, 'A1');\n      const result = Analyze.analyzeAll(a1.entity,\n        theModel.mRules, theModel.tools, gwords);\n      logQuery(session, 'ShowMe', result);\n      // test.expect(3)\n      //  test.deepEqual(result.weight, 120, 'correct weight');\n      if (!result || result.length === 0) {\n        next();\n      }\n      // debuglog('result : ' + JSON.stringify(result, undefined, 2));\n      debuglog('best result : ' + JSON.stringify(result[0] || {}, undefined, 2));\n      debuglog('top : ' + Match.ToolMatch.dumpWeightsTop(result, { top: 3 }));\n\n\n      if (Analyze.isComplete(result[0])) {\n        session.dialogData.result = result[0];\n        //    session.send('Showing entity ...');\n        next();\n      } else if (Analyze.getPrompt(result[0])) {\n        var prompt = Analyze.getPrompt(result[0]);\n        session.dialogData.result = result[0];\n        session.dialogData.prompt = prompt;\n        session.send(\"Not enough information supplied: \" + Match.ToolMatch.dumpNice(\n          session.dialogData.result\n        ));\n        builder.Prompts.text(session, prompt.text);\n      } else {\n        var best = result.length ? Match.ToolMatch.dumpNice(result[0]) : \"<nothing>\";\n        //session.send('I did not understand this' + best);\n        var reply =\n          new builder.Message(session)\n            .text('I did not understand this' + best)\n            .addEntity({ url: \"I don't know\" });\n        // .addAttachment({ fallbackText: \"I don't know\", contentType: 'image/jpeg', contentUrl: \"www.wombat.org\" });\n        session.send(reply);\n      }\n    },\n    function (session, results, next) {\n      var result = session.dialogData.result;\n      if (!result || result.length === 0) {\n        next();\n      }\n\n      if (results.response) {\n        // some prompting\n        Analyze.setPrompt(session.dialogData.result, session.dialogData.prompt, results.response);\n      }\n      if (Analyze.isComplete(session.dialogData.result)) {\n        next();\n      } else if (Analyze.getPrompt(session.dialogData.result)) {\n        var prompt = Analyze.getPrompt(session.dialogData.result);\n        session.dialogData.prompt = prompt;\n        builder.Prompts.text(session, prompt.text);\n      }\n    },\n    function (session, results, next) {\n      var result = session.dialogData.result;\n      if (results.response) {\n        // some prompting\n        Analyze.setPrompt(session.dialogData.result,\n          session.dialogData.prompt, results.response);\n      }\n      if (Analyze.isComplete(session.dialogData.result)) {\n        const exec = ExecServer.execTool(session.dialogData.result as IMatch.IToolMatch, theModel.records);\n\n        var reply = new builder.Message(session)\n          .text(exec.text)\n          .addEntity(exec.action);\n        // .addAttachment({ fallbackText: \"I don't know\", contentType: 'image/jpeg', contentUrl: \"www.wombat.org\" });\n        session.send(reply);\n\n      } else {\n        if (session.dialogData.result) {\n          session.send(\"Not enough information supplied: \" + Match.ToolMatch.dumpNice(\n            session.dialogData.result\n          ));\n        } else {\n          session.send(\"I did not get what you want\");\n        }\n      }\n    },\n  ]);\n\n  dialog.matches('WhatIs', [\n    function (session, args, next) {\n      var isCombinedIndex = {};\n      var oNewEntity;\n      // expecting entity A1\n      var message = session.message.text;\n      debuglog(\"WhatIs Entity\");\n      console.log('raw: ' + JSON.stringify(args.entities), undefined, 2);\n      var categoryEntity = builder.EntityRecognizer.findEntity(args.entities, 'category');\n      var category = categoryEntity.entity;\n      var a1 = builder.EntityRecognizer.findEntity(args.entities, 'A1');\n\n      var cat = WhatIs.analyzeCategory(category, theModel.mRules, message);\n      if(!cat) {\n        session.send('I don\\'t know anything about \"' + category + '\"');\n        next();\n      }\n      const result = WhatIs.resolveCategory(cat, a1.entity,\n        theModel.mRules, theModel.records);\n      logQueryWhatIs(session, 'WhatIs', result);\n      var indis = WhatIs.isIndiscriminateResult(result);\n      if (indis) {\n        session.send(indis);\n        next();\n        return;\n      }\n      if (!result || result.length === 0) {\n        session.send('I don\\'t know anything about \"' + cat + \" (\" + category + ')\\\" in relation to \"' + a1.entity + '\"');\n        next();\n        return;\n      } else {\n        // debuglog('result : ' + JSON.stringify(result, undefined, 2));\n        debuglog('best result : ' + JSON.stringify(result[0] || {}, undefined, 2));\n        debuglog('top : ' + WhatIs.dumpWeightsTop(result, { top: 3 }));\n        // TODO cleansed sentence\n        session.send('The ' + category + ' of ' + a1.entity + ' is ' + result[0].result + \"\\n\"); //  + JSON.stringify(result[0]));\n      }\n    }\n  ]);\n\n\n\n\n  dialog.matches('Wrong', [\n    function (session, args, next) {\n      session.beginDialog('/updown', session.userData.count);\n    },\n    function (session, results, next) {\n      var alarm = session.dialogData.alarm;\n      session.send(\"back from wrong : \" + JSON.stringify(results));\n      next();\n    },\n    function (session, results) {\n      session.send('end of wrong');\n    }\n  ]);\n\n  dialog.matches('Exit', [\n    function (session, args, next) {\n      console.log('exit :');\n      console.log('exit' + JSON.stringify(args.entities));\n      session.send(\"you are in a logic loop \");\n    }\n  ]);\n  dialog.matches('Help', [\n    function (session, args, next) {\n      console.log('help :');\n      console.log('help');\n      session.send(\"I know about .... <categories>>\");\n    }\n  ]);\n\n\n\n  // Add intent handlers\n  dialog.matches('train', [\n    function (session, args, next) {\n      console.log('train');\n      // Resolve and store any entities passed from LUIS.\n      var title = builder.EntityRecognizer.findEntity(args.entities, 'builtin.alarm.title');\n      var time = builder.EntityRecognizer.resolveTime(args.entities);\n      var alarm = session.dialogData.alarm = {\n        title: title ? title.entity : null,\n        timestamp: time ? time.getTime() : null\n      };\n      // Prompt for title\n      if (!alarm.title) {\n        builder.Prompts.text(session, 'What fact would you like to train?');\n      } else {\n        next();\n      }\n    },\n    function (session, results, next) {\n      var alarm = session.dialogData.alarm;\n      if (results.response) {\n        alarm.title = results.response;\n      }\n\n      // Prompt for time (title will be blank if the user said cancel)\n      if (alarm.title && !alarm.timestamp) {\n        builder.Prompts.time(session, 'What time would you like to set the alarm for?');\n      } else {\n        next();\n      }\n    },\n    function (session, results) {\n      var alarm = session.dialogData.alarm;\n      if (results.response) {\n        var time = builder.EntityRecognizer.resolveTime([results.response]);\n        alarm.timestamp = time ? time.getTime() : null;\n      }\n      // Set the alarm (if title or timestamp is blank the user said cancel)\n      if (alarm.title && alarm.timestamp) {\n        // Save address of who to notify and write to scheduler.\n        alarm.address = session.message.address;\n        //alarms[alarm.title] = alarm;\n\n        // Send confirmation to user\n        var date = new Date(alarm.timestamp);\n        var isAM = date.getHours() < 12;\n        session.send('Creating alarm named \"%s\" for %d/%d/%d %d:%02d%s',\n          alarm.title,\n          date.getMonth() + 1, date.getDate(), date.getFullYear(),\n          isAM ? date.getHours() : date.getHours() - 12, date.getMinutes(), isAM ? 'am' : 'pm');\n      } else {\n        session.send('Ok... no problem.');\n      }\n    }\n  ]);\n\n  dialog.onDefault(function (session) {\n    logQuery(session, \"onDefault\");\n    var eliza = getElizaBot(getConversationId(session));\n    var reply = eliza.transform(session.message.text);\n    session.send(reply);\n    //new Eilzabot\n    //session.send(\"I do not understand this at all\");\n    //builder.DialogAction.send('I\\'m sorry I didn\\'t understand. I can only show start and ring');\n  });\n\n  /*\n  // Very simple alarm scheduler\n  var alarms = {};\n  setInterval(function () {\n    var now = new Date().getTime();\n    for (var key in alarms) {\n      var alarm = alarms[key];\n      if (now >= alarm.timestamp) {\n        var msg = new builder.Message()\n          .address(alarm.address)\n          .text('Here\\'s your \\'%s\\' alarm.', alarm.title);\n        bot.send(msg);\n        delete alarms[key];\n      }\n    }\n  }, 15000);\n  */\n}\n\nif (module) {\n  module.exports = {\n    makeBot: makeBot\n  };\n}\n"],"sourceRoot":"ABC"}